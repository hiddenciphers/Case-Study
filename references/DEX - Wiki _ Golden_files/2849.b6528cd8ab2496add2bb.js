/*! For license information please see 2849.b6528cd8ab2496add2bb.js.LICENSE.txt */
"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2849],{94396:(e,t,n)=>{n.d(t,{Z:()=>r}),n(27378);var s=n(55480),i=n(24246);const l={position:"absolute",top:"-4px",right:"-4px",p:"4px",pr:"3px",borderRadius:"sm",bg:"rgba(200, 172, 119, 0.7)",color:"white",fontSize:"9px",fontWeight:700,letterSpacing:"1px",textTransform:"uppercase"},r=({children:e,sx:t={}})=>(0,i.jsx)(s.xu,{sx:{...l,...t},children:e})},77822:(e,t,n)=>{n.d(t,{Z:()=>se});var s=n(80165),i=n(55046),l=n(92739),r=n(27378),o=n(56552),a=(n(95623),n(73902),n(70408)),d=n(28055),c=n(55480);const u=(0,r.createContext)(null);var p=n(60042),x=n.n(p),h=n(88460),m=n(24246);const g=(0,h.Z)("AddItemButton"),f=({label:e,onClick:t,className:n,disabled:i,buttonProps:r,isCircle:o,...a})=>(0,m.jsxs)("span",{className:x()(g("wrapper"),n),onClick:t,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),t())},...a,children:[(0,m.jsx)("button",{className:x()(g("button",o?"circle":null),"button button--blue button--plusOnly g-modal__add-field",{disabled:i}),...r,tabIndex:-1,children:(0,m.jsx)(l.G,{className:g("plus"),icon:s.r8})}),(0,m.jsx)(c.xv,{variant:"body1",sx:{display:"inline"},children:e})]});f.defaultProps={disabled:!1};const b=f,v=(0,r.createContext)(null);var y=n(56141),C=n.n(y),j=n(93310),w=n(93841),k=n(47869),_=n(82097);const Z=({onSuccess:e})=>{const{mutate:t,isLoading:n}=(({onSuccess:e=_.Z}={})=>{const t=(0,k.Z)(),n=(0,w.A)();return(0,o.useMutation)((({fields:e,entity:n})=>{const s=(0,j.d)(e);return t.post(`entities/${n.slug}/atomic_edit/?scoped=false`,s)}),{onSuccess:(t,n)=>{e({...n.entity,infobox:t})},onError:(t,s)=>{if(403!==t.response.status)return 400!==t.response.status&&404!==t.response.status||e(s.entity),t;t.response.json().then((e=>{n(e,"error",6e3)}))}})})({onSuccess:e});return{update:(0,r.useCallback)(((n,s)=>{const i=n.infobox,l=s.reduce(((e,t)=>{const n=i.filter((e=>e.name===t.name));if(n.find((e=>C()(e.display_value,t.display_value))))return e;let s=null;if(!t.allow_multiple){const e=n[0];e&&(s=e.display_value)}return e.push([t.name,s,t.display_value]),e}),[]);l.length?t({fields:l,entity:n}):e(n)}),[t,e]),isLoading:n}};var S=n(7098),E=n(86333),I=n(28206),P=n(25453),T=n(77038),F=n(18574);const R=({entityId:e,onSelect:t})=>{const n=(0,F.X2)(e),s=(0,r.useCallback)((()=>{t(n)}),[t,n]);return n?(0,m.jsx)(d.II,{as:"div",sx:{cursor:"pointer",mb:2},onClick:s,children:(0,m.jsx)(E.Z,{title:n.name,subtitle:n.description,thumbnail:n.thumbnail})}):null},D=({field:e,onChangeField:t,newParentEntityName:n})=>{const s=(0,I.T)(),o=(0,I.C)((e=>e.infoboxFieldTypes.data)),[a,p]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[g,f]=(0,r.useState)(void 0),b=(0,F.X2)(e.display_value),y=(0,r.useContext)(u),{setEntity:C}=(0,r.useContext)(S.Z),j=(0,r.useCallback)((()=>{h(!1)}),[]),w=(0,r.useCallback)((()=>{p(!1)}),[]),k=(0,r.useCallback)((()=>{f(void 0),p(!0)}),[]),_=(0,r.useCallback)((e=>{x||(h(!0),s((0,P.m$)(e.slug)).then((t=>{f({...e,infobox:t}),p(!0),j()})).catch(j))}),[s,x,j]),D=(0,r.useCallback)((()=>{t({...e,display_value:""})}),[e,t]),N=(0,r.useCallback)((n=>{C(n),t({...e,display_value:n.id})}),[e,t,C]),{update:L,isLoading:M}=Z({onSuccess:N}),q=(0,r.useCallback)(((e,t)=>{M||L(e,t)}),[L,M]),A=[...e.__queryFields],O=(0,T.Ol)(o,e.inverse_of);if(O&&y){const e={...O,label:O.default_label,display_value:y};A.push(e)}let $=null;return e.__queryFieldOptions&&($=(0,m.jsxs)(m.Fragment,{children:["Select ",e.label.toLowerCase(),":",e.__queryFieldOptions.map(((e,t)=>(0,m.jsx)(R,{entityId:e.display_value,onSelect:_},t))),"or add another:"]})),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(c.xu,{sx:{position:"relative"},children:[b?(0,m.jsx)(d.II,{as:"div",sx:{cursor:"pointer"},onClick:D,children:(0,m.jsx)(E.Z,{title:b.name,subtitle:b.description,thumbnail:b.thumbnail})}):(0,m.jsxs)(m.Fragment,{children:[$,(0,m.jsxs)(d.II,{as:"div",sx:{cursor:"pointer"},onClick:k,children:["Select new ",e.label.toLowerCase()]})]}),x&&(0,m.jsx)(c.xu,{sx:{position:"absolute",bg:"rgba(0,0,0,0.3)",top:0,right:0,bottom:0,left:0,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,m.jsx)(l.G,{icon:i.LM,spin:!0})})]}),a&&(0,m.jsx)(v.Provider,{value:n,children:(0,m.jsx)(Q,{queryFields:A,constraints:e.constraints,onSelect:q,onSuccess:N,onClose:w,initialEntity:g})})]})};var N=n(97894);const L=()=>{const e=(0,r.useContext)(v);return(0,m.jsx)(d.II,{as:"div",sx:{cursor:"not-allowed"},children:e})},M=({index:e,field:t,onChange:n,onAdd:s,isLastMultipleField:i,newParentEntityName:l})=>{const o=(0,r.useRef)(null),a=!!t.display_value,d=t.__queryFields&&t.__queryFields.length>0,u=i&&a&&!d,p="__new__"===t.display_value,x=(0,r.useCallback)((t=>{const{error:s,...i}=t;n(e,i)}),[n,e]),h=(0,r.useCallback)((()=>{a?s(e+1,{...t,display_value:""}):o.current&&o.current.focus()}),[s,e,t,a]),g=d?D:p?L:(0,N.UR)(t);return g?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.xu,{sx:{mb:2,display:"flex",alignItems:"center"},children:(0,m.jsx)(c.xu,{sx:{width:"100%",...t.error?{border:1,borderColor:"red50",borderRadius:"sm"}:{}},children:(0,m.jsx)(g,{field:t,onChangeField:x,inputRef:o,newParentEntityName:l,autoFocus:0===e})})}),u&&(0,m.jsx)(c.xu,{children:(0,m.jsx)(b,{label:"Add another",onClick:h,tabIndex:0})})]}):null};var q=n(87389);const A=({fields:e,requiredFieldNames:t,onChange:n,newParentEntityName:s})=>{const i=(0,r.useCallback)(((t,s)=>{const i=[...e];i[t]=s,n(i)}),[e,n]),l=(0,r.useCallback)(((t,s)=>{const i=[...e];i.splice(t,0,s),n(i)}),[e,n]);if(0===e.length)return null;let o="";return e.map(((n,a)=>{if("instance_of"===n.name||n.is_read_only||!(0,q.Z)(n))return null;const c=t.includes(n.name),u=e[a+1],p=n.allow_multiple&&(!u||n.name!==u.name);let x=(0,m.jsx)(M,{index:a,field:n,onChange:i,onAdd:l,isRequired:c,isLastMultipleField:p,newParentEntityName:s});return 0!==a&&o===n.name||(o=n.name,x=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(d.__,{sx:{mt:3,...n.error?{color:"textRed"}:{}},children:[n.default_label||n.label,c&&"*"]}),x]})),(0,m.jsx)(r.Fragment,{children:x},a)}))},O=e=>!e||!e.display_value||"object"==typeof e.display_value&&0===Object.keys(e.display_value).length;n(911);var $=n(7703);const z=(e,t)=>{if(!e)return"";const n=e.display_value;if("__new__"===n)return n;if(!n)return"";const s=t[n];return s?s.name:""},H=e=>{var t;const n=(0,I.C)((e=>e.infoboxFieldTypes.data)),s=(0,I.C)((e=>e.data.entitiesById)),i=null===(t=e.find((e=>"instance_of"===e.name)))||void 0===t?void 0:t.display_value,l=i&&(0,T.$y)(n,i),o=l&&"funding_round"===l.template.name,a=l&&"acquisition"===l.template.name,d=(0,r.useContext)(v);return(0,r.useCallback)((e=>o?((e,t)=>{let n="",s="Funding round",i="";return e.forEach((e=>{var l;"funded_company"===e.name?n=z(e,t):"funding_type"===e.name?s=z(e,t):"date_announced"===e.name&&(i=(l=e)?$.Z.renderDate(l.display_value):"")})),`${n} ${s}${i?`, ${i}`:""}`.trim()})(e,s).replace("__new__",d):a?((e,t)=>{let n="-",s="";return e.forEach((e=>{"acquired_company"===e.name?n=z(e,t):"acquirer"===e.name&&(s=z(e,t))})),`Acquisition of ${n} by ${s}`.trim()})(e,s).replace("__new__",d):""),[a,o,d,s])};var B=n(21020),V=n(19273),W=n(33268),K=n(76553),G=n(66980);const U=({onClick:e,children:t})=>(0,m.jsx)(c.xu,{variant:"blueLink",onClick:e,sx:{ml:"auto",cursor:"pointer","&:hover":{textDecoration:"underline"}},children:(0,m.jsx)(c.xv,{sx:{fontSize:"80%"},children:t})}),Q=({onSelect:e,onClose:t,queryFields:n,constraints:s,initialEntity:o,onSuccess:p})=>{const x=(0,k.Z)(),h=(0,I.T)(),g=(0,I.C)((e=>e.infoboxFieldTypes.data)),f=(0,T.$y)(g,s[0]),b=(null==f?void 0:f.template.label)||"Topic",v=(0,r.useMemo)((()=>{return[...n.map((e=>e.name)),...(e=f.template.name,"funding_round"===e?["funding_type","date_announced"]:"acquisition"===e?["acquired_company"]:[])];var e}),[n,f.template.name]),y=(0,r.useCallback)((({infobox:e=[]}={})=>{const t=((e,{queryFields:t=[],entityFields:n=[]}={})=>{var s;const i=null===(s=t.find((e=>"instance_of"===e.name)))||void 0===s?void 0:s.display_value,l=(0,T.$y)(e,i);return l?l.templateFieldTypes.reduce(((e,{fieldType:s})=>{const i=[];let l=null,r=!1;t.forEach(((e,t)=>{e.name===s.name&&(i.push(e.display_value),l=t,e.__queryFields&&(r=!0))}));const o=n.filter((e=>e.name===s.name));if(0===o.length&&0===i.length)return e.push({...s,display_value:""}),e;if(o.length)if(i.length){const t=o.filter((e=>!i.includes(e.display_value)));if(t.length)if(r){const n=e[l];e[l]={...n,__queryFieldOptions:t}}else e.splice(l,0,...t)}else e=e.concat(o);return e}),[...t]):t})(g,{queryFields:n,entityFields:e}),s=e=>v.indexOf(e.name);return t.sort(((e,t)=>s(t)-s(e))),t}),[n,v,g]),C=H(n),j=!o&&C(n),[w,_]=(0,r.useState)((()=>{if(o)return o;const e=C(n);return e?{name:e,id:"__new__"}:void 0})),[Z,S]=(0,r.useState)(y(o)),[P,F]=(0,r.useState)(!1),R=(0,I.C)((e=>e.data.entitiesById));(0,G.Z)((()=>{const e=C(Z);_((t=>t&&e?{...t,name:e}:t))}),[R]);const D=(0,r.useCallback)((e=>{S(y(e)),_(e)}),[y]),N=(0,r.useCallback)((()=>{_(null),S(y())}),[y]),L=(0,r.useCallback)((({searchValue:e})=>{_({name:e,id:"__new__"})}),[]),M=(0,r.useCallback)((e=>{_({name:e.target.value,id:"__new__"})}),[]),q=(0,r.useCallback)((e=>{if(S(e),"__new__"===w.id){const t=C(e);t&&_({name:t,id:"__new__"})}}),[w,C]),$=(0,r.useCallback)((()=>{const e={},t=[];if(Z.forEach(((n,s)=>{e[n.name]||(v.includes(n.name)&&O(n)&&t.push([n,s]),e[n.name]=!0)})),0===t.length)return!0;const n=[...Z];return t.forEach((([e,t])=>{n[t]={...e,error:!0}})),S(n),!1}),[Z,v]),z=(0,r.useCallback)((()=>{if(!w)return;if(!$())return;const n=[];let s=Z.reduce(((e,t)=>{if(n.push(t.name),!O(t)){const{__queryFields:n,__queryFieldOptions:s,...i}=t;s&&s.forEach((t=>{t.display_value!==i.display_value&&e.push(t)})),e.push(i)}return e}),[]),i=(w.infobox||[]).filter((({name:e})=>"instance_of"===e||!n.includes(e)));s=s.concat(i),"__new__"===w.id?(F(!0),x.post("entities/",{name:w.name,metadata:{context:"Add query record"},payload:{infobox:s.filter((e=>"__new__"!==e.display_value))}}).then((e=>{h((0,K.y6)({[e.id]:{...e,...e.structuredData}})),p({...e,...e.structuredData}),t()}))):(e(w,s),t())}),[h,$,p,t,w,Z,e,x]);return(0,m.jsx)(V.Z,{open:!0,onClose:t,header:(0,m.jsxs)(c.xu,{variant:"modalHeader",children:["Add ",b.toLowerCase()]}),footer:(0,m.jsxs)(c.xu,{variant:"modalFooter",sx:{px:4,justifyContent:"space-between"},children:[(0,m.jsx)(B.ZP,{onClick:t,size:"md",children:"Cancel"}),(0,m.jsx)(B.ZP,{intent:"submit",disabled:!w||P,onClick:z,size:"md",children:P?(0,m.jsx)(l.G,{icon:i.LM,spin:!0}):"Submit"})]}),children:(0,m.jsx)(c.xu,{sx:{p:3},children:w?(0,m.jsxs)(m.Fragment,{children:["__new__"!==w.id?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(d.__,{children:["Selected ",b.toLowerCase(),(0,m.jsx)(U,{onClick:N,children:"(change)"})]}),(0,m.jsx)(d.II,{as:"div",children:(0,m.jsx)(E.Z,{title:w.name,subtitle:w.description,thumbnail:w.thumbnail})})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(d.__,{sx:{alignItems:"center"},children:["New ",b.toLowerCase()," name",j?" (auto generated)":"",(0,m.jsx)(U,{onClick:N,children:"Select existing"})]}),(0,m.jsx)(d.II,{value:w.name,readOnly:j,onChange:j?void 0:M,sx:{...j?{cursor:"not-allowed"}:{}}})]}),(0,m.jsx)(u.Provider,{value:w.id,children:(0,m.jsx)(A,{fields:Z,requiredFieldNames:v,onChange:q,newParentEntityName:w.name})})]}):(0,m.jsx)(W.ZP,{onSelect:D,placeholder:`Search for ${b.toLowerCase()}`,footerOptions:["show-all",{action:L,icon:(0,m.jsx)(l.G,{icon:a.CP}),label:"Create new topic"}],constraints:s,withInfobox:!0,autoFocus:!0})})})};var X=n(87780);const J=(e,t,n)=>{const s=n.field_types.find((t=>t.name===e));return s?{...s,display_value:t,label:s.default_label}:null},Y=(e,t,n)=>{const s=[J("instance_of",n,e)];return t.forEach((t=>{const n=(0,T.Ol)(e,t.fieldTypeId);if(!n)return;const i=t.filters;if(i){const l=i.find((e=>e.fieldTypeId===X.mN));if(!l){const t=n.constraints[0];return void s.push({...n,label:n.default_label,display_value:"",__queryFields:Y(e,i,t)})}t={...l,fieldTypeById:t.fieldTypeById}}const{operator:l,negate:r}=t;!r&&["eq","any","location","date"].includes(l)&&(Array.isArray(t.value)?t.value:[t.value]).forEach((t=>{if(t)if("investor"===n.name){const n=J("investor",t,e),i=J("investment",{investor:[n]},e);s.push(i)}else s.push({...n,label:n.default_label,display_value:t})}))})),s},ee=Y;var te=n(78990),ne=n(61777);const se=({query:e})=>{const{isConnected:t}=(0,te.Z)(),n=(0,I.C)((e=>e.infoboxFieldTypes.data)),[a,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),p=(0,r.useCallback)((()=>{t?d(!0):u(!0)}),[t]),x=(0,r.useCallback)((()=>{d(!1)}),[]),h=(0,o.useQueryClient)(),{queryKey:g,setEntity:f}=(0,r.useContext)(S.Z),b=(0,r.useCallback)((e=>{f(e),h.setQueryData(g,(t=>({...t,results:t.results.concat(e)})))}),[f,h,g]),{update:v,isLoading:y}=Z({onSuccess:b}),C=(0,r.useCallback)(((e,t)=>{y||v(e,t)}),[y,v]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(B.ZP,{appearance:"primary",intent:"submit",onClick:p,iconBefore:y?(0,m.jsx)(l.G,{icon:i.LM,spin:!0}):(0,m.jsx)(l.G,{icon:s.r8}),children:"Add new record"}),a&&(0,m.jsx)(Q,{constraints:[e.constraintId],queryFields:ee(n,e.filters,e.constraintId),onSelect:C,onSuccess:b,onClose:x}),(0,m.jsx)(ne.Z,{open:c,onSuccess:()=>d(!0),onClose:()=>u(!1)})]})}},56274:(e,t,n)=>{n.d(t,{Z:()=>u});var s=n(60042),i=n.n(s),l=n(27378),r=n(6552),o=n(88460),a=n(24246);const d=(0,o.Z)("AutoGenIcon");class c extends l.Component{shouldComponentUpdate(e){return this.shouldAnimate!==e.shouldAnimate}render(){const{animateColor:e,className:t,height:n,iconColor:s,shouldAnimate:l,width:r,onClick:o}=this.props;return(0,a.jsx)("svg",{className:i()(d(),t,{[d("animate")]:l}),width:r+"px",height:n+"px",viewBox:"0 0 536 536",onClick:o,children:(0,a.jsx)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:(0,a.jsxs)("g",{id:"wand-stars",transform:"translate(0.000000, 0.000000)",fill:s,fillRule:"nonzero",children:[(0,a.jsx)("polygon",{className:i()(d("star","star1"),{[d("star-animate")]:l}),id:"star-0",fill:l?e:s,points:"166.75 91.8 230.5 127.5 194.799 63.75 230.5 0 166.75 35.7 103 0 138.7 63.75 103 127.5"},0),(0,a.jsx)("polygon",{className:i()(d("star","star2"),{[d("star-animate")]:l}),id:"star-1",fill:l?e:s,points:"535.5 0 471.75 35.7 408 0 443.7 63.75 408 127.5 471.75 91.8 535.5 127.5 499.8 63.75"},1),(0,a.jsx)("polygon",{className:i()(d("star"),{[d("star-animate")]:l}),id:"star-2",fill:l?e:s,points:"471.75 341.7 408 306 443.7 369.75 408 433.5 471.75 397.8 535.5 433.5 499.8 369.75 535.5 306"},2),(0,a.jsx)("path",{className:d("wand"),d:"M342.7,135.15 C332.5,124.95 317.2,124.95 307,135.15 L8.649,433.5 C-1.551,443.7 -1.551,459 8.649,469.2 L67.299,527.849 C77.499,538.049 92.799,538.049 102.999,527.849 L401.35,229.5 C411.55,219.3 411.55,204 401.35,193.8 L342.7,135.15 Z M314.65,275.4 L261.1,221.85 L322.3,160.65 L375.85,214.2 L314.65,275.4 Z",id:"wand"})]})})})}}c.defaultProps={animateColor:r.ds,height:r.D_,width:r.D_,iconColor:r.Hy,onClick:()=>{}};const u=c},68370:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(27378),i=n(82097);const l=(0,s.createContext)({subscribe:i.Z,unsubscribe:i.Z,titles:[]})},67336:(e,t,n)=>{n.d(t,{_:()=>r,u:()=>l});var s=n(61485),i=n.n(s);const l="anchor-id-",r=e=>`${l}${i()(e)}`},62221:()=>{},85893:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(27378),i=n(68370),l=n(67336),r=(n(62221),n(13891));const o=({title:e,isSubheading:t=!1})=>{const n=(0,s.useRef)((0,r.Vj)()),{subscribe:o,unsubscribe:a}=(0,s.useContext)(i.Z),[d,c]=(0,s.useState)(e);return(0,s.useEffect)((()=>{const s=`${(0,l._)(e)}|${n.current}`;c(s);const i={titleId:s,title:e,isSubheading:t};return setTimeout((()=>{o(i)}),0),()=>{setTimeout((()=>{a(i)}),0)}}),[t,o,e,a]),d}},70658:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(55480),i=n(79124),l=n(44629),r=n(24246);const o=({sx:e,optionSx:t,onChange:n,selectedInterval:o="",disabled:a})=>(0,r.jsx)(l.Z,{sx:{width:"100%",p:1,borderRadius:"md",height:"38px",px:2,...e},children:Object.keys(i.k).map((e=>(0,r.jsx)(l.Z.Option,{onClick:t=>{t.stopPropagation(),!a&&n(e)},selected:o===i.k[e],disabled:a,sx:{flex:1,pt:0,pb:0,...t},children:(0,r.jsx)(s.xv,{variant:"body1",sx:{textTransform:"capitalize",fontWeight:500,color:o===i.k[e]?"blue60":"text1"},children:i.k[e]})},e)))})},69554:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(27378),i=n(79124),l=n(24158),r=n(46345);const o=(e,t={},{infoboxes:n=l.LZ,details:o=l.Nu,initPath:a=[0,0]}={})=>(0,s.useMemo)((()=>{var s,l;const d={model_type:e,details:o,infoboxes:n};switch(e){case r.Xk.ENTITY:return{initState:{...d,entity:{id:t.id,name:t.name||(null===(s=t.structuredData)||void 0===s?void 0:s.name),infobox:t.infobox,slug:t.slug||(null===(l=t.structuredData)||void 0===l?void 0:l.slug)}},initPath:a};case r.Xk.QUERY:return{initState:{...d,...null!=t&&t.id?{query:t}:{receiveUpdates:!0,alertInterval:i.k.DAILY,...t}},initPath:[null!=t&&t.id?2:3]};case r.Xk.ENTITY_LIST:return{initState:{...d,object:t},initPath:o.all?[4,0]:[4]};default:return{}}}),[e,o,n,t,a])},14523:(e,t,n)=>{n.d(t,{Z:()=>s});const s=(0,n(27378).createContext)({})},22279:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(55480),i=n(24246);const l=({sx:e={}}={})=>(0,i.jsx)(s.xu,{sx:{my:3,borderTop:"1px",borderColor:"divider1",...e}})},36692:(e,t,n)=>{n.d(t,{Z:()=>s});const s=(0,n(11628).ZP)({resolved:{},chunkName:()=>"components-Dropdown-DropdownIcon",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e(2384).then(n.bind(n,80681)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>80681},{ssr:!1})},80917:(e,t,n)=>{n.d(t,{Z:()=>p});var s=n(92739),i=n(28055),l=n(66726),r=n.n(l),o=n(27378),a=n(55480),d=n(85893),c=n(31581),u=n(24246);const p=({placeholder:e="Enter table title",onEnterPress:t,onChange:n,initialValue:l="",sx:p={},editMode:x,isDiff:h=!1,titleIcon:m,isStandardTable:g})=>{const[f,b]=(0,o.useState)(l),v=(0,d.Z)({title:f?`Table: ${f}`:"",isSubheading:!g});(0,o.useEffect)((()=>{b(l)}),[l,b]);const y=(0,c.Z)(),C=(0,o.useCallback)(r()((e=>n(e)),800),[n]),j=(0,o.useCallback)((e=>{const t=e.target.value;b(t),C(t)}),[C]),w=(0,o.useCallback)((e=>{var n;"Enter"===e.key&&t&&(e.stopPropagation(),null===(n=y.current)||void 0===n||n.blur(),t())}),[y,t]);return x&&!h?(0,u.jsx)(i.II,{sx:{fontSize:"2rem",fontFamily:"serif",border:1,borderStyle:"dashed",px:1,py:0,mr:1,...p},type:"text",ref:y,placeholder:e,value:f,onClick:e=>e.stopPropagation(),onChange:j,onKeyDown:w,onFocus:e=>e.stopPropagation(),id:v}):Array.isArray(f)?(0,u.jsxs)(a.xv,{as:"h3",variant:"heading2",sx:{fontFamily:"serif",...p},id:v,children:[(0,u.jsx)(a.xv,{as:"span",sx:{bg:"bgDiffRed"},children:f[0]}),(0,u.jsx)(a.xv,{as:"span",sx:{bg:"bgDiffGreen"},children:f[1]})]}):(0,u.jsxs)(a.xv,{as:"h3",variant:"heading2",id:v,sx:{flex:1,fontFamily:"serif",...p},children:[m&&(0,u.jsx)(s.G,{style:{marginRight:8,fontSize:"0.8em"},icon:m}),f]})}},2154:(e,t,n)=>{n.d(t,{Z:()=>Z});var s=n(27378),i=n(75822),l=n(80645),r=n(55480),o=n(27876),a=n(52466),d=n(24246);const c=()=>{const{setOrdering:e}=(0,s.useContext)(a.Z),t=(0,o.Z)({setOrdering:e});return(0,d.jsx)(r.xu,{as:"ul",sx:{width:"240px",listStyle:"none",p:0,py:3},children:t})},u=(0,s.memo)(c);var p=n(3223),x=n(20120),h=n(28206),m=n(62625),g=n(66426),f=n(91349),b=n(90915),v=n(42099),y=n(25257);const C=()=>{const{onSortAscending:e,onSortDescending:t}=(0,l.OU)();return(0,d.jsxs)(r.xu,{as:"ul",sx:{width:"240px",listStyle:"none",p:0,py:3},children:[(0,d.jsx)(y.Z,{icon:b.eG,title:"Sort by A -> Z",onClick:e,focusable:!0}),(0,d.jsx)(y.Z,{icon:v.xr,title:"Sort by Z -> A",onClick:t,focusable:!0})]})},j=(0,s.memo)(C),w=({routes:e,column:t})=>{const{listId:n}=(0,s.useContext)(a.Z),{removeColumnPlaceholder:i}=(0,x.Z)(n);return(0,s.useEffect)((()=>()=>{t.id===m.D5&&i()}),[t.id,i]),"name"===t.id?(0,d.jsx)(u,{}):(0,d.jsx)(p.ZP,{initialRoute:e[0],children:e.map(((e,t)=>{const n=f.tp[e];return(0,d.jsx)(p.TS,{route:e,children:(0,d.jsx)(n,{})},t)}))})},k=({routes:e})=>{const t=(0,h.T)(),{column:n,isPlaceholder:i}=(0,l.$V)();return(0,s.useEffect)((()=>()=>{t((0,m.wv)(null)),i&&t((0,m.XS)(n.id))}),[n.id,i,t]),"name"===n.id?(0,d.jsx)(j,{}):(0,d.jsx)(p.ZP,{initialRoute:e[0],children:e.map(((e,t)=>{const n=f.tp[e];return(0,d.jsx)(p.TS,{route:e,children:(0,d.jsx)(n,{})},t)}))})},_=({column:e,index:t,isOpen:n,routes:s,shouldUseDeprecated:l=!1,disabled:r=!1})=>(0,d.jsx)(i.Z,{isOpen:n,iconSx:{ml:"auto",flexShrink:0},sx:{borderRadius:"md",py:0},closeOnPress:!1,disabled:r,popperAttrs:{placement:"left-start",modifiers:[{name:"offset",options:{offset:[25,-25]}}]},children:(0,d.jsx)(g.Z.Provider,{value:{column:e,index:t},children:l?(0,d.jsx)(k,{routes:s}):(0,d.jsx)(w,{routes:s,column:e})})}),Z=(0,s.memo)(_)},18379:(e,t,n)=>{n.d(t,{DM:()=>c,Ns:()=>p,ZP:()=>x});var s=n(93386),i=n(27378),l=n(55480),r=n(21020),o=n(60666),a=n(18490),d=n(24246);const c=["#E4EDFF","#FFE4E3","#93FFC4","#D0D6E0","#E7ECF1","#EFE1C5","#F9F2E5","#FFF6DC","#FFB5B3","#68F6A8"],u=e=>{const t={};return e.choices&&e.choices.length||(t.choices="At least one option is required"),e.label||(t.label="Required"),t},p={label:"",choices:[{color:c[0],value:""}]},x=({onSubmit:e,initialValues:t=p,focusChoices:n=!1})=>{const x=(0,i.useCallback)(((t,n)=>{const s={...t,choices:t.choices.map(((e,t)=>({...e,rank:t})))};return e(s).catch((e=>{n.setErrors(e)}))}),[e]);return(0,d.jsx)(s.J9,{initialValues:t,onSubmit:x,validate:u,children:({values:e,dirty:t,isSubmitting:i})=>(0,d.jsx)(s.l0,{children:(0,d.jsxs)(l.xu,{sx:{bg:"white"},children:[(0,d.jsx)(l.xu,{sx:{p:3,bg:"bg2"},children:(0,d.jsx)(a.Z,{name:"label",label:"",inputProps:{autoFocus:!n,placeholder:"Enter name..."}})}),(0,d.jsx)(o.Z,{values:e.choices,colors:c,max:10,addPlaceholder:"Add another option",defaultChoicePlaceholder:"Enter option name…"}),(0,d.jsx)(l.xu,{sx:{p:3},children:(0,d.jsx)(r.ZP,{size:"md",intent:"submit",type:"submit",disabled:i||!t,sx:{width:"100%"},children:i?"Saving...":"Save"})})]})})})}},91349:(e,t,n)=>{n.d(t,{am:()=>je,tp:()=>Ce,vu:()=>ke,kM:()=>_e,ki:()=>we,qp:()=>Ze,ZP:()=>Se});var s=n(43408),i=n(23011),l=n(97310),r=n(33033),o=n(55480),a=n(36692),d=n(25257),c=n(27378),u=n(14523);var p=n(24246);const x=e=>(0,p.jsxs)("svg",{width:"92px",height:"90px",viewBox:"0 0 92 90",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"svg-inline--fa fa-icon fa-fw",...e,children:[(0,p.jsx)("path",{d:"M77.324568,12 C90.9167356,23.9999178 94.6557099,40.6664109 90.2376226,56.6670138 C84.4602083,79.3340002 63.3911927,90 45.7199439,90 C17.8542941,90 8,71.6671783 8,56.6670138 C8,41.6668494 17.175181,33.6665479 21.9322746,30.9997807 C11.3977668,44.3336165 19.2136209,56.0000548 24.3108214,61.3335891 C32.8068892,70.0008496 51.8374649,69.0004111 66.1098464,59.0003015 C94.6557099,39.0000822 77.324568,12 77.324568,12 Z"}),(0,p.jsx)("path",{d:"M8.18392933,70 C-14.2723116,36.8249168 13.2872197,0 44.9285018,0 C76.910297,0 85.7570289,24.5499445 76.5697838,44.7873197 C76.910297,37.4887163 63.6413012,22.8915095 42.5471132,22.8915095 C19.0704346,22.8915095 -2.70367791,42.1331854 8.18392933,70 Z"})]});var h=n(3223),m=n(28961),g=n(22279);const f=e=>(0,p.jsx)(o.xv,{sx:{color:"text3",fontSize:14,pb:"1px"},...e});var b=n(7988),v=n(92739),y=n(21020);const C=({route:e})=>{const{navigate:t,back:n}=(0,h.H9)(),s=(0,c.useCallback)((()=>{e?t(e):n()}),[t,e,n]);return(0,p.jsx)(y.ZP,{onClick:s,size:"sm",appearance:"tertiary",sx:{px:0,mx:2,color:"gray60",fontSize:"20px"},children:(0,p.jsx)(v.G,{fixedWidth:!0,icon:r.A3})})},j=({title:e})=>{const{hasBack:t}=(0,h.H9)();return(0,p.jsxs)(o.kC,{sx:{height:"50px",alignItems:"center",borderBottom:"1px solid",borderColor:"border1",px:t?0:3},children:[t?(0,p.jsx)(C,{}):null,(0,p.jsx)(o.xv,{variant:"heading4",children:e})]})};var w=n(80645);var k=n(24158),_=n(63678),Z=n(73208),S=n(20997),E=n(93386),I=n(88954),P=n(12241),T=n(18490);const F={px:3,":hover":{bg:"blue20",color:"white"}},R={value:k.cJ.text,name:"Text",icon:k.iD[k.cJ.text]},D=[{value:k.cJ.entity,name:"Entity",icon:k.iD[k.cJ.entity]},{value:k.cJ.location,name:"Location",icon:k.iD[k.cJ.location]},{value:k.cJ.url,name:"Url",icon:k.iD[k.cJ.url]},{value:k.cJ.number,name:"Number",icon:k.iD[k.cJ.number]},{value:k.cJ.decimal,name:"Decimal Number",icon:k.iD[k.cJ.decimal]},{value:k.cJ.date,name:"Date",icon:k.iD[k.cJ.date]},{value:k.cJ.boolean,name:"Checkbox",icon:k.iD[k.cJ.boolean]}],N=e=>{const t={};return e.label?e.label.length>30&&(t.label="Ensure that the field name is no longer than 30 characters"):t.label="Required",e.object_type||(t.object_type="Required"),t},L={label:"",object_type:R.value},M=({onSubmit:e,initialValues:t=L,onPipelineClick:n,onSelectFieldClick:s})=>{const i=(0,c.useCallback)(((t,n)=>e(t).catch((e=>n.setErrors(e)))),[e]),l=(0,c.useCallback)((e=>e.target.select()),[]);return(0,p.jsx)(E.J9,{initialValues:t,validate:N,onSubmit:i,validateOnBlur:!1,initialTouched:{label:!0},children:({isSubmitting:e,values:t})=>(0,p.jsx)(E.l0,{children:(0,p.jsxs)(P.Z,{gap:3,children:[(0,p.jsx)(o.xu,{sx:{p:3,bg:"bg2"},children:(0,p.jsx)(T.Z,{name:"label",label:"Name your new custom field",inputProps:{autoFocus:!0,placeholder:"Enter name...",onFocus:l}})}),(0,p.jsx)(I.Z,{name:"object_type",label:"Field type",labelSx:{px:3},children:({field:e,form:{setFieldValue:i}})=>(0,p.jsxs)(o.xu,{as:"ul",sx:{p:0,listStyle:"none"},children:[(0,p.jsx)(d.Z,{title:R.name,onClick:()=>i(R.name,R.value),icon:R.icon,sx:{...F,bg:e.value===R.value?"blue20":"initial"}}),(0,p.jsx)(d.Z,{title:"Pipeline",onClick:()=>n({label:t.label}),componentBefore:(0,p.jsx)(o.xu,{sx:{color:"text3"},children:(0,p.jsx)(m.Z,{})}),sx:F}),D.map((t=>(0,p.jsx)(d.Z,{title:t.name,onClick:()=>i(e.name,t.value),icon:t.icon,sx:{...F,bg:e.value===t.value?"blue20":"initial"}},t.value))),(0,p.jsx)(d.Z,{title:"Single-Select",onClick:()=>s({label:t.label}),icon:Z.LE,sx:F}),(0,p.jsx)(d.Z,{title:"Multi-Select",onClick:()=>s({label:t.label,multi:!0}),icon:S.th,sx:F})]})}),(0,p.jsx)(o.xu,{sx:{p:3},children:(0,p.jsx)(y.ZP,{size:"md",intent:"submit",type:"submit",disabled:e,sx:{width:"100%"},children:e?"Saving...":"Save"})})]})})})};var q=n(18379);var A=n(56552),O=n(68349),$=n(28206),z=n(62625),H=n(13783),B=n(22478),V=n(47869);var W=n(84605),K=n(74333),G=n(96680),U=n(52466),Q=n(95434);const X=e=>{const{index:t,column:n}=(0,w.$V)(),{columnsCount:s}=(0,c.useContext)(U.Z),i=(0,c.useMemo)((()=>t>1),[t]),l=(0,c.useMemo)((()=>t<s),[t,s]),{mutate:r}=(e=>{const t=(0,V.Z)(),{setCurrent:n}=(0,Q.Z)(["entityList",e]);return(0,A.useMutation)((({colId:n,newRank:s})=>t.post(`article-entitylists/${e}/reorder_columns/`,{column:n,rank:s})),{onSuccess:({columns:e})=>{n("columns",e)}})})(e),o=(0,c.useCallback)((e=>{r({colId:n.id,newRank:e-1})}),[n.id,r]);return(0,c.useMemo)((()=>(0,p.jsxs)(p.Fragment,{children:[i||l?(0,p.jsx)(g.Z,{}):null,i&&(0,p.jsx)(d.Z,{icon:K.s8,title:"Move left",onClick:()=>o(t-1),focusable:!0}),l&&(0,p.jsx)(d.Z,{icon:G._I,title:"Move right",onClick:()=>o(t+1),focusable:!0})]})),[i,l,o,t])};var J=n(27876);var Y=n(28957),ee=n(90915),te=n(42099),ne=n(88193),se=n(88718),ie=n(69554),le=n(49044),re=n(46345),oe=n(9306),ae=n(65923),de=n(96256);const ce=e=>{const t={};return e.label?e.label.length>30&&(t.label="Ensure that the field name is no longer than 30 characters"):t.label="Required",t};var ue=n(2454),pe=n(41992),xe=n(28055),he=n(85871),me=n(81868),ge=n(54981),fe=n(80193);const be=({field:e,isHighlighted:t,onSelect:n})=>{const s=(0,c.useRef)(null),i=(0,fe.b)(s);(0,c.useEffect)((()=>{t&&i({behavior:"smooth",block:"end",inline:"nearest"})}),[t,i]);const l=(0,c.useCallback)((()=>{n(e)}),[n,e]);return(0,p.jsx)(o.xu,{as:"li",ref:s,children:(0,p.jsx)(d.Z,{as:null,title:e.label,onClick:l,sx:{pr:3,pl:3,bg:t?"blue20":"initial"},children:(0,p.jsx)(o.xv,{variant:"pretitle1",sx:{color:"text3",ml:"auto"},children:e.type})},e.value)})},ve=({fields:e=[],placeholder:t="Search fields",onSelect:n,isLoading:s=!1,emptyMessage:i,label:l,emptyAction:r})=>{const a=(0,c.useRef)(null),[d,u]=(0,c.useState)(""),x=(0,c.useMemo)((()=>d?e.filter((e=>(0,ge.s)(d,e.label))):e),[e,d]),h=(0,c.useCallback)((e=>{const t=e.target.value;u(t)}),[]),{onKeyDown:m,positionIndex:g,setPositionIndex:f}=(0,he.Z)({length:x.length});(0,c.useEffect)((()=>{f(null)}),[x,f]),(0,w.Ts)(a);const b=(0,c.useCallback)((e=>{"Enter"===e.key&&null!==g&&(e.preventDefault(),n(x[g]))}),[g,n,x]),y=(0,c.useCallback)((e=>{(0,me.Z)(e,[m,b])}),[m,b]),C=0===x.length,j=0===e.length;return(0,p.jsxs)(o.xu,{children:[(0,p.jsx)(o.xu,{sx:{p:3,pt:2,bg:"bg2"},children:(0,p.jsx)(xe.II,{onChange:h,placeholder:t,onKeyDown:y,ref:a})}),(0,p.jsx)(o.xu,{as:"ul",sx:{p:0,listStyle:"none",height:"300px",maxHeight:"300px",overflowY:"auto",position:"relative"},children:s?(0,p.jsx)(o.kC,{alignItems:"center",justifyContent:"center",sx:{color:"blue50",height:"100%"},children:(0,p.jsx)(v.G,{icon:pe.LM,pulse:!0,size:"2x"})}):C?(0,p.jsxs)(o.kC,{flexDirection:"column",alignItems:"center",justifyContent:"center",sx:{height:"100%",px:3},children:[(0,p.jsx)(o.xv,{variant:"heading4",textAlign:"center",children:j?i:`No ${l} matching your query`}),j&&r?(0,p.jsxs)(o.xv,{variant:"body1",sx:{mt:3},children:["Create your first one ",(0,p.jsx)(o.rU,{onClick:r,children:"here"}),"."]}):null]}):x.map(((e,t)=>(0,p.jsx)(be,{isHighlighted:g===t,onSelect:n,field:e},e.value)))})]})},ye={main:"main-menu",listViewMain:"list-view-main-menu",changeFieldType:"change-field-type",renamePrivateField:"rename-private-field",editPipelineField:"edit-pipeline-field",editSelectField:"edit-select-field",createPipelineField:"create-pipeline-field",createSelectField:"create-select-field",createPrivateField:"create-private-field",selectGoldenField:"select-golden-field",selectPrivateField:"select-private-field",selectPipelineField:"select-pipeline-field"},Ce={[ye.main]:()=>{const{navigate:e}=(0,h.H9)(),t=(0,$.T)(),{list:n}=(0,O.useEntityListDetail)(),{isEditor:l}=(0,le.Z)(),{column:r,index:u,isDescription:x,isSelectField:m}=(0,w.$V)(),f=(0,$.C)(ae._H),b=(0,c.useMemo)((()=>"wiki"!==f.slug),[f]),v=(0,re.p)([r]).length>0&&!r.predicate,{onSortDescending:y,onSortAscending:C,hasSorting:j}=(0,w.OU)(),k=(0,c.useCallback)((e=>{t((0,z.tL)(u-1,e-1))}),[t,u]),_=(0,c.useMemo)((()=>l&&u>1),[u,l]),Z=(0,c.useMemo)((()=>l&&u<n.columns.length),[u,n,l]),E=(0,c.useCallback)(((e,{onClose:n})=>{t((0,oe.yG)({column:r.id,type:r.field_model})),t((0,oe.hg)(!0)),n()}),[t,r]),I=(0,c.useCallback)((()=>{t((0,z.hU)(r.id))}),[t,r]),P=(0,ie.Z)(re.Xk.ENTITY_LIST,n,{infoboxes:[r.fieldType]}),{open:T}=(0,de.e)(),F=(0,c.useCallback)(((e,{onClose:t})=>{T(P),t()}),[T,P]);return(0,p.jsxs)(o.xu,{as:"ul",sx:{width:"300px",listStyle:"none",p:0,py:3},children:[b&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.Z,{icon:s.K,title:"Change field",onClick:()=>e(Se.changeFieldType),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),(0,p.jsx)(g.Z,{})]}),r.predicate&&(0,p.jsx)(d.Z,{icon:ne.Xc,title:"Rename Custom field",onClick:()=>e(Se.renamePrivateField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),r.pipeline&&(0,p.jsx)(d.Z,{icon:ne.Xc,title:"Edit pipeline",onClick:()=>e(Se.editPipelineField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),m&&(0,p.jsx)(d.Z,{icon:S.th,title:"Configure Options",onClick:()=>e(Se.editSelectField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),_&&(0,p.jsx)(d.Z,{icon:K.s8,title:"Move left",onClick:()=>k(u-1),focusable:!0}),Z&&(0,p.jsx)(d.Z,{icon:G._I,title:"Move right",onClick:()=>k(u+1),focusable:!0}),(j||!x)&&l&&(0,p.jsx)(g.Z,{}),j&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.Z,{icon:ee.eG,title:"Sort by A -> Z",onClick:C,focusable:!0}),(0,p.jsx)(d.Z,{icon:te.xr,title:"Sort by Z -> A",onClick:y,focusable:!0})]}),!x&&(0,p.jsx)(d.Z,{icon:Y.G_,title:"Add filter",onClick:E,focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),(v||l)&&(0,p.jsx)(g.Z,{}),v&&(0,p.jsx)(d.Z,{componentBefore:(0,p.jsx)(a.Z,{children:(0,p.jsx)(se.Z,{weight:"light"})}),title:"Data Request",onClick:F,sx:{display:"flex",alignItems:"center"},focusable:!0}),l?(0,p.jsx)(d.Z,{icon:W.$,title:"Delete column",onClick:I,focusable:!0}):null]})},[ye.listViewMain]:()=>{const{listId:e,setOrdering:t}=(0,c.useContext)(U.Z),{column:n}=(0,w.$V)(),{navigate:l}=(0,h.H9)(),r=(0,J.Z)({setOrdering:t}),u=X(e),{mutate:x}=(e=>{const t=(0,V.Z)(),{setCurrent:n}=(0,Q.Z)(["entityList",e]);return(0,A.useMutation)((({colId:n})=>t.post(`article-entitylists/${e}/remove_column/`,{column:n})),{onSuccess:({columns:e})=>{n("columns",e)}})})(e),m=(0,c.useCallback)((()=>{x({colId:n.id})}),[x,n.id]),f=(0,$.C)((e=>e.editor.editMode));return(0,p.jsxs)(o.xu,{as:"ul",sx:{width:"300px",listStyle:"none",p:0,py:3},children:[f&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.Z,{icon:s.K,title:"Change field",onClick:()=>l(Se.selectGoldenField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),u]}),r&&f?(0,p.jsx)(g.Z,{}):null,r,f&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(g.Z,{}),(0,p.jsx)(d.Z,{icon:W.$,title:"Delete column",onClick:m,focusable:!0})]})]})},[ye.changeFieldType]:()=>{const{navigate:e,hasBack:t,back:n}=(0,h.H9)();return(()=>{const{forceUpdatePopper:e}=(0,c.useContext)(u.Z);(0,c.useEffect)((()=>(e&&e(),()=>{e&&e()})),[e])})(),(0,p.jsxs)(o.xu,{as:"ul",sx:{width:"350px",listStyle:"none",p:0,py:3},children:[t&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.Z,{icon:r.A3,title:"Back",onClick:n,focusable:!0}),(0,p.jsx)(g.Z,{})]}),(0,p.jsx)(d.Z,{componentBefore:(0,p.jsx)(f,{children:(0,p.jsx)(x,{})}),title:"Select Golden Knowledge Graph field",onClick:()=>e(Se.selectGoldenField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),(0,p.jsx)(d.Z,{icon:s.K,title:"Select existing Custom field",onClick:()=>e(Se.selectPrivateField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),(0,p.jsx)(d.Z,{componentBefore:(0,p.jsx)(f,{children:(0,p.jsx)(m.Z,{})}),title:"Select existing Pipeline field",onClick:()=>e(Se.selectPipelineField),focusable:!0,children:(0,p.jsx)(a.Z,{icon:i._t,sx:{ml:"auto"}})}),(0,p.jsx)(g.Z,{}),(0,p.jsx)(d.Z,{icon:l.r8,title:"Add new custom field",onClick:()=>e(Se.createPrivateField),focusable:!0}),(0,p.jsx)(d.Z,{icon:l.r8,title:"Add new pipeline field",onClick:()=>e(Se.createPipelineField),focusable:!0})]})},[ye.renamePrivateField]:()=>{const{onClose:e}=(0,c.useContext)(u.Z),{column:t}=(0,w.$V)(),{mutateAsync:n}=(0,w.uh)(t,e),s=(0,c.useMemo)((()=>({label:t.predicate.label})),[t]),i=(0,c.useCallback)(((e,t)=>n(e).catch((e=>t.setErrors(e)))),[n]);return(0,p.jsxs)(o.xu,{sx:{width:"350px"},children:[(0,p.jsx)(j,{title:"Rename Custom Field"}),(0,p.jsx)(E.J9,{initialValues:s,validate:ce,onSubmit:i,initialTouched:{label:!0},children:(0,p.jsxs)(E.l0,{children:[(0,p.jsx)(o.xu,{sx:{p:3},children:(0,p.jsx)(T.Z,{name:"label",label:"Name your custom field",inputProps:{autoFocus:!0,placeholder:"Enter name..."}})}),(0,p.jsx)(o.kC,{justifyContent:"flex-end",sx:{p:3,pt:0},children:(0,p.jsx)(y.ZP,{minWidth:!0,intent:"submit",type:"submit",children:"Save"})})]})})]})},[ye.editPipelineField]:()=>{const e=(0,$.T)(),t=(0,V.Z)(),{onClose:n}=(0,c.useContext)(u.Z),{column:s}=(0,w.$V)(),{list:i}=(0,O.useEntityListDetail)(),{mutateAsync:l}=(0,A.useMutation)((e=>t.patch(`list_pipeline/${s.pipeline.id}/?organization_slug=${s.pipeline.organization}`,e)),{onSuccess:t=>{e((0,H.Sq)(t)),e((0,z.rI)(i.id)),n()},onError:t=>{if(t.response&&400===t.response.status)return t.response.json().then((e=>{throw e}));e((0,B.S1)("Error updating pipeline field","error"))}}),r=(0,c.useMemo)((()=>({name:s.pipeline.name,choices:s.pipeline.choices.map((({value:e,color:t,id:n,rank:s})=>({pk:n,value:e,color:t,rank:s})))})),[s]),a=(0,c.useCallback)(((e,t)=>l(e).catch((e=>t.setErrors(e)))),[l]);return(0,p.jsxs)(o.xu,{sx:{width:"350px"},children:[(0,p.jsx)(j,{title:"Edit Pipeline"}),(0,p.jsx)(o.xu,{sx:{p:3,pb:0,bg:"bg2"},children:(0,p.jsx)(o.xv,{variant:"heading4",children:"Name your Pipeline"})}),(0,p.jsx)(b.ZP,{initialValues:r,onSubmit:a})]})},[ye.editSelectField]:()=>{const e=(0,$.T)(),{onClose:t}=(0,c.useContext)(u.Z),{column:n}=(0,w.$V)(),{list:s}=(0,O.useEntityListDetail)(),i=(0,c.useCallback)((()=>{e((0,z.rI)(s.id)),t()}),[e,s,t]),{mutateAsync:l}=(0,w.uh)(n,i),r=n.predicate.allow_multiple,a=(0,c.useMemo)((()=>r?"Multi-select":"Single-select"),[r]),d=(0,c.useMemo)((()=>({label:n.predicate.label,choices:n.predicate.choices.map((({id:e,...t})=>({_id:e,...t})))})),[n]),x=(0,c.useCallback)((({name:e,...t})=>l({label:e,...t})),[l]);return(0,p.jsxs)(o.xu,{sx:{width:"350px"},children:[(0,p.jsx)(j,{title:`Configure ${a} Field`}),(0,p.jsx)(o.xu,{sx:{p:3,pb:0,bg:"bg2"},children:(0,p.jsx)(o.xv,{variant:"heading4",children:`Name your ${a} field`})}),(0,p.jsx)(q.ZP,{initialValues:d,onSubmit:x})]})},[ye.createPipelineField]:()=>{const{column:e}=(0,w.$V)(),{mutateAsync:t}=(0,w.nn)(e),{state:n}=(0,h.H9)();return(0,p.jsxs)(o.xu,{sx:{minWidth:"350px"},children:[(0,p.jsx)(j,{title:"Add new Pipeline Field"}),(0,p.jsx)(o.xu,{sx:{p:3,pb:0,bg:"bg2"},children:(0,p.jsx)(o.xv,{variant:"heading4",children:"Name your Pipeline"})}),(0,p.jsx)(b.ZP,{onSubmit:t,initialValues:{...b.Ns,name:(null==n?void 0:n.label)||""}})]})},[ye.createSelectField]:()=>{const{column:e}=(0,w.$V)(),{mutateAsync:t}=(0,w.ki)(e),{state:n}=(0,h.H9)(),s=!(null==n||!n.multi),i=(0,c.useMemo)((()=>s?"Multi-select":"Single-select"),[s]),l=(0,c.useCallback)((e=>t({...e,allow_multiple:s,object_type:"text"})),[t,s]);return(0,p.jsxs)(o.xu,{sx:{minWidth:"350px"},children:[(0,p.jsx)(j,{title:`Add new ${i}`}),(0,p.jsx)(o.xu,{sx:{p:3,pb:0,bg:"bg2"},children:(0,p.jsx)(o.xv,{variant:"heading4",children:`Name your ${i} field`})}),(0,p.jsx)(q.ZP,{onSubmit:l,initialValues:{...q.Ns,label:(null==n?void 0:n.label)||""}})]})},[ye.createPrivateField]:()=>{const{navigate:e}=(0,h.H9)(),{column:t}=(0,w.$V)(),{mutateAsync:n}=(0,w.ki)(t),{allPredicatedCount:s}=(0,_.YD)(),i=(0,c.useMemo)((()=>({label:`Custom Field ${s+1}`,object_type:k.cJ.text})),[s]);return(0,p.jsxs)(o.xu,{sx:{minWidth:"350px"},children:[(0,p.jsx)(j,{title:"Add new Custom Field"}),(0,p.jsx)(M,{initialValues:i,onSubmit:n,onPipelineClick:t=>{e(Se.createPipelineField,t)},onSelectFieldClick:t=>{e(Se.createSelectField,t)}},s)]})},[ye.selectGoldenField]:()=>{const{listId:e}=(0,c.useContext)(U.Z)||{},{mutateAsync:t}=(0,w.kL)(),{column:n}=(0,w.$V)(),{mutate:s}=(e=>{const t=(0,$.T)(),{setCurrent:n}=(0,Q.Z)(["entityList",e]),s=(0,V.Z)();return(0,A.useMutation)((t=>s.post(`article-entitylists/${e}/add_column/`,t)),{onSuccess:e=>{n("columns",e.columns)},onError:()=>{t((0,B.S1)("Error changing a column","error"))}})})(e),i=(0,$.C)(ue.Ke),l=(0,c.useMemo)((()=>i.map((e=>({label:e.label,value:e.id,type:e.field_model})))),[i]),r=(0,c.useCallback)((({value:i})=>{e?s({fieldtype:i,column:n.id}):t({fieldtype:i,column:n.id})}),[e,n,s,t]);return(0,p.jsxs)(o.xu,{sx:{minWidth:"350px"},children:[(0,p.jsx)(j,{title:"Select Golden Knowledge Graph field"}),(0,p.jsx)(o.xu,{sx:{p:3,pb:0,bg:"bg2"},children:(0,p.jsx)(o.xv,{variant:"heading4",children:"Golden Knowledge Graph Fields"})}),(0,p.jsx)(ve,{fields:l,onSelect:r})]})},[ye.selectPrivateField]:()=>{const{navigate:e}=(0,h.H9)(),{column:t}=(0,w.$V)(),{mutate:n}=(0,w.kL)(),{availablePredicates:s,isLoading:i,selectedPredicatesIds:l}=(0,_.YD)(),r=(0,c.useMemo)((()=>s.map((e=>({label:e.label,value:e.id,type:e.type_label})))),[s]),a=(0,c.useCallback)((({value:e})=>{n({predicate:e,column:t.id})}),[t,n]);return(0,p.jsxs)(o.xu,{sx:{width:"350px"},children:[(0,p.jsx)(j,{title:"Select existing Custom field"}),(0,p.jsxs)(o.kC,{sx:{p:3,pb:0,bg:"bg2",justifyContent:"space-between",alignItems:"baseline"},children:[(0,p.jsx)(o.xv,{variant:"heading4",children:"Custom fields"}),(0,p.jsx)(o.xv,{variant:"caption1",onClick:()=>e(Se.createPrivateField),sx:{cursor:"pointer",whiteSpace:"nowrap",color:"textBlue",":hover, :focus":{color:"textBlueHover"}},children:"+ Create new Custom field"})]}),(0,p.jsx)(ve,{fields:r,isLoading:i,onSelect:a,label:"Custom fields",emptyMessage:l.length?"There are no more Custom fields available to select.":"You have not created any Custom fields yet.",emptyAction:()=>e(Se.createPrivateField)})]})},[ye.selectPipelineField]:()=>{const{navigate:e}=(0,h.H9)(),{column:t}=(0,w.$V)(),{mutate:n}=(0,w.kL)(),{data:s,isLoading:i}=(0,_.q8)(),l=(0,c.useMemo)((()=>s.map((e=>({label:e.name,value:e.id,type:e.field_model})))),[s]),r=(0,c.useCallback)((({value:e})=>{n({pipeline:e,column:t.id})}),[t,n]);return(0,p.jsxs)(o.xu,{sx:{minWidth:"350px"},children:[(0,p.jsx)(j,{title:"Select existing Pipeline field"}),(0,p.jsxs)(o.kC,{sx:{p:3,pb:0,bg:"bg2",justifyContent:"space-between",alignItems:"baseline"},children:[(0,p.jsx)(o.xv,{variant:"heading4",children:"Pipelines"}),(0,p.jsx)(o.xv,{variant:"caption1",onClick:()=>e(Se.createPipelineField),sx:{cursor:"pointer",whiteSpace:"nowrap",color:"textBlue",":hover, :focus":{color:"textBlueHover"}},children:"+ Create new Pipeline field"})]}),(0,p.jsx)(ve,{fields:l,isLoading:i,onSelect:r,label:"Pipeline fields",emptyMessage:"You have not created any Pipeline fields yet.",emptyAction:()=>e(Se.createPipelineField)})]})}},je=[ye.changeFieldType,ye.createPipelineField,ye.createSelectField,ye.createPrivateField,ye.selectGoldenField,ye.selectPrivateField,ye.selectPipelineField],we=[ye.selectGoldenField],ke=[ye.main,ye.renamePrivateField,ye.editPipelineField,ye.editSelectField,...je],_e=[ye.listViewMain,ye.selectGoldenField],Ze=[ye.createPrivateField,ye.createPipelineField,ye.createSelectField],Se=ye},27876:(e,t,n)=>{n.d(t,{Z:()=>c}),n(95623);var s=n(90915),i=n(42099),l=n(27378),r=n(25257),o=n(80645),a=n(24246);const d=["number","int","float","date","text","entity","location"],c=({setOrdering:e})=>{var t,n;const{column:c}=(0,o.$V)(),u="name"===(null===(t=c.fieldType)||void 0===t?void 0:t.name),p="description"===(null===(n=c.fieldType)||void 0===n?void 0:n.name),x=(0,l.useMemo)((()=>{var e,t;return!p&&d.includes(null!==(e=null===(t=c.fieldType)||void 0===t?void 0:t.field_model)&&void 0!==e?e:"")||u}),[c,u,p]),h=(0,l.useCallback)((()=>{e(`${c.id}`)}),[e,c.id]),m=(0,l.useCallback)((()=>{e(`-${c.id}`)}),[e,c.id]);return(0,l.useMemo)((()=>x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z,{icon:s.eG,title:"Sort by A -> Z",onClick:h,focusable:!0}),(0,a.jsx)(r.Z,{icon:i.xr,title:"Sort by Z -> A",onClick:m,focusable:!0})]}):null),[h,m,x])}},49008:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(11628),i=n(5042);const l=({children:e})=>e,r=(0,n(39236).Z)((0,i.Z)((0,s.ZP)({resolved:{},chunkName:()=>"components-FullScreenWrapper-FullScreenWrapper",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e(5472).then(n.bind(n,14556)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>14556}),{Fallback:l}),{Fallback:l})},3950:(e,t,n)=>{n.d(t,{Z:()=>f});var s=n(27378),i=n(31542),l=n(60042),r=n.n(l),o=n(88460),a=n(24246);const d=(0,o.Z)("Card"),c=({children:e,className:t,transparent:n,...s})=>(0,a.jsx)("div",{className:r()(d(void 0,n?"transparent":"normal"),t),...s,children:e});c.defaultProps={transparent:!1};const u=c;var p=n(86697),x=n(52606),h=n(42244);function m(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends s.PureComponent{constructor(...e){super(...e),m(this,"onKeyDown",(e=>{this.props.open&&"Escape"===e.key&&this.props.onClose()}))}componentDidMount(){window.addEventListener("keydown",this.onKeyDown)}componentWillUnmount(){window.removeEventListener("keydown",this.onKeyDown)}render(){const{open:e,citation:t}=this.props;return e?(0,i.createPortal)((0,a.jsxs)("div",{className:"Lightbox__wrapper",onClick:this.props.onClose,role:"presentation",children:[(0,a.jsx)("div",{className:"Lightbox__imgWrapper",children:(0,a.jsx)("img",{className:"Lightbox__img",src:this.props.src,alt:this.props.alt})}),(0,a.jsx)(x.Z,{className:"Lightbox__closeBtn"}),t?(0,a.jsx)(h.Z,{FallbackComponent:null,children:(0,a.jsx)(u,{className:"Lightbox__citation",children:(0,a.jsx)(p.ZP,{type:t.source_type,citation:{...t,...t.payload}})})}):null]}),document.getElementById("modal-portal")):null}}m(g,"defaultProps",{open:!1});const f=g},3223:(e,t,n)=>{n.d(t,{H9:()=>a,TS:()=>o,ZP:()=>d});var s=n(27378),i=n(24246);const l=(0,s.createContext)(void 0),r=({initialRoute:e,children:t})=>{const[n,r]=(0,s.useState)([e]),[o,a]=(0,s.useState)({}),d=(0,s.useCallback)(((e,t={})=>{r(e),a(t)}),[]),c=(0,s.useCallback)(((e,t)=>{d([...n,e],t)}),[n,d]),u=(0,s.useCallback)((()=>{if(n.length>1){const e=[...n];e.pop(),d(e)}}),[n,d]),p=(0,s.useMemo)((()=>n[n.length-1]),[n]),x=(0,s.useMemo)((()=>n.length>1),[n]);return(0,i.jsx)(l.Provider,{value:{currentPage:p,navigate:c,back:u,routeStack:n,setRouteStack:d,state:o,hasBack:x},children:t})},o=(0,s.memo)((({route:e,children:t})=>{const{currentPage:n}=(0,s.useContext)(l);return n!==e?null:(0,i.jsx)(i.Fragment,{children:t})})),a=()=>(0,s.useContext)(l),d=(0,s.memo)(r)},21965:(e,t,n)=>{n.d(t,{Z:()=>x});var s=n(27378),i=n(55480),l=n(92849),r=n(94432),o=n(50381),a=n(42577),d=n(28206),c=n(88460),u=n(24246);const p=(0,c.Z)("NewEditorTableCell"),x=({row:e,col:t,isFocused:n,orderRow:c,onChange:x,isReadOnly:h,isStandardTable:m})=>{const g=(0,s.useRef)(null),f=(0,s.useMemo)((()=>function(e){if("string"==typeof e)return(0,a.Sl)(e);switch(e.type){case"static":return(0,a.Sl)(e.value.text);case"link":return(0,a.fh)(e.value.text);case"internal-link":return(0,a.ex)(e.value.text,e.value.id);default:return e}}(e.value[t.key]||"")),[e,t]),b=(0,d.C)((e=>e.editor.editMode)),[v,y]=(0,s.useState)(!1),[C,j]=(0,s.useState)(f),w=(0,s.useMemo)((()=>e.changed||e.inserted||e.deleted||t.inserted||t.deleted),[e,t]);(0,s.useEffect)((()=>{j(f)}),[f]);const[k,_]=(0,s.useState)(!1),Z=(0,s.useCallback)((e=>{!v&&y(!0),j(e),!k&&_(!0)}),[v,y,k]);(0,s.useEffect)((()=>{v&&g.current&&g.current.focus({edge:"end"})}),[v]);const S=(0,s.useCallback)((()=>{!h&&y(!0)}),[h]),E=(0,s.useCallback)((e=>{"Enter"===e.key&&(e.stopPropagation(),e.preventDefault(),S())}),[S]);(0,s.useEffect)((()=>(n?window.addEventListener("keydown",E):(y(!1),window.removeEventListener("keydown",E)),()=>window.removeEventListener("keydown",E))),[n,E,y]),(0,s.useEffect)((()=>{!v&&k&&(x(C,c,t.key),_(!1))}),[v,x,C,c,t,k]);const I=(0,s.useCallback)((e=>{let{key:t}=e;switch(t){case"Escape":e.stopPropagation(),y(!1);break;case"Enter":case"ArrowLeft":case"ArrowRight":e.stopPropagation();break;case"Tab":case"ArrowDown":case"ArrowUp":e.preventDefault(),e.stopPropagation(),y(!1)}}),[y]);return n&&b&&v?(0,u.jsx)(r.ZP,{editorKey:m?o.ps:o.M0,className:p("editor",[n&&"isFocused"]),documentGolden:C,onChange:Z,onRef:g,onKeyDown:I}):(0,u.jsx)(i.xu,{onClick:S,sx:{minHeight:"100%"},children:(0,u.jsx)(l.Z,{className:p("editor",w?["diff",t.inserted&&"inserted",t.deleted&&"deleted"]:["readOnly",n&&"isFocused"]),documentGolden:C,renderFlags:w?["diff"]:void 0})})}},45347:(e,t,n)=>{n.d(t,{Z:()=>se});var s=n(95626),i=n(40512),l=n(78620),r=n(61528),o=n(73549),a=n(27378),d=n(79562),c=n.n(d),u=n(17885),p=n(88460),x=n(24246);const h=(0,p.Z)("EditTableHeadComponent"),m=({orderCol:e,onChangeTable:t,cols:n})=>{const s=(0,a.useMemo)((()=>n[e]),[n,e]),[i,l]=(0,a.useState)(s.name);return(0,x.jsx)(u.Z,{className:h(),tabIndex:0,value:i,onChange:e=>l(c()(e)),inputProps:{onClick:e=>e.stopPropagation(),onBlur:()=>{const s=n[e],l=[...n];l[e]={...s,name:c()(i)},t({newCols:l})},placeholder:"Column name",draggable:!0,onDragStart:e=>{e.preventDefault(),e.stopPropagation()},onKeyDown:e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),e.currentTarget.blur())}}})};var g=n(80917),f=n(49008),b=n(21965),v=n(66726),y=n.n(v),C=n(56274),j=n(7703),w=n(42577),k=n(28206),_=n(69809),Z=n(23113),S=n(22478),E=n(47869),I=n(50613),P=n(70664),T=n(62412);const F=(0,p.Z)("NewEditorTableLinkCell"),R=["author","title","date","type"];class D extends Error{}const N=e=>{const{row:t,col:n,onRowChange:s,isFocused:i}=e,[l]=n.key,r=(0,a.useRef)(null),o=(0,E.Z)(),d=(0,k.T)(),c=(0,k.C)((e=>e.editor.editMode)),[u,p]=(0,a.useState)(!1),{isLocked:h}=(0,k.C)(_.VW),m=(0,a.useMemo)((()=>{const e=t.value[n.key]||"";return!(0,P.Z)(e)}),[t,n]),g=(0,a.useCallback)((e=>{const n={...t,value:{...t.value,[l]:(0,w.fh)(e)}};return d((0,Z.F1)({copy:"enter edit mode",action:"edit"})).then((()=>(p(!0),o.post("sources/autogen/",{input:e})))).then((e=>{if(e.error)throw new D(e.error);return e})).then((({payload:{author:e=[],title:t=[],issued:i=[]}={},source_type:l=""}={})=>{const r=l.slice(0,1)+l.slice(1).toLowerCase(),o={author:e.join(", "),title:t[0],date:j.Z.renderDate(i[0]),type:"General"!==r?r:""};return R.forEach((e=>{o[e]&&(n.value[e]=(0,w.Sl)(o[e]))})),c?s(n,n.index):d((0,_.ns)()).then((e=>{e&&s(n,n.index)}))})).catch((e=>{e instanceof D?(r.current.value="",d((0,S.S1)(e.message,"error"))):s(n,n.index)})).then((()=>p(!1)))}),[o,d,c,s,t,l]),f=(0,a.useCallback)(y()((e=>{const t=(0,I.Z)(e);(0,T.j)(t)&&!u&&g(t)}),400),[g,u]),v=(0,a.useCallback)((e=>f(e.target.value)),[f]);(0,a.useEffect)((()=>{r.current&&(i?r.current.focus():r.current.blur())}),[i]);const N=m&&!h?(0,x.jsx)("input",{className:F("input"),placeholder:"Auto-extract from URL...",onChange:v,ref:r}):(0,x.jsx)(b.Z,{...e});return(0,x.jsxs)("div",{className:F("wrapper"),children:[N,(m&&!h||u)&&(0,x.jsx)(C.Z,{className:F("autogenIcon"),shouldAnimate:u})]})};var L=n(80165),M=n(92739),q=n(55480);const A=({onClick:e,children:t})=>(0,x.jsx)(q.zx,{onMouseDown:e=>e.preventDefault(),onClick:t=>{t.stopPropagation(),e()},onKeyDown:t=>{"Enter"===t.key&&(t.stopPropagation(),t.preventDefault(),e())},sx:{border:1,borderTop:0,mt:"-1px",padding:1,width:"100%",bg:"bg2",borderRadius:0,color:"text2",textAlign:"left",":hover":{bg:"bg3"}},children:t||(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(q.xv,{as:"span",sx:{mx:2,fontSize:"15px"},children:(0,x.jsx)(M.G,{icon:L.r8})}),(0,x.jsx)("span",{children:"Add new row"})]})});var O=n(55046),$=n(84891),z=n(25453),H=n(18285);const B=({tableKey:e})=>{const t=(0,k.T)(),[n,s]=(0,a.useState)(!1),i=(0,a.useCallback)((()=>{t(((e,t)=>(n,s)=>{const i=s().editor.standardTables,l=i[e]||[],r=l.length,o=[...l,{index:r,value:{}}];t(!0),n((0,_.ns)()).then((s=>{s?((0,H.dW)(`${H.Is}${e}${r}`),n((0,_.qn)({standardTables:{...i,[e]:o}})),n((0,z.Ug)(["structuredData","standardTables",e],o))):t(!1)}))})(e,s))}),[t,s,e]),{isLocked:l,message:r}=(0,k.C)(_.VW);return(0,x.jsx)($.R,{disabled:!l,tooltip:r,sx:{width:"100%"},showOnTop:!0,children:(0,x.jsx)(A,{onClick:i,children:n&&(0,x.jsx)(M.G,{icon:O.LM,spin:!0})})})};var V=n(60202),W=n(97240),K=n(55553),G=n(83707),U=n(85274),Q=n(24158),X=n(43232),J=n(13891),Y=n(34927),ee=n(71074);const te=({rows:e,cols:t,isReadOnly:n,dragHandleProps:d,onChange:c,setRows:u,onDelete:p,title:h,titleIcon:v,isStandardTable:y=!1,tableKey:C,isQuickView:j=!1,isDiff:w=!1})=>{const _=(0,a.useRef)(C||(0,J.Vj)()).current,Z=(0,k.T)(),S=(0,a.useMemo)((()=>t.map((e=>({...e,component:U.S2&&y&&"link"===e.key[0]?N:b.Z})))),[t,y]),{page:E,pageSize:I,pagesCount:P,firstRowIndex:T,currentPage:F,setCurrentPage:R}=(0,ee.h)({pageSize:5,list:e}),D=(0,a.useCallback)(((t,n)=>{u([...e].sort(((e,s)=>(0,Y.Z)(e,s,t,n)))),R(1)}),[e,R,u]),L=(0,a.useCallback)((({newCols:n=t,newRows:s=e,newTitle:i=h,empty:l=!1}={})=>{s!==e&&u(s);const r=[...s];r.sort(((e,t)=>e.index-t.index));const o=r.filter((e=>e.value!==Q.Nu)).map((({index:e,...t})=>t));c({columns:n,rows:o,empty:l,title:i})}),[t,c,e,h,u]),M=(0,a.useCallback)((t=>{const n=e.filter(((e,n)=>n!==T+t));L({newRows:n})}),[e,T,L]),q=(0,a.useCallback)(((t,n,s)=>{const i=Array.isArray(s)?s[0]:s,l=[...e],r=T+n,{value:o={},index:a=r,...d}=l[r]||{};l[r]={...d,index:a,value:{...o,[i]:t}},L({newRows:l})}),[e,T,L]),O=(0,a.useCallback)(((t,n)=>{const s=[...e];return s[n]=t,L({newRows:s})}),[L,e]),$=(0,a.useMemo)((()=>{const e=[{icon:s.xr,value:"asc",onClick:(e,t)=>{D(t,!1)}},{icon:i.eG,value:"desc",onClick:(e,t)=>{D(t,!0)}}];return n||y||e.push({icon:l.$,value:"Delete column",onClick:(e,n)=>{const s=t.filter((e=>e.key!==n));s.length?L({newCols:s}):p()}}),e}),[n,D,t,L,p,y]),z=(0,a.useCallback)((()=>{L({newCols:t.concat({key:[`${t.length}-${Date.now().toString()}`],name:""})})}),[t,L]),te=(0,a.useCallback)((()=>{const t=e.length%I,n=0===t&&0!==e.length?P+1:P;R(n),(0,H.dW)(`${H.Is}${_}${t}`),L({newRows:e.concat({index:e.length,value:Q.Nu})})}),[e,I,P,R,_,L]),ne=(0,a.useMemo)((()=>({isReadOnly:n,onChange:q,isStandardTable:y,...y?{focusColOrder:y?Math.max(t.findIndex((e=>"link"===e.key[0])),0):null,onRowChange:O}:{}})),[q,y,t,O,n]),se=(0,a.useCallback)(((e,n,s)=>{const i=[...t],l="left"===s?n-(e>=n?0:1):n+(e>n?1:0);if(l===e)return;const r=i[e];i.splice(e,1),i.splice(l,0,r),L({newCols:i})}),[t,L]),ie=(0,a.useCallback)((e=>(0,x.jsx)(K.Z,{icon:l.$,onClick:()=>M(e)})),[M]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"flex items-end justify-end relative mt-3",children:[(0,x.jsx)(g.Z,{titleIcon:v,initialValue:h,onChange:e=>L({newTitle:e}),editMode:!n&&!y,isDiff:w,isStandardTable:y}),e.length>5&&!j&&(0,x.jsx)(W.Z,{icon:r.TT,tooltip:"Expand table",onClick:()=>Z((0,X.u)(_))}),!n&&!y&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(W.Z,{icon:l.$,tooltip:"Remove table",onClick:p}),(0,x.jsx)(W.Z,{icon:o.Qg,tooltip:"Drag table",dragHandleProps:d})]})]}),(0,x.jsxs)(f.Z,{fullScreenKey:_,children:[(0,x.jsx)(V.Z,{tableKey:_,rows:E,cols:S,dropdownItems:$,cellProps:ne,onChangeColsOrder:n||y?null:se,rowProps:n?{}:{renderRowActions:ie},onAddNewColumn:n||y?null:z,editableColComponent:n||y?null:(0,x.jsx)(m,{onChangeTable:L,cols:t}),headerIsSticky:!j}),U.S2&&y&&!e.length&&n&&(0,x.jsx)(B,{tableKey:_}),!n&&(0,x.jsx)(A,{onClick:te}),P>1&&(0,x.jsx)(G.Z,{resultsCount:e.length,currentPage:F,pageSize:I,fetchPage:R,sx:{width:n?"100%":"calc(100% - 50px)"}})]})]})};te.defaultProps={isDiff:!1,isReadOnly:!1};const ne=e=>{const{rows:t,cols:n}=e,[s,i]=(0,a.useState)((()=>t.map(((e,t)=>({...e,index:t}))).sort(((e,t)=>(0,Y.Z)(e,t,n[0].key,!1)))));return(0,x.jsx)(te,{...e,rows:s,setRows:i})},se=e=>{const{setRows:t}=e;return t?(0,x.jsx)(te,{...e}):(0,x.jsx)(ne,{...e})}},60202:(e,t,n)=>{n.d(t,{N:()=>$,Z:()=>H});var s=n(82593),i=n(92739),l=n(71236),r=n(27378),o=n(55480),a=n(92725),d=n(25257),c=n(75822),u=n(44926),p=n(43268),x=n(88460),h=n(2958),m=n(24246);const g=(0,x.Z)("NewTableHeadCell"),f=({tableKey:e,col:t,dropdownItems:n,getItemText:s,renderChildren:i,editableComponent:l,orderCol:a,setDraggedColOrder:p,onColDrop:x,draggable:f,isDragging:b,sx:v,isLastCell:y,className:C})=>{const j=(0,r.useRef)(null),[w,k]=(0,r.useState)(!1),[_,Z]=(0,r.useState)(""),S=(0,r.useCallback)((e=>{e.stopPropagation();const t=e.pageX-j.current.getBoundingClientRect().left,n=j.current.clientWidth;x(a,t<n/2?"left":"right"),Z("")}),[a,x]),E=(0,r.useCallback)((e=>{e.stopPropagation(),p(a)}),[a,p]),I=(0,r.useCallback)(((e,t)=>{e.preventDefault(),e.stopPropagation(),Z(t)}),[Z]),P=(0,r.useMemo)((()=>j.current?j.current.closest(".NewTable").clientHeight:0),[b]),T=(0,r.useMemo)((()=>j.current?j.current.clientHeight:0),[b]),F=(0,r.useCallback)((()=>Array.isArray(t.name)?(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:g("text","deleted"),children:t.name[0]}),(0,m.jsx)("span",{className:g("text","inserted"),children:t.name[1]})]}):(0,m.jsx)("span",{className:g("text"),children:t.name})),[t]);return(0,m.jsxs)(o.kC,{onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),ref:j,draggable:f,onDragStart:E,onDrop:S,className:C,sx:{alignItems:"center",flex:1,border:1,minWidth:"130px",position:"relative",p:2,backgroundColor:"bg2",borderRight:y?1:0,transform:"translateZ(0)",...v},children:[b&&(0,m.jsx)(m.Fragment,{children:["left","right"].map((e=>(0,m.jsx)("div",{className:g("dragAnchorWrapper",[e,_===e&&"active"]),onDragOver:t=>I(t,e),onDragLeave:e=>I(e,""),style:{height:P},children:(0,m.jsx)("div",{className:g("dragAnchor",e),style:{height:T}})},e)))}),f&&(0,m.jsx)(o.kC,{sx:{alignItems:"center",cursor:"move",mr:2,ml:"1px",color:"gray50"},children:(0,m.jsx)(h.Z,{})}),l?(0,r.cloneElement)(l,{orderCol:a,column:t}):F(),t.fieldType?(0,m.jsx)(u.Z,{fieldType:t.fieldType,className:g("description"),inTableHeadCell:!0}):null,!t.notSortable&&n.length?(0,m.jsx)(c.Z,{children:n.map((n=>(0,m.jsx)(d.Z,{onClick:()=>n.onClick(e,t.key),icon:n.icon,title:s(n.value)},`${t.key[0]?t.key[0]:t.key}-${n.value}`)))}):null,i&&i({isHovered:w,setIsHovered:k})]})};f.defaultProps={editableComponent:null,className:"",draggable:!1,isDragging:!1,sx:{}};const b=(0,a.qC)((0,a.CA)({getItemText:({col:e})=>t=>(0,p.C)(t,e)}))(f);var v=n(60042),y=n.n(v),C=(n(95623),n(61528));var j=n(80193);var w=n(28206),k=n(52052);var _=n(18285),Z=n(80643);const S=["editor-buttons-root","modal-portal","select-menu-portal"],E=e=>{var t;const{orderCol:n,orderRow:s,tableKey:l,col:a,rowRef:d,focusCell:c,inserted:u,deleted:x,focusColOrder:h=0,sx:g,cellsRef:f,withCellZoom:b=!0,centeredContent:v=!1,isReadOnly:y=!1,withCellHighlight:E=!0,isTableScrollable:I=!1,isLastCell:P,cols:T,remainingRowsCount:F}=e,R=(0,r.useRef)(null),{rows:D}=(0,r.useContext)($),{isFocused:N,setIsFocused:L}=(({focusCell:e,orderRow:t,orderCol:n})=>{const[s,i]=(0,r.useState)(!1),l=(0,r.useCallback)((s=>{const{key:l,shiftKey:r}=s;switch(l){case"Escape":return i(!1),!0;case"ArrowLeft":case"ArrowRight":case"Tab":case"ArrowDown":case"ArrowUp":{if(r)return;s.preventDefault();const o="ArrowDown"===l?1:"ArrowUp"===l?-1:0,a="ArrowRight"===l||"Tab"===l?1:"ArrowLeft"===l?-1:0;i(!1),e([t+o,n+a],[t,n])}}}),[e,t,n,i]);return(0,r.useEffect)((()=>{if(s)return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}}),[s,l]),{isFocused:s,setIsFocused:i}})({focusCell:c,orderRow:s,orderCol:n}),M=(0,r.useCallback)((e=>!!b&&(e&&e.stopPropagation(),L(!0),!0)),[L,b]),q=((e,t,n)=>{const[s,i]=(0,r.useState)(!1),l=(0,r.useCallback)((()=>{var n;if(t)return void i(!1);const s=e.current,l=null==s||null===(n=s.firstChild)||void 0===n?void 0:n.firstChild;if(!(l&&l instanceof HTMLElement))return;const r=l.getBoundingClientRect(),o=s.getBoundingClientRect();i(r.width>o.width||r.height>o.height)}),[e,t]);return(0,r.useEffect)((()=>{l()}),[l,n]),(0,r.useEffect)((()=>(window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)})),[l]),s})(R,N,T),[A,O]=(0,r.useState)(!1),z=(0,r.useCallback)((()=>O(!0)),[O]),H=(0,r.useCallback)((()=>O(!1)),[O]),{isHighlighted:B,onMouseEnterHighlight:V,onMouseLeaveHighlight:W}=(({tableKey:e,orderRow:t,orderCol:n,setIsFocused:s,withCellHighlight:i})=>{const l=(0,w.T)(),o=(0,w.C)((t=>!!t.tables.highlightedCellsByKey[e]));return{isHighlighted:(0,w.C)((s=>{const i=s.tables.highlightedCellsByKey[e];if(!i)return!1;const[l,r]=i,[o,a]=l,[d,c]=r;return(n>=a&&n<=c||n<=a&&n>=c)&&(t>=o&&t<=d||t<=o&&t>=d)})),onMouseEnterHighlight:(0,r.useCallback)((s=>{i&&1===s.buttons&&l((0,k.uW)(e,[t,n]))}),[i,l,e,t,n]),onMouseLeaveHighlight:(0,r.useCallback)((r=>{!o&&i&&1===r.buttons&&(s(!1),l((0,k.Py)(e,[[t,n],[t,n]])))}),[o,i,s,l,e,t,n])}})({tableKey:l,orderRow:s,orderCol:n,setIsFocused:L,withCellHighlight:E});(0,r.useEffect)((()=>{f.current={...f.current,[`${s}-${n}`]:{focus:M,cellRef:R}}}),[f,n,s,R,M]);const K=(0,j.Z)(null===(t=R.current)||void 0===t?void 0:t.firstChild,l);(0,r.useEffect)((()=>{const e=d.current;if(N&&e)return e.style.backgroundColor="#fbf3e5",()=>{e.style.removeProperty("background-color")}}),[N,d,K]);const G=(0,r.useCallback)((e=>{let t=!1,n=!1,s=e.target;for(;s;){if(S.includes(s.id)&&(n=!0),s===document.documentElement){t=!0;break}s=s.parentElement}(y||!n&&t)&&L(!1)}),[L,y]);(0,Z.Z)(R,G);const U=(0,r.useMemo)((()=>D[s]),[D,s]),Q=(0,r.useMemo)((()=>((e,t)=>t.key in e?e[t.key]:e.value?e.value:t.default?t.default:null)(U,a)),[U,a]);(0,r.useEffect)((()=>{n===h&&(0,_.Em)(`${_.Is}${l}${s}`)&&L(!0)}),[h,n,s,l,U,L]);const X=(0,r.useCallback)((()=>{if(null==Q)return"";const t=a.component?a.component:null;return t?(0,m.jsx)(t,{row:U,...U,...e,isFocused:N,isHovered:A}):Q.reactNode?(0,r.cloneElement)(Q.reactNode,{isFocused:N,isHovered:A,isExpandable:q,isHighlighted:B}):(0,p.s)(Q,a)}),[Q,a,U,e,N,A,q,B]),J=(0,r.useMemo)((()=>N?{position:"absolute",maxHeight:70*F+"px",overflowY:"auto",height:"auto",top:0,left:0,right:0,zIndex:"2",outline:"1px solid",outlineColor:"gold40",boxShadow:"medium",backgroundColor:"bg1",overflow:"visible"}:{}),[F,N]),Y=(0,r.useMemo)((()=>B?"gold20":u?"bgDiffGreen":x?"bgDiffRed":void 0),[B,u,x]),ee=(0,r.useMemo)((()=>{var e;return null===(e=R.current)||void 0===e?void 0:e.getBoundingClientRect().height}),[R.current]);return(0,m.jsx)(o.xu,{sx:{flex:1,borderBottom:1,borderLeft:1,minWidth:"130px",width:I?"130px":"auto",minHeight:b?ee:"36px",position:"relative",borderRight:P?1:0,scrollSnapAlign:n%2==0?"end":"none",...g},onMouseEnter:V,onMouseLeave:W,onClick:M,ref:R,children:(0,m.jsxs)(o.xu,{sx:{backgroundColor:Y,maxHeight:b?70:"none",overflow:"hidden",minHeight:"100%",display:v?"flex":"grid",alignItems:v?"center":"",hyphens:"auto",...J},onMouseEnter:z,onMouseLeave:H,children:[X(),q&&(0,m.jsx)(o.kC,{sx:{position:"absolute",bottom:1,right:1,border:1,borderRadius:"sm",backgroundColor:"bg1",height:"14px",width:"14px",color:"text1",alignItems:"center",justifyContent:"center",fontSize:"10px",cursor:"pointer"},onClick:M,children:(0,m.jsx)(i.G,{icon:C.TT,fixedWidth:!0})})]})})},I=(0,x.Z)("NewTableRow"),P=({tableKey:e,index:t,cellProps:n,className:s,isTableScrollable:i,showActionColAtEnd:l,renderRowActions:a,isDragging:d=!1})=>{const c=(0,r.useRef)(null),{cols:u,rows:p}=(0,r.useContext)($),x=p[t];return(0,m.jsxs)("div",{className:y()(I(),s,{NewTableRow__inserted:x.inserted,NewTableRow__deleted:x.deleted,NewTableRow__scrollable:i}),ref:c,children:[u.map(((s,l)=>d&&l?null:(0,m.jsx)(E,{tableKey:e,col:s,orderCol:l,orderRow:t,rowRef:c,inserted:s.inserted,deleted:s.deleted,isLastCell:l===u.length-1,isTableScrollable:i,remainingRowsCount:p.length-t,...n,sx:{...n.sx||{}}},`${e}-${t}-${l}`))),l&&(0,m.jsx)(o.xu,{sx:{width:"50px",minWidth:"50px",scrollSnapAlign:"end",bg:"bg1",borderRight:1,borderBottom:p.length-1===t?1:0},children:a&&a(t)})]})};P.defaultProps={cellProps:{},className:"",diffClassName:"",showAddNewColumn:!1};const T=P;var F=n(85274),R=n(20229);const D=({children:e,tableKey:t,headerRef:n,onScroll:s,shouldNotStick:i=!1,isTableScrollable:l})=>{const a=(0,w.C)((e=>e.fullScreen.tableInFullScreenKey===t)),d=!(0,r.useContext)(R.Z)&&!i;return(0,m.jsx)(o.xu,{sx:{position:d?"sticky":"relative",top:a||!d?0:"50px",zIndex:4},children:(0,m.jsx)(o.xu,{sx:{maxWidth:"100%",overflowX:l?"scroll":"visible",overflowY:l?"hidden":"visible",willChange:"scroll-position",scrollSnapType:F.s$?"x mandatory":"none",msOverflowStyle:"none",scrollbarWidth:"none","&::-webkit-scrollbar":{height:0,background:"transparent"}},ref:n,onScroll:s,children:e})})};var N=n(24158),L=n(48763);var M=n(82864),q=n(48072),A=n(70587);const O={rows:N.LZ,cols:N.LZ,hasRowReorder:!1,stickyColumn:!1,isHorScrolled:!1,isScrollable:!1},$=(0,r.createContext)(O),z=({tableKey:e,cols:t,rows:n,dropdownItems:a,cellProps:d,rowProps:c,editableColComponent:u,onChangeColsOrder:p,isLoading:x,onAddNewColumn:h,renderInHeader:g=null,headerIsSticky:f=!0})=>{const v=(0,r.useRef)(null),y=(0,r.useRef)(null),C=(0,r.useRef)({}),j=((e,t)=>{const[n,s]=(0,r.useState)(!1),i=(0,q.Z)(t),l=(0,r.useCallback)((n=>{n&&i<t&&setTimeout((()=>{e.current.scrollLeft=e.current.scrollWidth}),0)}),[e,t,i]),o=(0,r.useCallback)((()=>{if(!e.current)return;const t=e.current.scrollWidth-e.current.clientWidth>1;s(t),l(t)}),[s,e,l]);return(0,r.useEffect)((()=>(window.addEventListener("resize",o),()=>window.removeEventListener("resize",o))),[o]),(0,r.useEffect)((()=>{o()}),[t,o]),n})(y,t.length),_=(0,w.T)(),Z=(0,w.C)((t=>!!t.tables.highlightedCellsByKey[e])),S=(0,r.useMemo)((()=>!!h||!!c.renderRowActions),[h,c]),E=(0,r.useCallback)((t=>{(0,l.TB)("mod+c")(t)&&(t.preventDefault(),_((0,k.KW)(e,C)))}),[_,e]),I=(0,r.useCallback)((()=>{_((0,k.P_)())}),[_]);(0,r.useEffect)((()=>{if(Z)return window.addEventListener("mousedown",I),window.addEventListener("keydown",E),window.document.body.classList.add("hide-selection"),()=>{window.removeEventListener("mousedown",I),window.removeEventListener("keydown",E),window.document.body.classList.remove("hide-selection")}}),[Z,I,E,e]);const[P,R]=(0,r.useState)(""),N=(0,r.useCallback)(((e,s)=>{var i;const l=Math.min(Math.max(e[0],0),n.length-1),r=Math.min(Math.max(e[1],0),t.length-1),o=null===(i=C.current[`${l}-${r}`])||void 0===i?void 0:i.focus;if(!1===(o&&o())){var a;const e=null===(a=C.current[`${s[0]}-${s[1]}`])||void 0===a?void 0:a.focus;e&&e()}}),[t.length,n.length]),{isHorScrolled:O,onScroll:z}=((e=!1)=>{const[t,n]=(0,r.useState)(!1),s=(0,r.useCallback)((0,L.Z)((e=>{e>0&&!t?n(!0):e<1&&t&&n(!1)}),10),[t]),i=(0,r.useCallback)((({target:{scrollLeft:t}})=>{e&&s(t)}),[s,e]);return(0,r.useMemo)((()=>({isHorScrolled:t,onScroll:i})),[t,i])})(j),H=(0,r.useMemo)((()=>({rows:n,cols:t,isHorScrolled:O,isScrollable:j})),[n,t,O,j]),B=(0,r.useMemo)((()=>({...d,cellsRef:C,focusCell:N,cols:t})),[d,t,N]),V=(0,r.useCallback)(((e,t)=>{p(P,e,t),R("")}),[P,p]),[W,K]=(0,M.Z)(v,y),G=(0,r.useCallback)((e=>{W(e),z(e)}),[W,z]);return(0,m.jsx)("div",{className:"relative mt-3",children:(0,m.jsxs)($.Provider,{value:H,children:[(0,m.jsxs)(D,{tableKey:e,onScroll:K,headerRef:y,shouldNotStick:!f,isTableScrollable:j,children:[g,(0,m.jsxs)(o.xu,{id:`${e}-header`,sx:{display:"inline-flex",minWidth:"100%",maxWidth:"100%",bg:"bg1"},children:[t.map(((n,s)=>(0,m.jsx)(b,{tableKey:e,col:n,orderCol:s,dropdownItems:a,renderChildren:n.renderChildren,editableComponent:u,isDragging:""!==P,isLastCell:s===t.length-1,setDraggedColOrder:R,onColDrop:V,draggable:!!p,sx:{...d.sx||{},willChange:j?"scroll-position":"inherit",width:j?"130px":"auto",scrollSnapAlign:s%2==0?"end":"none"}},`${e}-${n.key}-${s}`))),S&&(0,m.jsx)(o.xu,{sx:{width:"50px",minWidth:"50px",scrollSnapAlign:"end",borderTop:1,borderRight:1,borderBottom:1,bg:"bg2"},children:h&&(0,m.jsx)(o.xu,{onClick:h,sx:{cursor:"pointer",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",":hover":{bg:"bg3"}},children:(0,m.jsx)(i.G,{fixedWidth:!0,icon:s.r8,size:"xs"})})})]})]}),(0,m.jsxs)(o.xu,{ref:v,sx:{overflowX:n.length&&j?"scroll":"visible",display:"flex",flexDirection:"column",alignItems:"flex-start","&::-webkit-scrollbar":{height:"8px",border:1,borderBottom:0},scrollSnapType:F.s$?"x mandatory":"none","&::-webkit-scrollbar-thumb":{backgroundColor:"gray60"}},onScroll:G,children:[n.map(((t,n)=>(0,m.jsx)(T,{tableKey:e,index:n,isTableScrollable:j,showActionColAtEnd:S,...c,cellProps:B,showAddNewColumn:!!h},`${e}-${n}`))),x&&(0,m.jsx)(A.Z,{})]})]})})};z.defaultProps={dropdownItems:[],isScrollable:!1,cellProps:{},rowProps:{},rowCountLimit:null,editableColComponent:null,className:"",onChangeColsOrder:null,isLoading:!1};const H=z},70587:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(11628),i=n(55480),l=n(24246);const r=(0,s.ZP)({resolved:{},chunkName:()=>"components-SquareSpinner-SquareSpinner",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e(4099).then(n.bind(n,70563)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>70563},{ssr:!1}),o=()=>(0,l.jsx)(i.kC,{sx:{position:"absolute",justifyContent:"center",pt:5,top:0,right:0,left:0,bottom:0,backgroundColor:"white",opacity:.5,zIndex:10},children:(0,l.jsx)(r,{size:140})})},97240:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(92739),i=n(55480),l=n(21020),r=n(84891),o=n(24158),a=n(24246);const d=({icon:e,tooltip:t,onClick:n=(()=>{}),dragHandleProps:d,sx:c=o.Nu})=>(0,a.jsxs)(r.R,{tooltip:t,sx:{minWidth:"34px",pl:1,ml:"auto",position:"relative",...c},children:[(0,a.jsx)(l.ZP,{square:!0,onClick:n,iconBefore:(0,a.jsx)(s.G,{icon:e}),appearance:"secondary",intent:"neutral"}),d&&(0,a.jsx)(i.xu,{...d,sx:{position:"absolute",top:0,left:0,right:0,bottom:0}})]})},2299:(e,t,n)=>{n.d(t,{h:()=>d});var s=n(49582),i=n(27378),l=n(7362),r=n(18451),o=n(97240),a=n(24246);const d=({query:e})=>{const t=(0,l.Z)(),n=(0,i.useCallback)((()=>{const n=(0,r.$k)(e);window.open(`${t}${n}`,"_blank")}),[t,e]);return(0,a.jsx)(o.Z,{icon:s.KS,tooltip:"Launch in query tool",onClick:n})}},91036:(e,t,n)=>{n.d(t,{Z:()=>p});var s=n(82730),i=n(92739),l=n(27378),r=n(51609),o=n(73214),a=n(21020),d=n(64842),c=n(78063),u=n(24246);const p=({sx:e={},label:t="Save to List",...n})=>{const{open:p}=(0,l.useContext)(r.Z),x=(0,c.Z)(),[h,m]=(0,l.useState)(!1),g=(0,l.useCallback)((()=>{x?m(!0):p(o.hD)}),[x,p]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.ZP,{onClick:g,iconBefore:(0,u.jsx)(i.G,{fixedWidth:!0,icon:s.RY}),sx:e,children:t}),h?(0,u.jsx)(d.Z,{open:!0,setOpen:m,...n}):null]})}},55553:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(92739),i=n(55480),l=n(24246);const r=({icon:e,onClick:t})=>(0,l.jsx)(i.xu,{onClick:t,sx:{bg:"bg1",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"text3",":hover":{color:"text1"}},children:(0,l.jsx)(s.G,{icon:e})})},79124:(e,t,n)=>{n.d(t,{Z:()=>c,k:()=>d});var s=n(28055),i=n(27378),l=n(55480),r=n(70658),o=n(87744),a=n(24246);const d={DAILY:"daily",WEEKLY:"weekly"},c=({showName:e,showReceiveUpdates:t,setReceiveUpdates:n,setAlertInterval:c,alertInterval:u,receiveUpdates:p=!0,setName:x,name:h=""})=>{const m=(0,i.useCallback)((e=>x(e.target.value)),[x]),g=(0,i.useCallback)((()=>{n(!p)}),[n,p]);return 0===(0,o.Z)().length?null:(0,a.jsxs)(a.Fragment,{children:[e&&(0,a.jsxs)(l.xu,{sx:{py:2},children:[(0,a.jsx)(s.__,{htmlFor:"query_name",sx:{mb:2},children:"Name your query"}),(0,a.jsx)(s.II,{id:"query_name",value:h,autoFocus:!0,placeholder:"Enter name...",onChange:m})]}),t&&(0,a.jsxs)(l.xu,{sx:{py:2},children:[(0,a.jsxs)(s.__,{sx:{mb:0},children:[(0,a.jsx)(s.XZ,{tabIndex:-1,checked:p,onChange:g,mr:3}),(0,a.jsxs)(l.xv,{variant:"body1",children:["Receive ",u," summary emails for new results to this query."]})]}),(0,a.jsx)(r.Z,{onChange:e=>p&&c(d[e]),selectedInterval:u,disabled:!p,sx:{mt:3}})]})]})}},44629:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(55480),i=n(24246);const l=30,r=2,o=2*r;function a({sx:e={},children:t}){return(0,i.jsx)(s.xu,{sx:{display:"inline-flex",height:l,borderRadius:"md",bg:"bg3",alignItems:"center",px:`${r}px`,userSelect:"none",...e},children:t})}const d=a;a.Option=function({children:e,selected:t,disabled:n=!1,sx:a={},...d}){return(0,i.jsx)(s.kC,{sx:{height:l,minWidth:60,py:`${r}px`,ml:`${o}px`,":first-of-type":{ml:0},":hover":{cursor:n?"not-allowed":"pointer","& > *":{bg:t||n?null:"bg4"}},opacity:n?.6:null,...a},...d,children:(0,i.jsx)(s.kC,{sx:{px:3,width:"100%",borderRadius:"md",alignItems:"center",bg:t?"bg1":"transparent",boxShadow:t?"medium":null},children:(0,i.jsx)(s.xv,{variant:"caption1",sx:{width:"100%",textAlign:"center",whiteSpace:"nowrap"},children:e})})})}},68848:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(27378),i=n(55480),l=n(95706),r=n(80140),o=n(28206),a=n(62625),d=n(24246);const c=({row:e,showDeactivatedEntity:t=!1,...n})=>{var c;const u=e.original,p=(0,o.T)(),x=(0,s.useCallback)(((e,t)=>{p((0,a.$2)(e,t))}),[p]),h=null===u.slug;return t&&h||"wiki"!==(null===(c=u.organization)||void 0===c?void 0:c.slug)?(0,d.jsx)(l.Z,{...n,slug:t?u.slug||"deactivated":u.slug,name:u.name,listItemId:u.list_item_id,thumbnail:u.thumbnail,onMatchEntity:x}):(0,d.jsx)(i.xv,{variant:"body1",sx:{py:1},children:(0,d.jsx)(r.Z,{...n,slug:u.slug,name:u.name,thumbnail:u.thumbnail,organization:u.organization,instanceOfIds:u.instance_of})})}},874:(e,t,n)=>{n.d(t,{Z:()=>C});var s=n(11628),i=n(27378),l=n(56552),r=n(77822),o=n(70587),a=n(56032),d=n(7098),c=n(42865),u=n(59801),p=n(83707),x=n(24158),h=n(54297),m=n(82450),g=n(84386),f=n(7922),b=n(78063),v=n(24246);const y=(0,s.ZP)({resolved:{},chunkName:()=>"components-EntityQuickView-EntityQuickView",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>Promise.all([n.e(3761),n.e(4608),n.e(7002),n.e(887)]).then(n.bind(n,67002)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>67002},{ssr:!1}),C=({columns:e,query:t=x.Nu,plugins:n=x.LZ,Header:s,Footer:C,isQuickView:j=!1})=>{const w=(0,l.useQueryClient)(),k=(0,b.Z)(),_=(0,i.useRef)(!0);(0,i.useEffect)((()=>{_.current?_.current=!1:N(1)}),[t]);const{isQueryWidget:Z,data:S,isLoading:E,isFetching:I,queryKey:P,ordering:T,setOrdering:F,pageSize:R,setPageSize:D,setPage:N,page:L,fullScreenOn:M}=(0,i.useContext)(m.Z),q=(0,c.Z)(),A=null==S?void 0:S.localData,O=(0,i.useMemo)((()=>({queryKey:P,getEntity:e=>A[e],setEntity:e=>{w.setQueryData(P,(t=>({...t,localData:{...null==t?void 0:t.localData,[e.id]:e}})))},ordering:T,setOrdering:F,resultsCount:null==S?void 0:S.count,isLoading:E,resultsPageSize:R})),[A,w,P,F,T,null==S?void 0:S.count,E,R]),$=(0,i.useMemo)((()=>[q,u.Z,...n]),[q,n]),{isLoaded:z}=(0,f.Z)(y);return!S||E?(0,v.jsx)(h.Z,{}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(d.Z.Provider,{value:O,children:[s?(0,v.jsx)(s,{resultsCount:null==S?void 0:S.count}):null,S.results.length?(0,v.jsxs)(v.Fragment,{children:[I?(0,v.jsx)(o.Z,{}):null,(0,v.jsx)(a.Z,{columns:e,data:S.results,plugins:$,hasOuterScrollContainer:M,Footer:void 0})]}):null,S.results.length&&C?(0,v.jsx)(C,{}):null,(0,v.jsx)(p.Z,{resultsCount:S.count,currentPage:L,pageSize:R,fetchPage:e=>{Z||window.scrollTo(0,0),N(e)},setPageSize:D,sx:{bg:"bg2"},children:k&&(0,v.jsx)(r.Z,{query:t})}),S.results.length||Z?null:(0,v.jsx)(g.Z,{})]}),z&&!j&&null!=S&&S.results?(0,v.jsx)(y,{entities:S.results.map((e=>e.slug))}):null]})}},75030:(e,t,n)=>{n.d(t,{e:()=>c,T:()=>d});var s=n(55480),i=n(92849),l=n(24246);var r=n(68848),o=n(30374),a=n(12077);const d={id:"name",headerLabel:"Name",Cell:e=>(0,l.jsx)(r.Z,{...e,imgStyle:{width:o.oy,height:o.oy}}),width:250},c={headerLabel:"Description",accessor:({description:e,generated_description:t,prefers_generated:n})=>(0,a.Z)(e,t,n),Cell:({value:e})=>(0,l.jsx)(s.xv,{variant:"caption1",sx:{mt:"-4px"},children:(0,l.jsx)(i.Z,{documentGolden:e,renderFlags:["description-cell"]})}),width:200}},1249:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(82593),i=n(92739),l=n(82097),r=n(24246);const o="AddNewColumn",a=e=>[e,{focusColumnBlacklist:((null==e?void 0:e.focusColumnBlacklist)||[]).concat([o])}],d=e=>[...e,{id:o,Header:(0,r.jsx)(i.G,{fixedWidth:!0,icon:s.r8}),Cell:"",width:80}],c=(e=l.Z)=>t=>{t.getTableProps.push(a),t.columns.push(d),t.getCellProps.push(((t,n)=>((e,{instance:t,cell:n},s)=>{const{column:i}=n;return i.id===o?[e,{onClick:s,sx:{maxWidth:80,mb:"-1px",borderBottom:n.row.index===t.rows.length-1?1:0,bg:"bg2",cursor:"pointer"}}]:e})(t,n,e))),t.getHeaderProps.push(((t,{column:n})=>n.id!==o?t:[t,{onClick:e,sx:{...t.sx,p:0,maxWidth:80,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",":hover":{bg:"bg4"}}}]))}},88047:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(27378);const i=e=>{const[t,n]=(0,s.useState)(null);Object.assign(e,{hoveredKey:t,setHoveredKey:n})},l=(e,{instance:t})=>[e,{isHovered:e.key===t.hoveredKey,onMouseEnter:()=>t.setHoveredKey(e.key),onMouseLeave:()=>t.setHoveredKey(null)}],r=e=>{e.useInstance.push(i),e.getCellProps.push(l)};r.pluginName="useCellHover";const o=r},56453:(e,t,n)=>{n.d(t,{Z:()=>C});var s=n(27378),i=n(60378),l=n(55480),r=n(88718),o=n(69554),a=n(84891),d=n(46345),c=n(11701),u=n(96256),p=n(24246);const x=({entity:e,fieldType:t,isExpandable:n=!1})=>{const i=(0,s.useMemo)((()=>"description"===t.name?{details:{text:!0}}:{infoboxes:[t]}),[t]),x=(0,o.Z)(d.Xk.ENTITY,e,{...i,initPath:[0,2]}),{open:h}=(0,u.e)(),m=(0,s.useCallback)((e=>{h(e)}),[h]),g=(0,c.Z)({name:"TableCellDataRequestButton",callback:m,state:x}),f=(0,s.useCallback)((e=>{e.stopPropagation(),h(x,{onFollow:g})}),[h,g,x]),b=(e=>(0,s.useMemo)((()=>({tooltip:{position:"absolute",bottom:"-1px",right:e?22:"-1px"},button:{px:2,py:0,color:"text1",borderRadius:0,borderTopLeftRadius:"sm",bg:"bg1",display:"flex",alignItems:"center",border:1,fontSize:"10px",lineHeight:"spacious",":hover":{bg:"bg3"},...e?{borderRight:"1px",borderRightColor:"border1",borderTopRightRadius:"3px"}:{}},title:{ml:2,whiteSpace:"nowrap"},upgradeIcon:{position:"relative",top:"0",fontSize:"7px",lineHeight:1,p:"2px",pr:"1px"}})),[e]))(n);return(0,p.jsx)(a.R,{sx:b.tooltip,tooltip:"Request more information on this cell",children:(0,p.jsxs)(l.zx,{onClick:f,sx:b.button,children:[(0,p.jsx)(r.Z,{weight:"light"}),(0,p.jsx)(l.xv,{sx:b.title,children:"Data Request"})]})})};var h=n(10734),m=n(78063);const g={cellRoot:{width:"100%",display:"flex",alignItems:"center",height:"100%"}},f=({children:e,entity:t,fieldType:n,isHovered:i,isEmpty:r})=>{const o=(0,m.Z)(),a=(0,s.useRef)(null),d=(0,h.Z)(a),c=i&&(o||!r);return(0,p.jsxs)(l.xu,{ref:a,sx:g.cellRoot,children:[e,c&&(0,p.jsx)(x,{entity:t,fieldType:n,isExpandable:d})]})},b=e=>{e.allCells.forEach((t=>{const n=t.render,{isHovered:s}=t.getCellProps();t.render=(...i)=>"name"!==t.column.id&&t.column.fieldType&&!t.column.predicate?(0,p.jsx)(f,{entity:e.original,fieldType:t.column.fieldType,isHovered:s,isEmpty:!t.value,children:n(...i)}):n(...i)}))},v=e=>{const{open:t}=(0,u.e)(),n=(0,s.useCallback)((e=>{t(e)}),[t]);(0,c.Z)({name:"TableCellDataRequestButton",callback:n}),e.plugins,(0,i.ensurePluginOrder)(e.plugins,["useCellHover"],"useDataRequest")},y=e=>{e.prepareRow.push(b),e.useInstance.push(v)};y.pluginName="useDataRequest";const C=y},57215:(e,t,n)=>{n.d(t,{Z:()=>s});const s=(e=0)=>t=>{t.columns.push((t=>t.map(((t,n)=>({...t,isSticky:n<=e}))))),t.getHeaderProps.push(((t,{column:n,instance:s})=>[t,{sx:s.columns.findIndex((e=>e.id===n.id))<=e?{...t.sx,position:"sticky",left:n.totalLeft,zIndex:5}:t.sx}])),t.getCellProps.push(((t,{instance:n,cell:s})=>{const{column:i}=s;return n.columns.findIndex((e=>e.id===i.id))<=e?[t,{sx:{...t.sx,position:"sticky",left:s.column.totalLeft,bg:"bg1",zIndex:4},isSticky:!0}]:t}))}},16751:(e,t,n)=>{n.d(t,{O9:()=>r,c2:()=>s,qL:()=>l,vz:()=>i}),n(95735);const s=(e,t,n,s,i)=>["query-results",e,t,n,s,i],i=(e,t,n,s,i)=>["query-results",e,t,n,s,i],l=(e,{page:t,pageSize:n,ordering:s,slug:i,search:l})=>()=>e.get(`queries/${i}/results/`,{page:t,per_page:n,order:s,search:l}),r=(e,{page:t,pageSize:n,ordering:s,permalink:i,preparedFilters:l,fields:r,search:o})=>()=>e.get("query/",{data:JSON.stringify({...l,per_page:n,fields:r,page:t,order:s,search:o}),permalink:i})},59801:(e,t,n)=>{n.d(t,{Z:()=>a});const s=(e,{instance:t})=>[e,{sx:{...e.sx,borderLeft:1}}],i=(e,{instance:t})=>[e,{sx:{...e.sx,maxWidth:"100%",bg:"white"},style:{minWidth:t.totalColumnsWidth}}],l=(e,{instance:t})=>[e,{variant:"heading4",sx:{...e.sx,position:"relative",py:2,px:2,bg:"gray20",borderTop:1,borderBottom:1,borderRight:1,fontWeight:700,display:"flex",alignItems:"center"}}],r=(e,{instance:t})=>[e,{sx:{...e.sx,borderBottom:1},style:{minWidth:t.totalColumnsWidth}}],o=(e,{instance:t})=>[e,{sx:{...e.sx,borderRight:1,position:"relative",height:70}}],a=e=>{e.getTableProps.push(s),e.getTableBodyProps.push(i),e.getHeaderProps.push(l),e.getRowProps.push(r),e.getCellProps.push(o)}},17885:(e,t,n)=>{n.d(t,{Z:()=>a}),n(911);var s=n(27378),i=n(83483),l=n(24246);function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class o extends s.Component{constructor(...e){super(...e),r(this,"onChange",(e=>{let t=e.target.value;this.props.removeNewlines&&(t=t.replace(/\r?\n|\r/g,"")),t!==this.props.value&&this.props.onChange(t)}))}render(){return(0,l.jsx)(i.Z,{inputRef:this.props.forwardedRef,className:this.props.className,value:this.props.value,onChange:this.onChange,style:{resize:"none",...this.props.style},...this.props.inputProps,disabled:this.props.disabled})}}r(o,"defaultProps",{className:"",inputProps:{},removeNewlines:!0,disabled:!1,style:{}});const a=(0,s.forwardRef)(((e,t)=>(0,l.jsx)(o,{...e,forwardedRef:t})))},84386:(e,t,n)=>{n.d(t,{Z:()=>u});var s=n(27378),i=n(55480),l=n(21020),r=n(88718),o=n(85342),a=n(96256),d=n(24246);const c={root:{alignContent:"center"},content:{flex:1,mx:"auto",p:4,my:[3,5,6],maxWidth:960,flexWrap:"wrap",alignItems:"center"},headingWrapper:{flex:["100%",1]},iconWrapper:{mb:1},icon:{color:"gold50",mr:2,flexShrink:0},dataRequestWrapper:{p:1,pl:[0,1],mt:[3,0]},researchRequestButton:{position:"relative"}},u=()=>{const e=(0,o.Z)(),{open:t}=(0,a.e)(),n=(0,s.useCallback)((()=>{t(e)}),[t,e]);return(0,d.jsx)(i.kC,{sx:c.root,children:(0,d.jsxs)(i.kC,{variant:"card",sx:c.content,children:[(0,d.jsxs)(i.xu,{sx:c.headingWrapper,children:[(0,d.jsxs)(i.kC,{sx:c.iconWrapper,children:[(0,d.jsx)(i.xv,{sx:c.icon,children:(0,d.jsx)(r.Z,{weight:"light",width:25,height:22})}),(0,d.jsx)(i.xv,{variant:"heading3",children:"File a Data Request to obtain results for your Query"})]}),(0,d.jsx)(i.xv,{variant:"body2",children:"Unleash an AI-powered research army to find what you're looking for."})]}),(0,d.jsx)(i.xu,{sx:c.dataRequestWrapper,children:(0,d.jsx)(l.ZP,{intent:"submit",onClick:n,sx:c.researchRequestButton,size:"md",children:"File Data Request"})})]})})}},61737:(e,t,n)=>{n.d(t,{Z:()=>d});var s=n(55480),i=n(874),l=n(88047),r=n(56453),o=n(82450),a=n(24246);const d=({frontEndQuery:e,isQuickView:t,contextData:n={},columns:d,fullScreenOn:c})=>(0,a.jsx)(s.xu,{sx:{mb:3},children:(0,a.jsx)(o.Z.Provider,{value:{...n,isQueryWidget:!0,fullScreenOn:c},children:(0,a.jsx)(i.Z,{columns:d,query:e,isQuickView:t,plugins:[l.Z,r.Z]})})})},81606:(e,t,n)=>{n.d(t,{Z:()=>R}),n(73902),n(95623);var s=n(90522),i=n.n(s),l=n(27378),r=n(92725),o=n(80930),a=n(75030),d=n(24158),c=n(35634),u=n(61459),p=n(40512),x=n(95626),h=n(55480),m=n(41041),g=n(94396),f=n(88718),b=n(69554),v=n(36692),y=n(25257),C=n(75822),j=n(44926),w=n(7098),k=n(82450),_=n(46345),Z=n(92592),S=n(96256),E=n(24246);const I=({column:e,isSortable:t=!1,withResearch:n})=>{const{ordering:s="",setOrdering:i}=(0,l.useContext)(w.Z),r=e.id;let o="-"===s[0];const a=s===r||s===`-${r}`,d=(0,Z.Z)("queries.sorting"),{savedQuery:I,frontEndQuery:P,queryColumns:T}=(0,l.useContext)(k.Z),{open:F}=(0,l.useContext)(m.Z),R=(0,b.Z)(_.Xk.QUERY,I||{frontEndQuery:P,queryColumns:T},{infoboxes:[e.fieldType]}),{open:D}=(0,S.e)(),N=(0,l.useCallback)((()=>{D(R)}),[D,R]),L=(0,l.useCallback)((e=>{d?i(e):F({label:"query-tool-sorting",content:{title:"Column Sorting",description:"Sort text, entity, industry, and number fields to zero in on the exact data set you’re looking for."},learnMorePath:"/product/query-tool"})}),[d,i,F]),M=(0,l.useMemo)((()=>d?null:(0,E.jsx)(h.xu,{children:(0,E.jsx)(g.Z,{sx:{position:"relative",top:0},children:"PRO"})})),[d]),q=(0,l.useMemo)((()=>{const s=[];return t&&s.push({icon:x.xr,value:"Ascending",onClick:()=>L(r),component:M},{icon:p.eG,value:"Descending",onClick:()=>L(`-${r}`),component:M}),"name"!==e.id&&n&&s.push({value:"Data Request",onClick:N,component:null,componentBefore:(0,E.jsx)(v.Z,{children:(0,E.jsx)(f.Z,{weight:"light"})})}),s}),[t,e.id,n,M,L,r,N]);return(0,E.jsxs)(h.xu,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.headerLabel,(0,E.jsxs)(h.xu,{sx:{ml:"auto",display:"flex",alignItems:"center"},children:[(0,E.jsx)(j.Z,{fieldType:e.fieldType,sx:{m:0}}),null!=q&&q.length?(0,E.jsx)(C.Z,{icon:a?o?c.pt:u.mT:void 0,sx:{width:"100%"},children:q.map((e=>(0,E.jsx)(y.Z,{onClick:()=>e.onClick(),icon:e.icon,title:e.value,componentBefore:e.componentBefore,children:e.component},e.value)))}):null]})]})};var P=n(27600),T=n(28206),F=n(77038);const R=({ids:e=d.LZ,templateEntityId:t,filters:n=d.LZ,isQueryWidget:s=!1,filterableFieldModels:c=d.LZ})=>{const u=(0,T.C)((e=>e.infoboxFieldTypes.data)),p=(0,l.useMemo)((()=>{const e=(0,F.$y)(u||{},t),i=e?e.templateFieldTypes.reduce(((e,t)=>(s?t.default_in_query_results_widget:t.default_in_query_results)?[...e,t.fieldType.id]:e),e.template.hide_description_column?[-1]:[-1,-2]):[],l=n.map((({fieldTypeId:e})=>e));return[...new Set([...i,...l])]}),[s,t,u,n]),x=(0,l.useMemo)((()=>e.length?e:i()(p)),[e,p]);return(0,l.useMemo)((()=>x.map((e=>{if(-1===e)return{Header:(0,r.vl)({isSortable:!0,withResearch:!s})(I),...a.T,fieldTypeId:-1,fieldType:{name:"name",id:-1}};if(-2===e)return{Header:(0,r.vl)({withResearch:!s})(I),...a.e,id:"description",fieldTypeId:-2,fieldType:{name:"description",id:-2}};{const t=u.field_types.find((t=>t.id===e));return{Header:(0,r.vl)({isSortable:(0,P.ZW)(t.field_model),withResearch:!s})(I),id:t.name,headerLabel:t.default_label,accessor:({infobox:e})=>{const n=e.find((({name:e})=>e===t.name));return(null==n?void 0:n.display_value)||""},Cell:o.$,fieldType:t,fieldTypeId:e,isEditable:!t.is_read_only,width:200,canBeAddedAsFilter:c.includes(t.field_model)}}}))),[x,s,u.field_types,c])}},11839:(e,t,n)=>{n.d(t,{Z:()=>a});var s=n(56552),i=n(56787),l=n(47869),r=n(16751),o=n(41083);const a=({initialPage:e,initialOrdering:t,initialPageSize:n,query:a,permalink:d,fields:c,queryOptions:u,search:p=""})=>{const x=(0,l.Z)(),h=(0,o.Z)(a),{pageSize:m,page:g,ordering:f,...b}=(0,i.Z)({initialPage:e,initialOrdering:t,initialPageSize:n}),v=(0,r.vz)(m,g,f,h,p),y=(0,r.O9)(x,{page:g,pageSize:m,ordering:f,permalink:d,preparedFilters:h,fields:c,search:p});return{...(0,s.useQuery)(v,y,u),queryKey:v,fetchFn:y,pageSize:m,page:g,ordering:f,...b,preparedFilters:h}}},85342:(e,t,n)=>{n.d(t,{Z:()=>a}),n(73902);var s=n(27378),i=n(69554),l=n(7098),r=n(82450),o=n(46345);const a=()=>{const{savedQuery:e=null,frontEndQuery:t,queryColumns:n}=(0,s.useContext)(r.Z),{resultsCount:a,resultsPageSize:d}=(0,s.useContext)(l.Z),c=(0,s.useMemo)((()=>n.reduce(((e,t)=>t.fieldType&&t.fieldTypeId>0?[...e,t.fieldType]:e),[])),[n]);return(0,i.Z)(o.Xk.QUERY,e||{frontEndQuery:t,queryColumns:n,resultsCount:a,resultsPageSize:d},{details:{more:!0},infoboxes:c})}},53647:(e,t,n)=>{n.d(t,{Z:()=>u}),n(95623);var s=n(51224),i=n(92739),l=n(60042),r=n.n(l),o=n(68853),a=n(88460),d=n(24246);const c=(0,a.Z)("EditorBlockquote"),u=({attributes:e,children:t,element:n})=>{let l=c();if((0,o.n)().includes("diff")){const{inserted:e,deleted:t}=n;l=r()(l,{diff__deleted:t,diff__inserted:e})}return(0,d.jsxs)("blockquote",{className:l,...e,children:[(0,d.jsx)(i.G,{icon:s.El,className:c("quoteIcon"),style:{userSelect:"none"}}),t]})}},73643:(e,t,n)=>{n.d(t,{Z:()=>d}),n(95623);var s=n(60042),i=n.n(s),l=n(68853),r=n(88460),o=n(24246);const a=(0,r.Z)("EditorCodeBlock"),d=({attributes:e,children:t,element:n})=>{let s=a();if((0,l.n)().includes("diff")){const{inserted:e,deleted:t}=n;s=i()(s,{diff__deleted:t,diff__inserted:e})}return(0,o.jsx)("code",{className:s,children:(0,o.jsx)("pre",{className:a("inner"),...e,children:t})})}},62598:(e,t,n)=>{n.d(t,{Z:()=>h}),n(95623);var s=n(60042),i=n.n(s),l=n(55480),r=n(85893),o=n(50381),a=n(68853),d=n(16339),c=n(24246);const u={[o.xd.h1]:{fontSize:25},[o.xd.h2]:{fontSize:20},[o.xd.h3]:{fontSize:16}},p={[o.xd.h1]:"Editor__headline",[o.xd.h2]:"Editor__subheadline",[o.xd.h3]:"Editor__subheadline"},x=({attributes:e,element:t,children:n,sx:s={}})=>{const i=(0,d.Z)(t),a=(0,r.Z)({title:i,isSubheading:t.type===o.xd.h2});return(0,c.jsx)(l.xu,{as:"span",id:a,...e,sx:{lineHeight:1.1,...s},children:n})},h=({attributes:e,children:t,element:n})=>{const s=u[n.type];let r=p[n.type];const d=(0,a.n)();if(d.includes("diff")){const{inserted:e,deleted:t}=n;r=i()(r,"diff__block",{diff__deleted:t,diff__inserted:e})}return d.includes("article")&&n.type!==o.xd.h3?(0,c.jsx)("div",{className:r,children:(0,c.jsx)(x,{element:n,attributes:e,sx:s,children:t})}):(0,c.jsx)("div",{className:r,children:(0,c.jsx)(l.xu,{as:"span",...e,sx:{lineHeight:1.1,...s},children:t})})}},56853:(e,t,n)=>{n.d(t,{Z:()=>x});var s=n(89009),i=n(41474),l=n(256),r=n(92739),o=n(27378),a=n(55480),d=n(38056),c=n(33268),u=n(46871),p=n(24246);const x=({links:e=[],editMode:t,onAddLink:n,onRemoveLink:x=(()=>{}),isDiff:h})=>{const m=(0,o.useMemo)((()=>e.length>15&&!t&&!h),[e,t,h]),[g,f]=(0,o.useState)(!1),b=(0,o.useCallback)((()=>f((e=>!e))),[]),v=(0,o.useMemo)((()=>{const t=e.map((e=>{if(Array.isArray(e)){const[t,n,s]=e;return{...s,...1===t?{inserted:!0}:-1===t?{deleted:!0}:{}}}return e}));return m&&!g?t.slice(0,12):t}),[e,m,g]);return(0,p.jsxs)(a.xu,{children:[(0,p.jsxs)(a.xu,{sx:{p:3},children:[(0,p.jsx)(d.Z,{gap:3,sx:{justifyContent:"space-between","& > div":{"&:after":{content:"''",flex:"auto"}}},children:v.map((({deleted:e,inserted:n,...s})=>{const i={entityId:s.id,imgStyle:{width:"30px",height:"30px"}};return(0,p.jsxs)(a.xu,{sx:{display:"flex",alignItems:"center"},children:[(0,p.jsx)(a.xv,{variant:"body1",sx:{bg:n?"bgDiffGreen":e?"bgDiffRed":"bg1","& .TopicLink__link":{alignItems:"center"}},children:(0,p.jsx)(u.B,{...i})}),t&&(0,p.jsx)(a.xu,{sx:{ml:2,color:"text3",cursor:"pointer",":hover":{color:"text1"}},onClick:()=>x(s.id),children:(0,p.jsx)(r.G,{icon:l.NB})})]},`${s.id}-${n?"ins":e?"del":""}`)}))}),t&&(0,p.jsx)(a.xu,{sx:{width:["50%","33.33%"],flexBasis:["50%","33.33%"],mt:3,pr:3},children:(0,p.jsx)(c.ZP,{placeholder:"Add entity",onSelect:n,footerOptions:["show-all","create"]})})]}),m?(0,p.jsxs)(a.xu,{onClick:b,sx:{flexBasis:"100%",px:3,py:2,bg:"bg2",color:"blue50",cursor:"pointer",borderBottomRightRadius:"md",borderBottomLeftRadius:"md",":hover":{bg:"bg3"}},children:[(0,p.jsx)(a.xu,{as:"span",sx:{mr:2},children:(0,p.jsx)(r.G,{icon:g?i.mT:s.pt})}),g?"Collapse":"Expand"]}):null]})}},99520:(e,t,n)=>{n.d(t,{Z:()=>a}),n(95623);var s=n(60042),i=n.n(s),l=n(50381),r=n(68853),o=n(24246);const a=({attributes:e,children:t,element:n})=>{const s=n.type===l.xd.ol,a=s?"ol":"ul";let d,c=s?"Editor__o-list":"Editor__u-list";if((0,r.n)().includes("diff")){const{inserted:e,deleted:t}=n;d=n.start,c=i()(c,"diff__block",{diff__deleted:t,diff__inserted:e})}return(0,o.jsx)(a,{className:c,start:d,...e,children:t})}},83058:(e,t,n)=>{n.d(t,{Z:()=>o}),n(95623);var s=n(60042),i=n.n(s),l=n(68853),r=n(24246);const o=({attributes:e,children:t,element:n})=>{let s;if((0,l.n)().includes("diff")){const{inserted:e,deleted:t}=n;s=i()(s,{diff__deleted:t,diff__inserted:e})}return(0,r.jsx)("li",{className:s,...e,children:t})}},85904:(e,t,n)=>{n.d(t,{O:()=>M,Z:()=>q});var s=n(73549),i=n(79982),l=n(27378),r=n(55480),o=n(80917),a=n(88393),d=n(97240),c=n(56032),u=n(7098),p=n(83707),x=n(35752),h=n(80930),m=n(75030),g=n(2154),f=n(91349),b=n(28206),v=n(62625),y=n(24246);const C=({column:e})=>{const[t,n]=(0,l.useState)(!1),s=(0,b.C)((e=>e.editor.editMode)),i=(0,l.useMemo)((()=>{var t;return!s&&"description"===(null===(t=e.fieldType)||void 0===t?void 0:t.name)}),[s,e]);(0,l.useEffect)((()=>{e.id===v.D5&&n(!0)}),[e.id]);const o=(0,l.useCallback)((()=>n((e=>!e))),[]),a=(0,l.useMemo)((()=>e.id===v.D5?f.ki:f.kM),[e.id]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.xu,{onClick:o,children:e.headerLabel}),!i&&(0,y.jsx)(g.Z,{routes:a,column:e,index:e.index,isOpen:t})]})};var j=n(33268),w=n(17352),k=n(31581),_=n(56552),Z=n(95434),S=n(47869);const E=({listId:e,onChangeNode:t})=>{const n=(0,k.Z)(),{mutate:s}=(e=>{const t=(0,S.Z)(),{refetch:n}=(0,Z.Z)(["entityListEntities",e]);return(0,_.useMutation)((({entities:n,action:s})=>t.post(`article-entitylists/${e}/edit_entities/`,{entities:n,action:s})),{onSuccess:()=>{n()}})})(e),i=(0,w.Z)(),o=(0,l.useCallback)((n=>{e===M?i(M,[n.id]).then((({listId:e})=>{null==t||t({listId:e})})):s({entities:[n.id],action:v.ud})}),[s,t,e,i]);return(0,y.jsx)(r.xu,{sx:{bg:"bg2",border:"1px solid",mt:"-1px",borderColor:"#dbe0e3",py:2,px:"5px"},children:(0,y.jsx)(r.xu,{sx:{maxWidth:500},children:(0,y.jsx)(j.ZP,{onSelect:o,footerOptions:["create"],placeholder:"Add entity",inputRef:n})})})};var I=n(52466),P=n(1249),T=n(42865),F=n(57215),R=n(72658),D=n(20120);var N=n(31154),L=n(56787);const M="__NEW__",q=({heading:e,listId:t,onChangeNode:n,onDelete:g,readOnly:f=!1,isDiff:b=!1,dragHandleProps:j})=>{const{data:w,isSuccess:k,isFetching:Z}=(0,N.Z)(t,{keepPreviousData:!0,enabled:t!==M}),{data:q,isSuccess:A,isFetching:O,page:$,setPage:z,pageSize:H,setPageSize:B,ordering:V,setOrdering:W}=((e,t={})=>{const{pageSize:n,setPageSize:s,page:i,setPage:l,ordering:r,setOrdering:o}=(0,L.Z)({initialPageSize:5}),a=(0,S.Z)(),{data:d,isSuccess:c,isLoading:u,isFetching:p}=(0,_.useQuery)({queryKey:["entityListEntities",e,i,n,r],queryFn:()=>a.get(`entitylists/${e}/entities/`,{page:i,per_page:n,order:r}),...t});return{data:d,isSuccess:c,isFetching:p,isLoading:u,page:i,setPage:l,pageSize:n,setPageSize:s,ordering:r,setOrdering:o}})(t,{keepPreviousData:!0,enabled:t!==M}),K=(({columns:e=[]})=>(0,l.useMemo)((()=>{const t=e.map(((e,t)=>e.fieldType?"description"===e.fieldType.name?{...m.e,Header:C,id:e.id,fieldType:e.fieldType,reorder:!0,index:t+1}:{Header:C,id:e.id,headerLabel:e.fieldType.default_label,accessor:({infobox:t})=>{const n=t.find((({name:t})=>t===e.fieldType.name));return(null==n?void 0:n.display_value)||""},Cell:h.$,fieldType:e.fieldType,width:200,reorder:!0,index:t+1}:e.id===v.D5?{Header:C,id:e.id,headerLabel:e.label,width:200,Cell:()=>(0,y.jsx)("div",{}),index:t+1}:void 0));return[{...m.T,Header:C,fieldType:{name:"name",id:-1},index:0},...t]}),[e]))({columns:null==w?void 0:w.columns}),G=(({listId:e,listIsReadOnly:t})=>{const{addColumnPlaceholder:n}=(0,D.Z)(e),s=(0,l.useCallback)((()=>n()),[n]),i=(0,P.Z)(s),r=(0,F.Z)(),o=(0,T.Z)();return(0,l.useMemo)((()=>{const e=[R.Z,o,r];return t?e:e.concat(i)}),[t,o,i,r])})({listId:t,listIsReadOnly:f||b}),U=(0,l.useMemo)((()=>({listId:t,ordering:V,setOrdering:W,columnsCount:null==w?void 0:w.columns.length})),[t,V,W,null==w?void 0:w.columns]),Q=(0,l.useCallback)((e=>{var t;return null==q||null===(t=q.localData)||void 0===t?void 0:t[e]}),[null==q?void 0:q.localData]),X=(0,l.useMemo)((()=>({getEntity:Q})),[Q]),J=!!j&&!f,Y=O||Z;return(0,y.jsxs)(r.xu,{sx:{position:"relative",minHeight:100},children:[(0,y.jsxs)("div",{className:"flex items-end mt-3",children:[(0,y.jsx)(o.Z,{initialValue:e,onChange:e=>null==n?void 0:n({listId:t,heading:e}),editMode:!f,isDiff:b,sx:{mr:"auto"}}),!f&&(0,y.jsx)(d.Z,{icon:i.$,tooltip:"Remove table",onClick:g,dragHandleProps:void 0}),J&&(0,y.jsx)(d.Z,{icon:s.Qg,tooltip:"Drag table",dragHandleProps:j}),f&&!b&&(0,y.jsx)(x.Z,{listToCopyId:t,entities:[],showCount:!1,appearance:"primary",sx:{px:2}})]}),k&&A?(0,y.jsxs)("div",{className:"mt-3",children:[(0,y.jsx)(I.Z.Provider,{value:U,children:(0,y.jsx)(u.Z.Provider,{value:X,children:(0,y.jsx)(c.Z,{columns:K,data:null==q?void 0:q.results,plugins:G,Footer:void 0})})}),(0,y.jsx)(p.Z,{resultsCount:null==q?void 0:q.count,currentPage:$,pageSize:H,fetchPage:z,setPageSize:B,sx:{bg:"bg1"}})]}):null,f?null:(0,y.jsx)(E,{listId:t,onChangeNode:n}),Y?(0,y.jsx)(r.xu,{sx:{position:"absolute",inset:0,bg:"rgba(255,255,255,0.5)",textAlign:"center",zIndex:6,display:"flex",alignItems:"center"},children:(0,y.jsx)(a.Z,{size:100})}):null]})}},52466:(e,t,n)=>{n.d(t,{Z:()=>s});const s=(0,n(27378).createContext)(void 0)},28968:(e,t,n)=>{n.d(t,{Z:()=>x});n(95623);var s=n(55046),i=n(92739),l=n(11628),r=n(60042),o=n.n(r),a=n(50381),d=n(68853),c=n(88460),u=n(24246);const p=l.ZP.lib({resolved:{},chunkName:()=>"matejmazur-react-katex",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e(1433).then(n.bind(n,91433)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>91433},{ssr:!1}),x=({element:e})=>{const{math:t,position:n,type:l}=e,r=l===a.Kt.mathInline,x=r?"span":"div",h=(0,c.Z)(r?"EditorMathInline":"EditorMathBlock"),m=(0,d.n)().includes("diff");let g=h();if(m){const{inserted:t,deleted:n}=e;g=o()({diff__deleted:n,diff__inserted:t})}return(0,u.jsx)(x,{className:g,children:(0,u.jsx)(x,{className:h("katex",n),children:t&&(0,u.jsx)(p,{fallback:(0,u.jsx)(i.G,{icon:s.LM,spin:!0}),children:({default:e})=>(0,u.jsx)(e,{block:!r,children:t})})})})}},35946:(e,t,n)=>{n.d(t,{Z:()=>a}),n(95623);var s=n(60042),i=n.n(s),l=n(68853),r=n(16339),o=n(24246);const a=({attributes:e,children:t,element:n})=>{let s="Editor__text";const a=(0,l.n)();if(a.includes("diff")){const{inserted:e,deleted:t}=n,l=a.includes("noPadding");s=i()(s,{diff__block:!l,diff__deleted:t,diff__inserted:e})}return a.includes("filterEmptyP")&&!(0,r.Z)(n)?null:(0,o.jsx)("p",{...e,className:s,children:t})}},65695:(e,t,n)=>{n.d(t,{Z:()=>F});var s=n(73549),i=n(61528),l=n(79982),r=n(27378),o=n(55480),a=n(80917),d=n(49008),c=n(97240),u=n(2299),p=n(91036),x=n(28206),h=n(88460),m=n(28055),g=n(66726),f=n.n(g),b=n(31581),v=n(18451),y=n(18285),C=n(62412),j=n(24246);const w=({onSubmit:e,dragHandleProps:t})=>{const[n,s]=(0,r.useState)(!1),i=(0,b.Z)(),l=(0,r.useCallback)((t=>{if((0,C.j)(t)){const n=/\/query\/p\/([^/]+)\/?/,i=t.match(n);if(!i||2!==i.length)return void s(!0);const l=(0,v.Hm)(i[1]);null!==l&&l.query?((0,y.dW)(y.xG),e({query:{...l.query,columns:l.cols}})):s(!0)}else s(!0)}),[e]),a=f()((e=>l(e)),100),d=(0,r.useCallback)((e=>{e.stopPropagation();const t=(e.clipboardData||window.clipboardData).getData("text");a(t)}),[a]),c=(0,r.useCallback)((()=>{n&&s(!1)}),[n]);return(0,j.jsxs)(o.xu,{sx:{p:3,bg:"bg2",border:1,borderRadius:"md"},...t,children:[(0,j.jsx)(o.xv,{variant:"caption1",sx:{mb:2},children:"Paste the query permalink here:"}),(0,j.jsx)(m.II,{inputRef:i,placeholder:"https://organization.golden.com/query/p/XXXXXXXXXXXXXX/",onPaste:d,onClick:e=>e.stopPropagation(),onFocus:c})]})};var k=n(9957),_=n(61737),Z=n(81606),S=n(11839);const E=({query:e,isQuickView:t,fullScreenOn:n})=>{const s=(0,Z.Z)({ids:e.columns,templateEntityId:e.constraintId,isQueryWidget:!0}),i=(0,S.Z)({query:e,fields:s.map((e=>e.fieldTypeId)),queryOptions:{enabled:!(null==s||!s.length),keepPreviousData:!1,refetchOnMount:!1},initialPageSize:5});return(0,j.jsx)(_.Z,{frontEndQuery:e,isQuickView:t,contextData:i,columns:s,fullScreenOn:n})},I=({query:e,isQuickView:t,fullScreenOn:n})=>{const{ref:s,inView:i}=(0,k.YD)({rootMargin:"300px",triggerOnce:!0});return(0,j.jsx)("div",{ref:s,children:i?(0,j.jsx)(E,{query:e,isQuickView:t,fullScreenOn:n}):null})};var P=n(43232);const T=(0,h.Z)("EditorQueryView"),F=({dragHandleProps:e,readOnly:t=!1,onChangeNode:n=(e=>{}),tableId:h,isDiff:m=!1,query:g,heading:f,onDelete:b=(()=>{}),isQuickView:v=!1})=>{const y=(0,x.T)(),C=(0,x.C)((e=>e.fullScreen.fullScreenOn&&h===e.fullScreen.tableInFullScreenKey)),k=!!e&&!t,_=(0,r.useCallback)((({query:e=g,heading:t=f,...s})=>{n({query:e,heading:t,tableId:h,...s})}),[n,h,g,f]),Z=(0,j.jsxs)("div",{children:[!t&&!g&&(0,j.jsx)(w,{onSubmit:_,dragHandleProps:e}),t&&!g&&(0,j.jsx)("div",{className:T("no-data-view"),children:(0,j.jsx)("span",{children:"No query added!"})}),g&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(o.kC,{sx:{alignItems:"flex-end"},children:[(0,j.jsx)(a.Z,{initialValue:f,onChange:e=>_({heading:e}),editMode:!t,isDiff:m}),t&&!m&&!C&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(p.Z,{allResults:!0,resultsQuery:g}),(0,j.jsx)(u.h,{query:g})]}),!C&&!m&&!v&&(0,j.jsx)(c.Z,{icon:i.TT,tooltip:"Expand table",onClick:()=>y((0,P.u)(h))}),!t&&(0,j.jsx)(c.Z,{icon:l.$,tooltip:"Remove table",onClick:b}),k&&(0,j.jsx)(c.Z,{icon:s.Qg,tooltip:"Drag table",dragHandleProps:e})]}),(0,j.jsx)("div",{className:"mt-3",children:(0,j.jsx)(I,{query:g,isQuickView:v,fullScreenOn:C})})]})]});return(0,j.jsx)(d.Z,{fullScreenKey:h,children:Z})}},91622:(e,t,n)=>{n.d(t,{Z:()=>p});n(95623);var s=n(11628),i=n(45347),l=n(85904),r=n(50381),o=n(68853),a=n(82097),d=n(65695),c=n(24246);const u=(0,s.ZP)({resolved:{},chunkName:()=>"EntityTable-EntityTable",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:()=>n.e(1827).then(n.bind(n,40519)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>40519},{ssr:!1}),p=({element:e})=>{const{type:t,columns:n,rows:s,title:p,query:x,tableId:h,heading:m,listId:g}=e,f=(0,o.n)(),b=f.includes("diff"),v=f.includes("quick-view");let y=null;switch(t){case r.xd.table:y=(0,c.jsx)(i.Z,{title:p,cols:n,rows:s,isReadOnly:!0,isQuickView:v,maxRowCount:r.ol,isDiff:b});break;case r.xd.entitytable:y=(0,c.jsx)(u,{onChangeNode:a.Z,onDelete:a.Z,title:p,cols:n,rows:s,readOnly:!0,isQuickView:v,isDiffEditor:b});break;case r.xd.queryView:y=(0,c.jsx)(d.Z,{heading:m,query:x,tableId:h,readOnly:!0,isQuickView:v,isDiff:b});break;case r.xd.listView:y=(0,c.jsx)(l.Z,{listId:g,heading:m,readOnly:!0,isDiff:b})}return y}},84132:(e,t,n)=>{n.d(t,{Z:()=>o}),n(95623);var s=n(50381),i=n(68853),l=n(24246);const r={[s.Gp.strong]:({children:e})=>(0,l.jsx)("strong",{children:e}),[s.Gp.em]:({children:e})=>(0,l.jsx)("em",{children:e}),[s.Gp.u]:({children:e})=>(0,l.jsx)("u",{children:e}),[s.Gp.superScript]:({children:e})=>(0,l.jsx)("sup",{children:e}),[s.Gp.subScript]:({children:e})=>(0,l.jsx)("sub",{children:e}),inserted:({children:e})=>(0,l.jsx)("span",{className:"diff__inserted",children:e}),deleted:({children:e})=>(0,l.jsx)("span",{className:"diff__deleted",children:e})};function o({attributes:e,children:t,leaf:n}){if((0,i.n)().includes("suggestion")&&n.inserted)t=(0,l.jsx)("span",{className:"upgrade__editorMark--bold",children:t});else for(const e in r)e in n&&e in r&&(t=r[e]({children:t}));return(0,l.jsx)("span",{...e,children:t})}},92849:(e,t,n)=>{n.d(t,{Z:()=>ue}),n(95623);var s=n(60042),i=n.n(s),l=n(27378),r=n(24158),o=n(50381),a=n(68853),d=n(71556),c=n(53647),u=n(23615),p=n.n(u),x=n(23884),h=n(55480),m=n(92725),g=n(24686),f=n(86697),b=n(29170),v=n(28206),y=n(24246);const C=(0,m.qC)(m.A$,(0,m.fw)({citations:p().array,citationsById:p().object}),(0,x.$j)(((e,t)=>({isTouchScreen:e.features.touchevents||!1,clickable:!!e.editor.citations.length,citations:t.citations||e.editor.citations}))))((({element:e,children:t,citations:n,isTouchScreen:s,clickable:r,citationsById:o})=>{const d=(0,v.C)((t=>t.data.citationsById[e.id]))||o&&o[e.id],c=(0,l.useRef)(null),[u,p]=(0,l.useState)(!1),{showCites:x,cites:m}=(0,g.Z)(),C=n.indexOf(e.id),j=!n.length||!d||-1===C,w=(0,a.n)(),k=w.includes("diff"),_=w.includes("description-cell"),Z=(0,l.useMemo)((()=>u||d&&m.indexOf(d.id)>=0),[m,u,d]);if(j)return(0,y.jsxs)(y.Fragment,{children:[t,!_&&(0,y.jsx)("span",{className:i()("Cite__icon__wrapper"),children:(0,y.jsx)("span",{className:i()("Cite__icon"),children:(0,y.jsx)("span",{className:"Cite__icon__numeral","data-citation-index":C+1})})})]});let S;if(k){const{inserted:t,deleted:n}=e;S=i()(S,{diff__deleted:n,diff__inserted:t})}return(0,y.jsxs)("span",{className:"Cite__wrapper","data-cite-id":e.id,children:[(0,y.jsx)("span",{className:i()("Cite__highlight",S,{active:Z}),ref:c,children:t}),(0,y.jsx)("span",{className:i()("Cite__icon__wrapper",S),children:(0,y.jsx)(b.Z,{content:(0,y.jsx)(h.xv,{variant:"body1",onMouseDown:e=>{e.stopPropagation()},children:(0,y.jsx)(f.ZP,{type:d.source_type,citation:d})}),withDelay:!s,children:(0,y.jsx)("span",{className:i()("Cite__icon",{clickable:!k&&r}),children:(0,y.jsx)("span",{className:"Cite__icon__numeral",onClick:k?void 0:e=>{e.preventDefault(),x({cites:[d.id]})},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),"data-citation-index":C+1})})})})]})}));var j=n(73643),w=n(62598),k=n(3950),_=n(16339),Z=n(34465),S=n(92739),E=n(21020),I=n(84891),P=n(6958);const T=({onClick:e,sx:t})=>{const n=(0,v.T)();return(0,y.jsx)(h.xu,{sx:{display:"inline-block",...t},children:(0,y.jsx)(I.R,{tooltip:"Create Issue",children:(0,y.jsx)(E.ZP,{onClick:()=>{e&&e(),n((0,P.Y9)(!0))},appearance:"tertiary",children:(0,y.jsx)(S.G,{icon:Z.kl})})})})};var F=n(85912),R=n(80917),D=n(56853);var N=n(66222),L=n(17461),M=n(68625),q=n(77439),A=n(18574);const O=({element:e,children:t})=>{const n=(0,A.X2)(e.id);if(!n)return(0,y.jsx)(y.Fragment,{children:t});const s=(0,q.Z)(n);return(0,y.jsx)(L.Z,{slug:n.slug,inline:!0,children:(0,y.jsx)(M.Z,{slug:n.slug,entityOrgSlug:s,legacyLink:!0,children:t})})},$=({element:e,children:t,attributes:n})=>{const s=(0,a.n)();if(s.includes("suggestion")&&s.includes("CrosslinkUpgrade"))return(0,y.jsx)("span",{className:"upgrade__fake-link",children:t});const l=s.includes("diff"),{href:r}=e,d=e.type===o.Kt.internalLink?(0,y.jsx)(O,{element:e,attributes:n,children:t}):(0,y.jsx)(N.Z,{className:"legacyLink",href:r||"",children:t});if(l){const{inserted:t,deleted:n}=e,s=i()({diff__deleted:n,diff__inserted:t});return(0,y.jsx)("span",{className:s,children:d})}return d};var z=n(99520),H=n(83058),B=n(28968),V=n(35946),W=n(91622),K=n(8144),G=n(52606),U=n(77106);const Q="TOGGLE_VIDEO_WIDGET",X="SET_VIDEO_URL",J={widgetOn:!1,videoUrl:""};U.Z.register("videoWidget",((e=J,t)=>{const{type:n,payload:s}=t;switch(n){case X:return{...e,videoUrl:s.videoUrl};case Q:return{...e,widgetOn:s.widgetOn};default:return e}}));const Y=e=>({type:Q,payload:{widgetOn:e}}),ee=e=>({type:X,payload:{videoUrl:e}});var te=n(88460),ne=n(23516);const se=(0,te.Z)("VideoWidget"),ie=(0,m.qC)((0,x.$j)((e=>({widgetOn:e.videoWidget.widgetOn,videoUrl:e.videoWidget.videoUrl})),{toggleVideoWidget:Y,setVideoUrl:ee}),(0,ne.Z)("baseRef","getBaseRef"),(0,m.xJ)("draggingPoint","setDraggingPoint",[]),(0,m.xJ)("isResizing","setIsResizing",!1),(0,m.CA)({resize:({getBaseRef:e})=>t=>{const n=e();if(!n)return;const s=n.getBoundingClientRect().right-t.clientX;n.style.width=`${s}px`,n.style.height=.5625*s+"px"},drag:({getBaseRef:e,draggingPoint:t,setDraggingPoint:n})=>s=>{const i=e();if(!i)return;const l=s.clientY-t[1],r=t[0]-s.clientX,o=document.body.clientWidth-i.getBoundingClientRect().right;i.style.right=`${o+r}px`,i.style.top=`${i.getBoundingClientRect().top+l}px`,n([s.clientX,s.clientY])}}))((({baseRef:e,setDraggingPoint:t,resize:n,drag:s,widgetOn:l,videoUrl:r,toggleVideoWidget:o,setVideoUrl:a,isResizing:d,setIsResizing:c})=>{if(!l||!r)return null;const u=()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",u)},p=()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",p),c(!1)};return(0,y.jsxs)("div",{className:i()(se()),ref:e,style:{width:"320px",height:"180px",top:"66px",right:"16px"},children:[(0,y.jsx)(G.Z,{className:se("closeBtn"),onClick:()=>{o(!1),a("")}}),(0,y.jsx)("iframe",{className:se("video",d&&"isResizing"),src:r,allow:"autoplay"}),(0,y.jsx)("span",{className:se("dragHandle"),onMouseDown:e=>{e.preventDefault(),t([e.clientX,e.clientY]),window.addEventListener("mousemove",s),window.addEventListener("mouseup",u)}}),(0,y.jsx)("span",{className:se("resizer"),onMouseDown:e=>{e.preventDefault(),window.addEventListener("mousemove",n),window.addEventListener("mouseup",p),c(!0)}})]})}));var le=n(13891),re=n(28265);const oe=()=>"undefined"!=typeof YT;var ae=n(84132);const de={[o.xd.p]:V.Z,[o.xd.h1]:w.Z,[o.xd.h2]:w.Z,[o.xd.h3]:w.Z,[o.xd.ol]:z.Z,[o.xd.ul]:z.Z,[o.xd.li]:H.Z,[o.xd.code]:j.Z,[o.xd.blockquote]:c.Z,[o.Kt.a]:$,[o.Kt.internalLink]:$,[o.Kt.cite]:C,[o.Kt.citeVoid]:C,[o.xd.img]:({children:e,element:t})=>{const n=(0,a.n)(),s=n.includes("diff"),[r,d]=(0,l.useState)(!1),[c,u]=(0,l.useState)(!1),p=(0,l.useMemo)((()=>!n.includes("suggestion")&&!s&&!n.includes("quick-view")&&c),[c,s,n]),{src:x,position:h=o.JW[1],width:m,height:g,inserted:f,deleted:b}=t,C=(0,_.Z)(t),j=(0,v.T)(),w=(0,l.useCallback)((()=>{d(!0)}),[]),Z=(0,l.useCallback)((()=>{d(!1)}),[]),S=(0,l.useCallback)((()=>{u(!0)}),[u]),E=(0,l.useCallback)((()=>{u(!1)}),[u]);return(0,y.jsxs)("div",{className:i()("Editor__image",h,{noFloat:s}),children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:i()("Editor__image__wrapper",{mediaDiff:s,inserted:f,deleted:b}),style:{maxWidth:m,maxHeight:g},onMouseEnter:S,onMouseLeave:E,children:[p&&(0,y.jsx)(T,{onClick:()=>j((0,P.VN)({snippetType:"img",selection:x})),sx:{position:"absolute",top:2,right:2,zIndex:1}}),(0,y.jsx)("img",{className:"Editor__image__img",src:x,alt:C,onClick:w,loading:"lazy"})]}),(0,y.jsx)(k.Z,{open:r,onClose:Z,src:x,alt:C})]}),(0,y.jsx)("p",{className:"Editor__image__caption InternalLink__container",children:(0,y.jsx)("span",{className:i()({diff__deleted:b,diff__inserted:f}),children:e})})]})},[o.xd.video]:({children:e,element:t})=>{const n=(0,a.n)(),s=n.includes("diff"),o=n.includes("quick-view"),d=(0,v.C)((e=>e.videoWidget.videoUrl||"")),c=(0,l.useRef)(null),u=(0,l.useRef)(null),p=(0,l.useRef)(null),[x,m]=(0,l.useState)(!1),g=(0,v.T)(),{src:f,videoType:b,inserted:C,deleted:j}=t,w=(re.zt[b]||(()=>""))(f),[k,_]=(0,l.useState)(!1),Z=(0,l.useCallback)((()=>{_(!0)}),[_]),I=(0,l.useCallback)((()=>{_(!1)}),[_]),F=(0,l.useCallback)((()=>{let e=w;p.current&&(p.current.pauseVideo(),e+=`&start=${Math.round(p.current.getCurrentTime())}`),g(Y(!0)),g(ee(e))}),[g,w]),R=(0,l.useMemo)((()=>(0,re.rt)(b,f)),[b,f]);return(0,l.useEffect)((()=>{const e=u.current;if(e&&90===e.naturalHeight&&120===e.naturalWidth&&e.removeAttribute("src"),!oe()&&!document.getElementById("iframe-demo")){var t;const e=document.createElement("script");e.id="iframe-demo",e.src="https://www.youtube.com/iframe_api";const n=document.getElementsByTagName("script")[0];null===(t=n.parentNode)||void 0===t||t.insertBefore(e,n)}}),[]),(0,l.useEffect)((()=>{const e=()=>{if(!c.current)return;const e=c.current.getBoundingClientRect();(e.top<r.K1+8||e.bottom>window.innerHeight-8)&&F()};x&&oe()&&(p.current=new window.YT.Player(`video-${f}`,{events:{onStateChange:t=>{1===t.data?(window.addEventListener("scroll",e),g(Y(!1))):window.removeEventListener("scroll",e)}}}))}),[x,f,g,F]),(0,y.jsxs)("div",{className:"embed-video__wrapper",ref:c,children:[(0,y.jsxs)("div",{className:i()("embed-video__container",{mediaDiff:s,inserted:C,deleted:j}),onClick:e=>{e.preventDefault()},onMouseEnter:Z,onMouseLeave:I,children:[x?(0,y.jsx)("iframe",{title:f,id:`video-${f}`,className:"embed-video embed-video--requested",width:"640",height:"352",src:w,allow:"autoplay"}):(0,y.jsxs)("div",{className:"embed-video__image__wrapper",onClick:()=>m(!0),children:[(0,y.jsx)("img",{className:"embed-video__image",ref:u,src:R,alt:""}),(0,y.jsx)("div",{className:"embed-video__playBtn"})]}),(0,y.jsxs)(h.xu,{sx:{position:"absolute",top:2,right:2},children:[s||(0,le.G)()||!k?null:(0,y.jsx)(E.ZP,{appearance:"tertiary",onClick:e=>{e.stopPropagation(),F()},children:(0,y.jsx)(S.G,{icon:K.Rk})}),!s&&k&&!o&&(0,y.jsx)(T,{onClick:()=>g((0,P.VN)({snippetType:"img",selection:R})),sx:{ml:2}})]})]}),(0,y.jsx)("p",{className:"Editor__image__caption InternalLink__container",children:(0,y.jsx)("span",{className:i()({diff__deleted:j,diff__inserted:C}),children:e})}),d.startsWith(w)&&(0,y.jsx)(ie,{})]})},[o.xd.math]:B.Z,[o.Kt.mathInline]:B.Z,[o.xd.table]:W.Z,[o.xd.entitytable]:W.Z,[o.xd.queryView]:W.Z,[o.xd.listView]:W.Z,[o.xd.linkBlock]:({element:e,children:t})=>{const{heading:n,links:s,deleted:i,inserted:r}=e,o=(0,a.n)().includes("diff"),d=(0,l.useMemo)((()=>F.NB.string(e).length),[e]);return(0,l.useMemo)((()=>s.length),[s])?(0,y.jsxs)(h.xu,{sx:{p:i||r?2:0,bg:r?"bgDiffGreen":i?"bgDiffRed":"bg1",mb:3},children:[n?(0,y.jsx)(h.xu,{sx:{border:1,borderTopLeftRadius:"md",borderTopRightRadius:"md",bg:"bg1"},children:(0,y.jsx)(R.Z,{initialValue:n,editMode:!1,isDiff:o,sx:{mb:0,p:3}})}):null,(0,y.jsxs)(h.xu,{sx:{border:1,borderTop:n?0:1,borderBottomRightRadius:"md",borderBottomLeftRadius:"md",borderTopRightRadius:n?0:"md",borderTopLeftRadius:n?0:"md",bg:"bg1"},children:[d?(0,y.jsx)(h.xv,{variant:"body1",sx:{p:3,borderBottom:1,lineHeight:"loose"},children:t}):null,(0,y.jsx)(D.Z,{links:s,isDiff:o})]})]}):o?(0,y.jsx)(h.xu,{variant:"card",sx:{p:3,m:3},children:"Not enough data provided. Be sure to include at least one link."}):null}},ce=({element:e})=>{if(!e.children)return(0,y.jsx)(ae.Z,{leaf:e,text:e,attributes:{"data-slate-leaf":!0},children:e.text});const t=de[e.type];return(0,y.jsx)(t,{element:e,attributes:{"data-slate-node":"element",ref:null},children:e.children.map(((e,t)=>(0,y.jsx)(ce,{element:e},t)))})},ue=({documentGolden:e,className:t="",renderFlags:n=r.LZ})=>{const s=(0,l.useMemo)((()=>(0,d.Z)(e)),[e]);return n.includes("diff")&&(t=i()(t,{diff__deleted:null==e?void 0:e.deleted,diff__inserted:null==e?void 0:e.inserted})),(0,y.jsx)(a.r.Provider,{value:n,children:(0,y.jsx)("div",{className:t,children:s.map(((e,t)=>(0,y.jsx)(ce,{element:e},t)))})})}},20229:(e,t,n)=>{n.d(t,{Z:()=>s});const s=(0,n(27378).createContext)(!1)},68853:(e,t,n)=>{n.d(t,{n:()=>r,r:()=>l});var s=n(27378),i=n(24158);const l=(0,s.createContext)(i.LZ),r=()=>(0,s.useContext)(l)},17352:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(27378),i=n(28206),l=n(22478),r=n(47869);const o=()=>{const e=(0,r.Z)(),t=(0,i.T)(),n=(0,i.C)((e=>{var t,n;return null===(t=e.entity)||void 0===t||null===(n=t.entity)||void 0===n?void 0:n.id}));return(0,s.useCallback)(((s,i)=>e.post(`entitylists/${s}/create_article_list/`,{entityId:n,entities:i}).catch((()=>{t((0,l.S1)("Something went wrong with creating a powered table","error"))}))),[n,e,t])}},31581:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(27378),i=n(18285);const l=()=>{const e=(0,s.useRef)(null);return(0,s.useEffect)((()=>{(0,i.Em)(i.xG)&&setTimeout((()=>{e.current&&e.current.focus()}),0)}),[]),e}},16339:(e,t,n)=>{n.d(t,{Z:()=>i}),n(73902);const s=e=>{const t=Array.isArray(e)?{children:e}:e;return t.children?t.children.reduce(((e,t)=>e+("text"in t?t.text:s(t))),""):t.text},i=s},71556:(e,t,n)=>{n.d(t,{Z:()=>r}),n(73902);var s=n(50381);const i=(e="")=>[{type:s.xd.p,children:[{text:e}]}],l=e=>{const{type:t,data:n={},nodes:s=[]}=e;let i=s.reduce(((e,t)=>("text"===t.object||"text"===t.kind?t.leaves.forEach((({text:t,marks:n=[]})=>{const s={text:t};n.forEach((({type:e})=>{s[e]=!0})),e.push(s)})):e.push(l(t)),e)),[]);return 0===i.length&&(i=[{text:""}]),{type:t,children:i,...n}},r=e=>"string"==typeof e?i(e):e&&Array.isArray(e.nodes)&&e.nodes.length?e.nodes.map(l):i()},20120:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(27378),i=n(95434),l=n(62625);const r=e=>{const{setCurrent:t,getCurrentData:n}=(0,i.Z)(["entityList",e]);return{addColumnPlaceholder:(0,s.useCallback)((()=>{var e;const s=(null===(e=n())||void 0===e?void 0:e.columns)||[];t("columns",s.concat({id:l.D5,rank:s.length+1,label:"NEW FIELD",fieldType:null,required:!1}))}),[t,n]),removeColumnPlaceholder:(0,s.useCallback)((()=>{var e;const s=(null===(e=n())||void 0===e?void 0:e.columns)||[];t("columns",s.filter((({id:e})=>e!==l.D5)))}),[t,n])}}},73963:(e,t,n)=>{n.d(t,{E$:()=>S,LK:()=>_,My:()=>F,Q8:()=>f,Z1:()=>k,_r:()=>I,_s:()=>C,eA:()=>j,g8:()=>E,hn:()=>y,iE:()=>P,iy:()=>T,km:()=>g,m_:()=>b,qT:()=>v,tF:()=>h,v_:()=>w,wb:()=>Z,yq:()=>m});var s=n(4716),i=n(45204),l=n(2673),r=n(23041),o=n(15489),a=n(65423),d=n(49786),c=n(12503),u=n(97310),p=n(88552),x=n(32027);const h="open",m="closed",g="ISSUES_FETCH_REQUEST",f="ISSUES_ADD_ISSUE",b="ISSUES_ADD_EVENT",v="ISSUES_EDIT_EVENT",y="ISSUES_SET_RAW_ISSUES",C="ISSUES_SET_RAW_ISSUE",j="ISSUE_EXPIRE_ISSUE",w="ISSUE_FETCH_ERROR",k="UPDATE_ISSUES_FILTER_OPTIONS",_="ISSUE_NOT_FOUND",Z="ISSUE_MODAL_TOGGLE",S="ISSUE_MODAL_SET_FORM_DATA",E="ISSUE_MODAL_RESET_FORM_DATA",I=Object.freeze({citationRequested:{icon:s.xV,displayName:"Citation requested"},inaccurateContent:{icon:i.kl,displayName:"Inaccurate content"},spellingOrGrammar:{icon:l.xf,displayName:"Spelling / grammar"},badLinks:{icon:r.AE,displayName:"Incorrect / broken links"},topicNameIncorrect:{icon:o.UJ,displayName:"Topic name incorrect"},requestForMoreContent:{icon:a.TL,displayName:"Request for more content"},duplicateTopic:{icon:u.r8,displayName:"Duplicate topic"},neutrality:{icon:d.DL,displayName:"Neutrality"},formatting:{icon:c.cJ,displayName:"Formatting"},narrativeVoice:{icon:d.DL,displayName:"Narrative voice"},mergedEntityReview:{icon:x.tU,displayName:"Merged entity review",autoGenerared:!0},other:{icon:p.eH,displayName:"Other"}}),P=Object.keys(I).map((e=>({type:e,name:I[e].displayName,showPublicly:!0}))).concat({type:"allIssues",name:"All issues"}),T=P.map((({type:e})=>e)),F="assignee"},95434:(e,t,n)=>{n.d(t,{Z:()=>l});var s=n(27378),i=n(56552);const l=e=>{const t=(0,i.useQueryClient)();return{setCurrent:(0,s.useCallback)(((n,s)=>{t.setQueryData(e,(e=>({...e,[n]:s})))}),[t,e]),getCurrentData:(0,s.useCallback)((()=>t.getQueryData(e)),[t,e]),refetch:(0,s.useCallback)((()=>t.refetchQueries(e)),[t,e])}}},7922:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(27378),i=n(58430),l=n(92615);const r=e=>{const t=(0,l.Z)(),[n,r]=(0,s.useState)(!1),[o,a]=(0,s.useState)(null),d=(0,s.useRef)(!1),c=(0,s.useCallback)((()=>{d.current=!0}),[]);(0,s.useEffect)((()=>{o&&d.current&&(o.click(),d.current=!1)}),[o]);const u=(0,s.useCallback)((()=>{e.load().then((()=>{t()&&r(!0)}))}),[e,t]);return{hasInteracted:(0,i.Z)(u),isLoaded:n,onClick:c,ref:a}}},56787:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(27378);const i=({initialOrdering:e="",initialPage:t=1,initialPageSize:n=25})=>{const[i,l]=(0,s.useState)(t),[r,o]=(0,s.useState)(n),[a,d]=(0,s.useState)(e),c=(0,s.useCallback)((e=>{d(e),l(1)}),[]);return{pageSize:r,setPageSize:(0,s.useCallback)((e=>{o(e),l(1)}),[]),page:i,setPage:l,ordering:a,setOrdering:c}}},80193:(e,t,n)=>{n.d(t,{Z:()=>o,b:()=>r});var s=n(27378),i=n(24158),l=n(11891);const r=e=>(0,s.useCallback)(((t=!1)=>{const n=e.current;if(!n)return;const s=(0,l.Z)(n);if(!s||s===window)return;const i=n.getBoundingClientRect(),r=s.getBoundingClientRect();i.top<r.top&&n.scrollIntoView(t),i.bottom>r.bottom&&n.scrollIntoView(t)}),[e]),o=(e,t)=>(0,s.useCallback)((()=>{if(!e)return;const n=e.getBoundingClientRect(),s=(0,l.Z)(e),r=s instanceof HTMLElement,o=r?s.getBoundingClientRect():{top:i.K1,bottom:document.body.clientHeight},a=document.getElementById(`${t}-header`),d=a?a.getBoundingClientRect():{height:0},c=o.top+d.height;n.top<c&&(e.style.scrollMarginTop=(r?d.height:c)+16+"px",e.scrollIntoView()),n.bottom>o.bottom&&(e.style.scrollMarginBottom="16px",e.scrollIntoView(!1))}),[e,t])},13783:(e,t,n)=>{n.d(t,{Cq:()=>d,Sq:()=>l,tR:()=>a,wm:()=>r});var s=n(22478),i=n(62625);const l=e=>(t,n)=>{const s=n(),l=(0,i.zn)(s),r=l.columns.findIndex((t=>t.pipeline&&t.pipeline.id===e.id)),o=l.columns[r],a=[...l.columns];a.splice(r,1,{...o,pipeline:e,label:e.name}),t(i.j1.setCustom("data",{...l,columns:a}))},r=(e,t=!1)=>(n,s)=>{const l=s(),r=(0,i.o2)(l),o=(0,i.wz)(l),a=r.findIndex((t=>t.list_item_id===e.list_item)),d=r[a],c=d.pipelines.findIndex((t=>t.pipeline===e.pipeline)),u=[...d.pipelines];t?u.splice(c,1):c>=0?u.splice(c,1,e):u.push(e);const p=[...r];p.splice(a,1,{...d,pipelines:u}),n(i.IC.setCustom("data",{...o.data,results:p}))},o=(e,t=!1)=>(n,s)=>{const l=s(),r=(0,i.o2)(l),o=(0,i.wz)(l),a=r.findIndex((t=>t.id===e.subject)),d=r[a],c=d.statements.findIndex((t=>t.id===e.id)),u=[...d.statements];t?u.splice(c,1):c>=0?u.splice(c,1,e):u.push(e);const p=[...r];p.splice(a,1,{...d,statements:u}),n(i.IC.setCustom("data",{...o.data,results:p}))},a=(e,t,n)=>(l,r,{api:a})=>{const d=(0,i.zn)(r());return a.post(`facts/statements/?organization_slug=${d.organization}`,{display_value:e,field_type:t,subject:n}).then((e=>(l(o(e)),e))).catch((()=>{l((0,s.S1)("Error saving a private cell","error"))}))},d=e=>(t,n,{api:l})=>{const r=(0,i.zn)(n());return l.delete(`facts/statements/${e.id}/?organization_slug=${r.organization}`).then((()=>{t(o(e,!0))})).catch((()=>{t((0,s.S1)("Error deleting private cell","error"))}))}},43232:(e,t,n)=>{n.d(t,{d:()=>d,u:()=>a});var s=n(89631),i=n(24158),l=n(77106);const r={fullScreenOn:!1,tableInFullScreenKey:""},o=(0,s.Lq)(r,{[i.LJ]:(e,{payload:{tableInFullScreenKey:t}})=>Object.assign({},e,{fullScreenOn:!0,tableInFullScreenKey:t}),[i.QS]:e=>Object.assign({},e,{...r})});function a(e){return{type:i.LJ,payload:{tableInFullScreenKey:e}}}function d(){return{type:i.QS}}l.Z.register("fullScreen",o)},6958:(e,t,n)=>{n.d(t,{yy:()=>T,eN:()=>P,aE:()=>F,Yr:()=>S,W7:()=>E,HI:()=>I,uJ:()=>k,w:()=>_,rK:()=>L,R0:()=>Z,VN:()=>N,pJ:()=>M,Y9:()=>D,SL:()=>R}),n(73902),n(911);var s=n(89631),i=n(11512),l=n(30454),r=n.n(l),o=n(98159),a=n.n(o),d=n(55244),c=n.n(d),u=n(73963),p=n(25453),x=n(22478),h=n(46365),m=n(77106);const g={filterOptions:u.iy,issuesTab:{},pendingFetch:!1,notFound:!1,entities:{},modalOpen:!1,issueFormData:{}},f=e=>e.reduce(((e,t)=>{const n=e.findIndex((e=>e.id===t.id));return-1===n?e.push(t):e[n]={...e[n],...t},e}),[]),b=e=>e.sort((({created:e},{created:t})=>e-t)),v=e=>e.sort(((e,t)=>[e.status===t.status?0:"open"===e.status?-1:1,e.created])),y=a()(((e,t)=>Object.assign({},e,t))),C=a()(((e,t)=>t.concat(e))),j={pending:!1,fetched:!0,present:!0,partial:!0},w=(0,s.Lq)(g,{[u._s]:(e,{payload:{slug:t,raw:n}})=>{const s=r()(e);return n.type=u._r[n.label],n.events&&n.events.results&&(n.events=n.events.results),s.entities[t]={data:c()(C([n]),f,b)((s.entities[t]||{}).data||[]),next:n.next,status:j},s},[u.hn]:(e,{payload:{slug:t,raw:n,isContinuation:s}})=>{const i=r()(e),{results:l=[]}=n,o=l.map((e=>(e.type=u._r[e.label],e&&e.events&&e.events.count&&e.events.count>0&&(e.events=e.events.results),e))),a={data:c()(C(o),f,v)((s&&(t?i.entities[t]:i.issuesTab)||{}).data||[]),next:n.next,status:{present:!0,pending:!1,fetched:!0,partial:!1}};return t?i.entities[t]=a:i.issuesTab=a,i.pendingFetch=!1,i},[u.Q8]:(e,{payload:{slug:t,issue:n}})=>{const s=r()(e);var i;return n.slug=t,s.entities[t]={data:C((i=n,i.type=u._r[i.label],i),(s.entities[t]||{}).data||[]),status:j},s},[u.m_]:(e,{payload:{slug:t,id:n,content:s}})=>{var i;const l=r()(e);return l.entities[t]={data:f(r()((null===(i=l.entities[t])||void 0===i?void 0:i.data)||[]).map((e=>{const t=r()(e);if(t.id===n){var i;t.events=f(t.events||[]).concat(s);const e=(null===(l=(e=>{const t=e.filter((({event_type:e,payload:t})=>"attributeChange"===e&&(null==t?void 0:t.status)));return t.sort((({created:e},{created:t})=>e-t)),t.slice(-1)[0]})(t.events))||void 0===l||null===(o=l.payload)||void 0===o?void 0:o.status)===u.tF,n=null===(i=t.events.filter((({payload:e})=>null==e?void 0:e.assignee)).slice(-1)[0])||void 0===i?void 0:i.payload.assignee;n&&(t.assignee=n),t.status=e?u.tF:u.yq}var l,o;return t}))),status:j},l},[u.eA]:(e,{payload:{slug:t}})=>{const n=r()(e);return n.entities[t]={data:[],status:{pending:!1,present:!1,fetched:!1,partial:!1}},n},[u.v_]:(e,{payload:{slug:t,action:n,id:s=null,error:i}})=>{const l=r()(e);return l.pendingFetch=!1,l.entities[t]=y(l.entities[t]||{},{hasError:!0,error:i&&i.message?i.message:i,meta:{action:n,id:s},status:{pending:!1,fetched:!0,present:!1,partial:!1}}),l},[u.Z1]:(e,{payload:{filterOptions:t}})=>({...e,filterOptions:t}),[u.km]:e=>({...e,pendingFetch:!0}),[u.LK]:e=>({...e,notFound:!0}),[u.wb]:(e,{payload:{modalOpen:t}})=>({...e,modalOpen:t}),[u.E$]:(e,{payload:{formData:t}})=>({...e,issueFormData:{...e.issueFormData,...t}}),[u.g8]:e=>({...e,issueFormData:{}})});m.Z.register("issues",w);const k=e=>(t,n,{api:s})=>s.post(`issues/${e}/flag/`).then((()=>t((0,x.S1)("Issue has been flagged and will not show up anymore","success")))).catch((e=>t((0,x.S1)(e.message,"error")))),_=(e,t,n)=>(s,i,{api:l})=>l.post(`entities/${e}/issues/${t}/events/`,{event_type:"comment",payload:{comment:n}}).then((n=>s({type:u.m_,payload:{slug:e,content:n,id:t}}))).catch((n=>s({type:u.v_,payload:{slug:e,id:t,action:u.m_,error:n&&n.message}}))),Z=(e,t,n)=>(s,i,{api:l})=>l.post(`entities/${e}/issues/${t}/events/`,{event_type:"attributeChange",payload:{assignee:n}}).then((n=>s({type:u.m_,payload:{slug:e,id:t,content:n}}))).catch((n=>s({type:u.v_,payload:{slug:e,id:t,action:u.m_,error:n&&n.message}}))),S=(e,t)=>(n,s,{api:i})=>i.get(`entities/${e}/issues/${t}/`).then((t=>n({type:u._s,payload:{slug:e,raw:t}}))).catch((()=>n({type:u.LK}))),E=(e,{filterOptions:t=[]}={})=>(n,s,{api:i})=>{const l=e&&`entities/${e}/issues/`||"issues/";n({type:u.km}),i.get(`${l}?ordering=-created${!e&&`&types=${t.join(",")}`||""}`).then((t=>n({type:u.hn,payload:{slug:e,raw:t}}))).catch((t=>n({type:u.v_,payload:{slug:e,id:-1,action:u.hn,error:t&&t.message}})))},I=(e,t)=>(n,s,{api:i})=>{const l=t.replace("//","|").slice(t.indexOf("/"),t.length);i.get(l).then((t=>{n({type:u.hn,payload:{slug:e,raw:t,isContinuation:!0}})})).catch((t=>n({type:u.v_,payload:{slug:e,id:-1,action:u.hn,error:t&&t.message}})))},P=(e,t)=>({type:u.Q8,payload:{slug:e,issue:t}}),T=(e,t,n)=>({type:u.m_,payload:{slug:e,content:n,id:t}}),F=(e,t,n)=>({type:u.qT,payload:{id:e,commentID:t,content:n}}),R=e=>t=>t({type:u.Z1,payload:{filterOptions:e}}),D=(e,{issueEntityslug:t}={})=>(n,s)=>{const i=e?t||s().entity.entity.structuredData.slug:"";n(N({slug:i})),n({type:u.wb,payload:{modalOpen:e}})},N=e=>({type:u.E$,payload:{formData:e}}),L=()=>({type:u.g8}),M=()=>(e,t,{api:n})=>{const{issues:s}=t(),{assignee:l,title:r,type:o,content:a,snippetType:d,selection:c,slug:u,entityVersionId:m}=s.issueFormData;if(!r||!o||!a)return void e((0,x.S1)("Title, type and content are all required.","error"));const g={entity_version_id:m||t().entity.entity.versionId,title:r,label:o,comment:a,snippet_type:d||"text",assignee:l?l.username:void 0,snippet:c||void 0};return n.post(`entities/${u}/issues/`,g).then((t=>{e((0,p.vm)("issues_count",1)),e((0,i.VF)((0,h.I)(t.entity.slug,t.entity.organization.slug,void 0,`/issues/${t.id}`))),e(D(!1))}))}},18451:(e,t,n)=>{n.d(t,{$D:()=>g,$k:()=>u,Hm:()=>f,MX:()=>p,PS:()=>c,Vu:()=>v,iV:()=>b,qP:()=>x}),n(911),n(95735),n(95623);var s=n(35574),i=n(11512),l=n(24158),r=n(87780),o=n(89856),a=n(37060),d=n(77038);const c=(e,t)=>`/query/p/${e}/${t&&1!==t?t:""}`,u=(e,t=1,n=!1)=>c(g(e,n),t),p=(e,t)=>n=>{const s=c(g(e));n((0,i.VF)({pathname:s,state:t}))},x=(e,t=null)=>{if(!e)return!1;const n=(null==e?void 0:e.alert_settings_by_user_id)||{};return null===t?Object.values(n).some((({additions:e})=>e)):Object.entries(n).some((([e,n])=>parseInt(e)===t&&n.additions))},h=e=>{const{fieldTypeId:t,filters:n,operatorIndex:s,operator:i,negate:l,value:r,aggregate:o}=e;return n?[t,n.map(h)]:[t,parseInt(s),i,!!l,r,o]},m=e=>{if(2===e.length){const[t,n]=e;return{fieldTypeId:t,filters:n.map(m)}}{const[t,n,s,i,l,r]=e;return{fieldTypeId:t,operatorIndex:n,operator:s,negate:i,value:l,aggregate:r}}},g=(e,t=!1,n=[],i=[])=>{const r=e?[e.constraintId,e.filters.map(h),t,n,i]:l.LZ;return(0,s.encode)(JSON.stringify(r)).replace(/=/g,"")},f=e=>{if(!e)return null;if(""===e)return null;try{let t;return t="["===e[0]?decodeURIComponent(e):(0,s.decode)(e),(e=>{const[t,n=[],s=!1,i=[],l=[]]=e;return{query:{constraintId:t,filters:n.map(m)},adminMode:s,cols:i,order:l}})(JSON.parse(t))}catch(e){return a.Z.notify(e),null}},b=e=>{const t=e.match(/\/query\/p\/([^/]+)\/?/);if(!t||2!==t.length)return null;const n=f(t[1]);return null!==n&&n.query?{...n.query,columns:n.cols}:null},v=(0,o.Z)((e=>{var t,n;const{infoboxFieldTypes:{data:s}}=e,i=e.entity.entity.id,l={},o=(null===(t=e.entity)||void 0===t||null===(n=t.entity)||void 0===n?void 0:n.infobox)||[],c=o.filter((e=>"instance_of"===e.name)).map((e=>e.display_value)),u=[];c.forEach((t=>{var n,c;null===(n=(0,d.$y)(s,t))||void 0===n||null===(c=n.templateFieldTypes)||void 0===c||c.forEach((({fieldType:{display_as_query:t,name:n,constraints:s,inverse_of:d,default_label:c}})=>{if(t&&!l[n]){if(null==s||!s.length||!d)return void a.Z.notify("Admin error. display_as_query field type must have constraints and inverse field set");l[n]=!0;const t={constraintId:s[0],filters:[{fieldTypeId:d,filters:[{aggregate:null,fieldTypeId:r.mN,negate:!1,operator:"any",operatorIndex:0,value:[i]}]}],key:`${i}-${n}`,heading:c,hasResults:o.some((e=>e.name===n))};(t.hasResults||e.editor.editMode)&&u.push(t)}}))}));const p={};s.templates.filter((e=>c.includes(e.entity))).forEach((e=>{s.template_queries.filter((t=>t.template===e.id)).forEach((({query:e,id:t,label:n})=>{try{const s={...JSON.parse(e.replace("{{ENTITY_ID}}",i)),key:`${i}-${t}`,isTemplateQuery:!0,heading:n};p[n]=s}catch(e){return void a.Z.notify("Bad Admin Template Query!")}}))}));const x=Object.values(p);return u.concat(x)}),(e=>{var t,n,s,i,l,r;return{infoboxFieldTypes:null===(t=e.infoboxFieldTypes)||void 0===t?void 0:t.data,entityId:null===(n=e.entity)||void 0===n||null===(s=n.entity)||void 0===s?void 0:s.id,infobox:null===(i=e.entity)||void 0===i||null===(l=i.entity)||void 0===l?void 0:l.infobox,isEditMode:null===(r=e.editor)||void 0===r?void 0:r.editMode}}))},18285:(e,t,n)=>{n.d(t,{Em:()=>l,Is:()=>a,dW:()=>i,tA:()=>o,xG:()=>r});let s=null;const i=e=>s=e,l=e=>e===s&&(s=null,!0),r="EDITOR_TABLE",o="HEADER_CELL",a="NEW_ROW_CELL"},96256:(e,t,n)=>{n.d(t,{e:()=>d});var s=n(27378),i=n(52564),l=n(51609),r=n(73214),o=n(77878),a=n(92592);const d=()=>{const{pathname:e}=(0,i.TH)(),t=(0,a.Z)("research.request"),{onOpen:n}=(0,s.useContext)(o.Z),{open:d}=(0,s.useContext)(l.Z),c=(0,s.useCallback)(((s,{onFollow:i}={})=>{t?n(s):d({...r.JM,pathname:e,onFollow:i})}),[t,n,d,e]);return{isPermitted:t,open:c}}},66980:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(27378);const i=(e,t)=>{const n=[];for(const e of t)n.push([e,(0,s.useRef)(null)]);(0,s.useEffect)((()=>{let t=!1;for(const[e,s]of n)s.current!==e&&(s.current=e,t=!0);t&&e()}))}},71074:(e,t,n)=>{n.d(t,{h:()=>i});var s=n(27378);function i({pageSize:e,list:t}){const[n,i]=(0,s.useState)(1),[l,r]=(0,s.useState)(e),o=Math.max(Math.ceil(t.length/l),1),a=(n-1)*l;return{page:t.slice(a,a+l),pageSize:l,pagesCount:o,firstRowIndex:a,currentPage:n,setCurrentPage:i}}},28265:(e,t,n)=>{n.d(t,{ZP:()=>d,rt:()=>a,zt:()=>o});const s=/youtube\.com|youtu\.be/,i=/vimeo.com\//,l=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/)|(?:(?:watch)?\?v(?:i)?=|&v(?:i)?=))([^#&?]*).*/,r=/vimeo.com\/(\w+)/,o={youtube:e=>`https://www.youtube.com/embed/${e}?rel=0&showinfo=0&autoplay=1&enablejsapi=1`,vimeo:e=>`https://player.vimeo.com/video/${e}?autoplay=1`},a=(e,t)=>{switch(e){case"youtube":return`https://img.youtube.com/vi/${t}/hqdefault.jpg`;case"vimeo":return`https://vumbnail.com/${t}.jpg`;default:return""}},d=e=>{var t,n;return s.test(e)?{videoType:"youtube",videoId:(null===(t=l.exec(e))||void 0===t?void 0:t[1])||null}:i.test(e)?{videoType:"vimeo",videoId:(null===(n=r.exec(e))||void 0===n?void 0:n[1])||null}:{}}}}]);