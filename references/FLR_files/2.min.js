(window.webpackJsonpgmplib=window.webpackJsonpgmplib||[]).push([[2],{feJ0:function(t,e,s){"use strict";s.r(e),s.d(e,"Sensors",(function(){return j})),s.d(e,"sensors",(function(){return x})),s("xQkQ");var r=s("7nkO"),i=s("AuSM"),n=s.n(i);const{hostname:a,protocol:o}=window.location,c=/local/.test(a),l=/-test-/.test(a),u=/^[^.]*testnet[^.]*\./.test(a);let h="prod";c?h="local":l?h="test":u?h="testnet":!u&&!l&&!c&&(h="prod");const p=h,d="https://sc-datasink.ffe390afd658c19dcbf707e0597b846d.de/sa?project="+("prod"===p?"production":"default"),f="https://sc-web.ffe390afd658c19dcbf707e0597b846d.de?project="+("prod"===p?"production":"default"),g="prod"===p?"E1495F5FC222C591662AA2A5131BE697A4ADE442":"04998C9B84A38A7D810A5ADAF48229BA568BF954";function _(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function m(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?_(Object(s),!0).forEach((function(e){v(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function v(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const b=["utm_medium","utm_source","utm_term","utm_content","utm_campaign"],y=["utm_medium","utm_source","utm_lang","utm_channel","utm_team","utm_pmt","utm_cet","utm_markets","utm_ci","utm_csm","utm_csy","utm_cem","utm_cey","utm_cpt","utm_cco","utm_cct","utm_ccbt","utm_cta","utm_tcn","utm_tcv","utm_tvcl","utm_tcf","utm_tcaw","utm_tcah"],S=()=>{const t=y.filter(t=>-1===b.indexOf(t)).map(t=>"sa_"+t);return t.push("utm_source","utm_medium"),t};function T(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function A(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?T(Object(s),!0).forEach((function(e){B(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):T(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function B(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function k(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function w(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?k(Object(s),!0).forEach((function(e){O(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):k(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function O(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class j{constructor(t,e){this._sensor=void 0,this._abTest=void 0,this._pageInfo=void 0,this.setProfile=t=>{this._sensor.setProfile(t)},this.login=(t=Object(r.g)())=>{this._sensor.login(t)},this.abTest=t=>new Promise((e,s)=>{this._abTest.fastFetchABTest(w(w({},t),{},{callback:t=>e(t)}))}),this.track=(t,e={})=>{this._sensor.registerPage(this._pageInfo),this._sensor.track(t,e)},this.quickConfig=t=>{this._sensor.quick("autoTrack",t)},this.registerPage=(t={})=>{if(Object.keys(t).length>0){const e=w(w({},this._pageInfo),t);this._pageInfo=e,this._sensor.registerPage(this._pageInfo)}};const{sensors:s,pageInfo:i}=(t=>{var e,s,i,a,o;const{sensorsInit:c,pageInit:l}=t;null==n.a||n.a.init(A({web_url:f,is_track_single_page:!0,send_type:"beacon",heatmap:{track_attr:["data-spm-id","data-spm-name","data-spm-even"],clickmap:"default",collect_tags:{button:!0,a:!0,input:!0,textarea:!0,li:!0,img:!0},scroll_notice_map:"default",custom_property:function(t){const{spmName:e,spmId:s,spmEven:i,spmData:a}=function t(e,s=5){if(e){const{spmName:r,spmId:i,spmEven:n,spmData:a}=e.dataset||{};return r||n?{spmName:r,spmId:i,spmEven:n,spmData:a}:e.parentNode?t(e.parentNode,s--):{}}return{}}(t);let o={};try{a&&(o=JSON.parse(a||{}))}catch(p){o={}}var c,l;if(e)null===(c=window)||void 0===c||null===(l=c.pushEvent)||void 0===l||l.default("click",e,o);else if(i){var u,h;n.a.track(i,Object(r.e)(o)),null===(u=window)||void 0===u||null===(h=u.pushEvent)||void 0===h||h.default("click",i,o)}if(e||s||o)return(t=>{const e={};for(const s in t)t[s]&&(e[s]=t[s]);return e})(A({spmName:e||"",spmId:s||""},o))}},app_js_bridge:!0},c));const u=A({env:p,app_id:1e4,notify_lang:Object(r.b)(r.a)||r.i.get(r.a)||window.navigator.language,ga_id:Object(r.c)(),page_url:(null===(e=window)||void 0===e||null===(s=e.location)||void 0===s?void 0:s.href)||"",page_path:(null===(i=window)||void 0===i||null===(a=i.location)||void 0===a?void 0:a.pathname)||"",referrer_url:(null===(o=document)||void 0===o?void 0:o.referrer)||"",referrer_path:Object(r.f)(),tdid:r.i.get("BYBIT_TDID_V2")||"",guid:Object(r.d)(),u:window.GA_UID||"",platform_type:Object(r.h)()?"Web":"H5",dx_id:Object(r.b)("35CJa4376")||"",dx_cp:Object(r.b)("35CJa4376-cp")||"",user_agent:window.navigator.userAgent||"",project_type:l.project_type},l);return null==n.a||n.a.registerPage(u),function(t){const e=(()=>{const t=(t=>null!=t&&t.search?t.search.slice(1).split("&").reduce((t,e)=>{const[s,r]=e.split("=");return m(m({},t),{},{[s]:decodeURIComponent(r)})},{}):{})(window.location);return S().reduce((e,s)=>{const r=t[s]||"",i=null==r?void 0:r.trim();return i&&"null"!==i&&"undefined"!==i&&(e[s]=i),e},{})})();Object.keys(e).length>0&&(t.clearAllRegister(S()),t.register(m({},e)))}(n.a),n.a.quick("autoTrack"),n.a.login(Object(r.g)()),{sensors:n.a,pageInfo:u}})(t);this._sensor=s,this._pageInfo=i,this._abTest=this._sensor.use("SensorsABTest",{url:"https://sc-abtest.ffe390afd658c19dcbf707e0597b846d.de/api/v2/abtest/online/results?project-key="+e,visualize:{enable_visualize:!0,timeout:15e3,use_mask:!0},multilink:{timeout:15e3,pass_params:!0}})}static getInstance(t,e){return j.instance||(j.instance=new j(t,e)),j.instance}}j.instance=void 0;const x=()=>j.getInstance({sensorsInit:{show_log:!1,server_url:d},pageInit:{project_type:"bybit-growth-activity"}},g)},xQkQ:function(t,e,s){"use strict";(function(t){!function(e,s){"object"==typeof exports&&void 0!==t?t.exports=s():s()}(0,(function(){function t(t){this.SensorsABTest=t,this.para=t.para}function e(t){this.SensorsABTest=t,this.para=t.para}function s(t){var e="t6KJCZa5pDdQ9khoEM3Tj70fbP2eLSyc4BrsYugARqFIw1mzlGNVXOHiWvxUn8",s=e.length-1,r={},i=0;for(i=0;i<e.length;i++)r[e.charAt(i)]=e.charAt(s-i);var n="";for(i=0;i<t.length;i++)n+=t.charAt(i)in r?r[t.charAt(i)]:t.charAt(i);return n}function r(t){return O+s(t)}function i(t){this.SensorsABTest=t}function n(t){var e=v.storage.get(t);v.isString(e)&&(e=function(t){return 0===t.indexOf(O)&&(t=s(t=t.substring(O.length))),t}(e));try{e=JSON.parse(e)}catch(s){v.log(s)}return e}function a(t){this.attr_name="sa-abtest-"+t,this.remove_timer=null,this.is_added=!1,this.is_abort=!1,this.is_timeout=!1,this.style_element=null,this.createMaskStyle()}function o(t){this.SensorsABTest=t,this.isFirst=!0,this.start_time=null,this.mask_instance=null,this.is_filtered_out=!1,this.para={timeout:500,use_mask:!0,pass_params:!0,control_link_search:"default",experiment_link_search:"default"}}function c(t,e){t=t||window;var s=!1,r=!0,i=t.document,n=i.documentElement,a=i.addEventListener,o=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",l=a?"":"on",u=function(r){"readystatechange"==r.type&&"complete"!=i.readyState||(("load"==r.type?t:i)[c](l+r.type,u,!1),!s&&(s=!0)&&e.call(t,r.type||r))},p=function(){try{n.doScroll("left")}catch(t){return void setTimeout(p,50)}u("poll")};if("complete"==i.readyState)e.call(t,"lazy");else{if(!a&&n.doScroll){try{r=!t.frameElement}catch(h){}r&&p()}i[o](l+"DOMContentLoaded",u,!1),i[o](l+"readystatechange",u,!1),t[o](l+"load",u,!1)}}function l(t,e){if(!t||!t.parentNode||!t.parentNode.children)return!1;e=e&&e.join?e:[];var s=t.nodeName.toLowerCase();return t&&"body"!==s&&1==t.nodeType?(e.unshift(function(t){var e=t.parentNode&&9==t.parentNode.nodeType?-1:function(t){if(!t.parentNode)return-1;for(var e=0,s=t.tagName,r=t.parentNode.children,i=0;i<r.length;i++)if(r[i].tagName===s){if(t===r[i])return e;e++}return-1}(t);return t.getAttribute&&t.getAttribute("id")&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(t.getAttribute("id"))?"#"+t.getAttribute("id"):t.tagName.toLowerCase()+(~e?":nth-of-type("+(e+1)+")":"")}(t)),t.getAttribute&&t.getAttribute("id")&&/^[A-Za-z][-A-Za-z0-9_:.]*$/.test(t.getAttribute("id"))?e.join(" > "):l(t.parentNode,e)):(e.unshift("body"),e.join(" > "))}function u(t,e){return t.currentStyle?t.currentStyle[e]:t.ownerDocument.defaultView.getComputedStyle(t,null).getPropertyValue(e)}function h(t){var e="",s=!1;return v.each(t.childNodes,(function(t){!1===s&&3===t.nodeType&&(v.isString(t.textContent)||v.isString(t.innerText)||v.isString(t.nodeValue))&&(e=v.trim(t.textContent||t.innerText||t.nodeValue||""),s=!0)})),e}function p(t,e){if(Object.hasOwnProperty.call(e,"attributes")){var s=e.attributes;Object.hasOwnProperty.call(s,"style")&&function(t,e){var s=function(){var t,e={},s=navigator.userAgent.toLowerCase();return(t=s.match(/opera.([\d.]+)/))?e.opera=Number(t[1].split(".")[0]):(t=s.match(/msie ([\d.]+)/))?e.ie=Number(t[1].split(".")[0]):(t=s.match(/edge.([\d.]+)/))?e.edge=Number(t[1].split(".")[0]):(t=s.match(/firefox\/([\d.]+)/))?e.firefox=Number(t[1].split(".")[0]):(t=s.match(/chrome\/([\d.]+)/))?e.chrome=Number(t[1].split(".")[0]):(t=s.match(/version\/([\d.]+).*safari/))?e.safari=Number(t[1].match(/^\d*.\d*/)):(t=s.match(/trident\/([\d.]+)/))&&(e.ie=11),e}(),r=s.ie&&s.ie<9,i="";if(v.each(e,(function(t,e){r&&t.indexOf("rgba")>-1&&(t=function(t){var e=t.match(/[\d.]+/g);return e.length>=3?"rgb("+e[0]+","+e[1]+","+e[2]+")":""}(t));var s=e.replace(/[A-Z]+/g,(function(t){return"-"+t.toLowerCase()}));i+=";"+s+": "+t})),""!==i){var n=t.style,a=n.cssText||"";a&&!function(t,e){var s=t.length-";".length;return s>=0&&t.indexOf(";",s)==s}(a)&&(a+=";"),n.cssText=a+i}}(t,s.style),v.each(["href","target","src"],(function(e){Object.hasOwnProperty.call(s,e)&&function(t,e,s){t.setAttribute(e,s)}(t,e,s[e])}))}Object.hasOwnProperty.call(e,"text")&&function(t,e){var s=!1;v.each(t.childNodes,(function(t){3===t.nodeType&&(s||(t.textContent?t.textContent=e:t.innerText?t.innerText=e:t.nodeValue=e,s=!0))}))}(t,e.text)}function d(t){var e=t.ele;if(e){var s=t.originStyle;p(e,t.eleInfo.originProps),e.style.cssText=s||""}}function f(t){this.SensorsABTest=t,this.enable_visualize=!1,this.vabtest_url=location.protocol+"//static.sensorsdata.cn/sdk/plugin/vabtest/"+this.SensorsABTest.lib_version+"/vabtest.min.js",this.timeout=500,this.is_editor=!1,this.use_mask=!0,this.originData=[],this.visualExp=null,this.isFirst=!0,this.start_time=null,this.is_have_observer=!1,this.imgLoadingList=[],this.isTrigger=!1}function g(){this.lib_version="0.1.0",this.para={},this.default_para={url:"",path:"",project_key:"",timeout_milliseconds:3e3,update_interval:6e5,collect_bridge_status:!0,session_limit:6e5,encrypt_cookie:!1},this.state={platform:"",storage:{name:"sawebjssdkabtest"}},this.bridgeState="",this.localdata={},this.originalData=[],this.triggerList={},this.updateTime=null,this.sd=null,this.link=new o(this),this.vabtest=new f(this),this.normalStore=new t(this),this.bridgeStore=new e(this),this.verifyStore=new i(this)}function _(t){this.SensorsABTest=t}function m(t){this.SensorsABTest=t}var v={},b=Array.prototype,y=Object.prototype,S=b.slice,T=y.toString,A=y.hasOwnProperty,B=b.forEach,k=Array.isArray,w={};v.each=function(t,e,s){if(null==t)return!1;if(B&&t.forEach===B)t.forEach(e,s);else if(v.isArray(t)&&t.length===+t.length){for(var r=0,i=t.length;r<i;r++)if(r in t&&e.call(s,t[r],r,t)===w)return!1}else for(var n in t)if(A.call(t,n)&&e.call(s,t[n],n,t)===w)return!1},v.extend=function(t){return v.each(S.call(arguments,1),(function(e){for(var s in e)A.call(e,s)&&void 0!==e[s]&&(t[s]=e[s])})),t},v.isArray=k||function(t){return"[object Array]"===T.call(t)},v.isObject=function(t){return null!=t&&"[object Object]"==T.call(t)},v.isElement=function(t){return!(!t||1!==t.nodeType)},v.isString=function(t){return"[object String]"==T.call(t)},v.isBoolean=function(t){return"[object Boolean]"==T.call(t)},v.isNumber=function(t){return"[object Number]"==T.call(t)&&/[\d\.]+/.test(String(t))},v.unique=function(t){for(var e,s=[],r={},i=0;i<t.length;i++)(e=t[i])in r||(r[e]=!0,s.push(e));return s},v.decodeURIComponent=function(t){var e=t;try{e=decodeURIComponent(t)}catch(s){e=t}return e},v.getQueryParam=function(t,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=v.decodeURIComponent(t);var s=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===s||s&&"string"!=typeof s[1]&&s[1].length?"":v.decodeURIComponent(s[1])},v.indexOf=function(t,e){var s=t.indexOf;if(s)return s.call(t,e);for(var r=0;r<t.length;r++)if(e===t[r])return r;return-1},v.isFunction=function(t){if(!t)return!1;var e=Object.prototype.toString.call(t);return"[object Function]"==e||"[object AsyncFunction]"==e},v.isEmptyObject=function(t){if(v.isObject(t)){for(var e in t)if(A.call(t,e))return!1;return!0}return!1},v.map=function(t,e){var s=[];return null==t?s:Array.prototype.map&&t.map===Array.prototype.map?t.map(e):(v.each(t,(function(t,r,i){s.push(e(t,r,i))})),s)},v.base64Decode=function(t){var e=v.map(atob(t).split(""),(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}));return decodeURIComponent(e.join(""))},v.getURLSearchParams=function(t){for(var e=function(t){return decodeURIComponent(t)},s={},r=(t=t||"").substring(1).split("&"),i=0;i<r.length;i++){var n=r[i].indexOf("=");if(-1!==n){var a=r[i].substring(0,n),o=r[i].substring(n+1);a=e(a),o=e(o),s[a]=o}}return s},v.urlParse=function(t){var e=function(t){this._fields={Username:4,Password:5,Port:7,Protocol:2,Host:6,Path:8,URL:0,QueryString:9,Fragment:10},this._values={},this._regex=null,this._regex=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?(\w*)/,void 0!==t&&this._parse(t)};return e.prototype.setUrl=function(t){this._parse(t)},e.prototype._initValues=function(){for(var t in this._fields)this._values[t]=""},e.prototype.addQueryString=function(t){if("object"!=typeof t)return!1;var e=this._values.QueryString||"";for(var s in t)e=new RegExp(s+"[^&]+").test(e)?e.replace(new RegExp(s+"[^&]+"),s+"="+t[s]):"&"===e.slice(-1)?e+s+"="+t[s]:""===e?s+"="+t[s]:e+"&"+s+"="+t[s];this._values.QueryString=e},e.prototype.getUrl=function(){var t="";return t+=this._values.Origin,t+=this._values.Port?":"+this._values.Port:"",t+=this._values.Path,(t+=this._values.QueryString?"?"+this._values.QueryString:"")+(this._values.Fragment?"#"+this._values.Fragment:"")},e.prototype.getUrl=function(){var t="";return t+=this._values.Origin,t+=this._values.Port?":"+this._values.Port:"",(t+=this._values.Path)+(this._values.QueryString?"?"+this._values.QueryString:"")},e.prototype._parse=function(t){this._initValues();var e=this._regex.exec(t);for(var s in e||v.log("DPURLParser::_parse -> Invalid URL"),this._fields)void 0!==e[this._fields[s]]&&(this._values[s]=e[this._fields[s]]);this._values.Hostname=this._values.Host.replace(/:\d+$/,""),this._values.Origin=this._values.Protocol+"://"+this._values.Hostname},new e(t)},v.URL=function(t){var e={};if("function"==typeof window.URL&&function(){try{return"http://modernizr.com/"===new URL("http://modernizr.com/").href}catch(e){return!1}}())(e=new URL(t)).searchParams||(e.searchParams=function(){var t=v.getURLSearchParams(e.search);return{get:function(e){return t[e]}}}());else{!1===/^https?:\/\/.+/.test(t)&&v.log("Invalid URL");var s=v.urlParse(t);e.hash="",e.host=s._values.Host?s._values.Host+(s._values.Port?":"+s._values.Port:""):"",e.href=s._values.URL,e.password=s._values.Password,e.pathname=s._values.Path,e.port=s._values.Port,e.search=s._values.QueryString?"?"+s._values.QueryString:"",e.username=s._values.Username,e.hostname=s._values.Hostname,e.protocol=s._values.Protocol?s._values.Protocol+":":"",e.origin=s._values.Origin?s._values.Origin+(s._values.Port?":"+s._values.Port:""):"",e.searchParams=function(){var t=v.getURLSearchParams("?"+s._values.QueryString);return{get:function(e){return t[e]}}}()}return e},v.getQueryParam=function(t,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=v.decodeURIComponent(t);var s=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===s||s&&"string"!=typeof s[1]&&s[1].length?"":v.decodeURIComponent(s[1])},v.isEmptyObject=function(t){if(v.isObject(t)){for(var e in t)if(A.call(t,e))return!1;return!0}return!1},v.contentLoaded=function(t,e){var s=!1,r=!0,i=t.document,n=i.documentElement,a=i.addEventListener,o=a?"addEventListener":"attachEvent",c=a?"removeEventListener":"detachEvent",l=a?"":"on",u=function(r){"readystatechange"==r.type&&"complete"!=i.readyState||(("load"==r.type?t:i)[c](l+r.type,u,!1),!s&&(s=!0)&&e.call(t,r.type||r))},p=function(){try{n.doScroll("left")}catch(t){return void setTimeout(p,50)}u("poll")};if("complete"==i.readyState)e.call(t,"lazy");else{if(!a&&n.doScroll){try{r=!t.frameElement}catch(h){}r&&p()}i[o](l+"DOMContentLoaded",u,!1),i[o](l+"readystatechange",u,!1),t[o](l+"load",u,!1)}},v.secCheck={isHttpUrl:function(t){return"string"==typeof t&&(!1!==/^https?:\/\/.+/.test(t)||(v.log("Invalid URL"),!1))},removeScriptProtocol:function(t){if("string"!=typeof t)return"";for(var e=/^\s*javascript/i;e.test(t);)t=t.replace(e,"");return t}},v.addEvent=function(){function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation,e._getPath=t._getPath),e}function e(e,s,r){return function(i){if(i=i||t(window.event)){i.target=i.srcElement;var n,a,o=!0;return"function"==typeof r&&(n=r(i)),a=s.call(e,i),!1!==n&&!1!==a||(o=!1),o}}}t._getPath=function(){var t=this;return this.path||this.composedPath&&this.composedPath()||function(){try{var e=t.target,s=[e];if(null===e||null===e.parentElement)return[];for(;null!==e.parentElement;)s.unshift(e=e.parentElement);return s}catch(r){return[]}}()},t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0};var s=function(s,r,i){if(s&&s.addEventListener)s.addEventListener(r,(function(e){e._getPath=t._getPath,i.call(this,e)}),!0);else{var n="on"+r;s[n]=e(s,i,s[n])}};s.apply(null,arguments)},v.addSinglePageEvent=function(t){var e=location.href,s=window.history.pushState,r=window.history.replaceState;window.history.pushState=function(){s.apply(window.history,arguments),t(e),e=location.href},window.history.replaceState=function(){r.apply(window.history,arguments),t(e),e=location.href},v.addEvent(window,s?"popstate":"hashchange",(function(){t(e),e=location.href}))},v.trim=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},v.checkUrlIsMatch=function(t,e){var s,r,n=v.URL(t);if("STRICT"===e)return location.href===n.href;if("FUZZY"===e){try{s=v.URL(location.href)}catch(i){return v.log("url 解析失败",i),!1}try{r=v.URL(t)}catch(i){return v.log("control_url 解析失败",i),!1}return s.host===r.host&&s.pathname===r.pathname}return v.log("link_match_type字段异常",e),!1},v.checkUrlIsRegexp=function(t,e){var s;try{s=v.URL(location.href)}catch(n){return v.log("url 解析失败",n),!1}try{var r=(e?new RegExp(t,e):new RegExp(t)).exec(s.href),i=!0;return!!r&&(v.each(r,(function(t){t||(i=!1)})),i)}catch(n){return v.log("control_link字段异常",n),!1}},v.log=function(){if("object"==typeof console&&console.log){v.isString(arguments[0])&&(arguments[0]="sensorsabtest————"+arguments[0]);try{return console.log.apply(console,arguments)}catch(t){console.log(arguments[0])}}},v.error=function(){if("object"==typeof console&&console.error)try{return console.error.apply(console,arguments)}catch(t){console.error(arguments[0])}},v.storage={isSupport:function(){var t=!0;try{var e="__sensorsdatasupport__",s="testIsSupportStorage";window.localStorage.setItem(e,s),window.localStorage.getItem(e)!==s&&(t=!1),window.localStorage.removeItem(e)}catch(r){t=!1}return t},set:function(t,e){this.isSupport()&&window.localStorage.setItem(e,t)},get:function(t){var e=null;return this.isSupport()&&(e=window.localStorage.getItem(t)),e}},(t.prototype={init:function(t){return!!this.setPara(t)&&(this.bridgeState="ab_no_host_bridge",this.SensorsABTest.state.platform=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?"H5":"Web",this.SensorsABTest.log("A/B Testing SDK 初始化成功，试验 URL：",t.url),this.SensorsABTest.checkSADebug(),void this.SensorsABTest.store.init(this.getResultFromServer,this))},setPara:function(t){if(!v.isString(t.url)||"http"!==t.url.slice(0,4))return this.SensorsABTest.log("A/B Testing SDK 初始化失败，请使用正确的 URL！"),!1;if("https"===location.protocol.slice(0,5)&&"http:"===t.url.slice(0,5))return this.SensorsABTest.log("A/B Testing SDK 初始化失败，https 页面必须使用 https 的 URL"),!1;var e=v.getQueryParam(t.url,"project-key");if(!e)return this.SensorsABTest.log("A/B Testing SDK 初始化失败，请使用正确的 URL（必须包含 project-key）！"),!1;t.project_key=e;var s=this.SensorsABTest.verifyStore.para("A/B Testing SDK 初始化",t,{timeout_milliseconds:"not_essential"});return this.SensorsABTest.para=v.extend({},this.SensorsABTest.default_para,s.para),v.isBoolean(this.SensorsABTest.para.collect_bridge_status)||(this.SensorsABTest.para.collect_bridge_status=!0),v.isNumber(this.SensorsABTest.para.update_interval)||(this.SensorsABTest.para.update_interval=6e5),!0===this.SensorsABTest.sd.para.encrypt_cookie&&(this.SensorsABTest.para.encrypt_cookie=!0),this.SensorsABTest.sd.para.sdk_id&&(this.SensorsABTest.state.storage.name+="_"+this.SensorsABTest.sd.para.sdk_id),!0},asyncFetch:function(t){var e=this;this.SensorsABTest.normalStore.getResultFromServer({para:t,suc:function(s){if(v.isObject(s)&&"SUCCESS"===s.status){var r=e.SensorsABTest.getExpResult(t);t.callback(r)}else t.callback(t.default_value)},err:function(){t.callback(t.default_value)}})},creatRequestData:function(t){var e="";v.isEmptyObject(this.SensorsABTest.sd.store._state)||(e=this.SensorsABTest.sd.store._state._first_id||this.SensorsABTest.sd.store._state.first_id||this.SensorsABTest.sd.store._state._distinct_id||this.SensorsABTest.sd.store._state.distinct_id);var s={anonymous_id:e,platform:this.SensorsABTest.state.platform,abtest_lib_version:this.SensorsABTest.lib_version,properties:{$is_first_day:this.SensorsABTest.sd._.cookie.getNewUser()}};return v.isObject(t.properties)&&(s.properties=v.extend({},s.properties,t.properties)),this.SensorsABTest.sd.store._state.first_id&&(s.login_id=this.SensorsABTest.sd.store.getDistinctId()),s},getResultFromServer:function(t){var e=this,s=(t=v.isObject(t)?t:{}).para||{},r=t.suc,i=t.err,n=this.creatRequestData(s);this.SensorsABTest.log("向服务端发起试验请求"),function(){var t=e.SensorsABTest.sd.store.getDistinctId();e.SensorsABTest.sd._.ajax({url:e.SensorsABTest.para.url,type:"POST",data:JSON.stringify(n),credentials:!1,contentType:"application/json",timeout:s.timeout_milliseconds||e.SensorsABTest.para.timeout_milliseconds,cors:!0,success:function(s){e.SensorsABTest.dealResponseData(s,t),r&&r(s),e.SensorsABTest.fetchData.setNextFetch()},error:function(t){e.SensorsABTest.log("服务端请求发送失败",t),i&&i(),e.SensorsABTest.fetchData.setNextFetch()}})}()}}).methods={asyncFetchABTest:function(t){if(!v.isObject(t))return v.error("asyncFetchABTest调用失败，参数未正确配置"),!1;var e=this.SensorsABTest.verifyStore.para("asyncFetchABTest",t,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});e.verify_success&&this.SensorsABTest.normalStore.asyncFetch(t=e.para)},fastFetchABTest:function(t){if(!v.isObject(t))return v.error("fastFetchABTest调用失败，参数未正确配置"),!1;var e=this.SensorsABTest.verifyStore.para("fastFetchABTest",t,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(e.verify_success){var s=this.SensorsABTest.searchLocalExp((t=e.para).param_name);if(v.isObject(s)){var r=this.SensorsABTest.getExpResult(t,s);t.callback(r)}else this.SensorsABTest.log("fastFetchABTest缓存中未读取到数据，发起请求"),this.SensorsABTest.normalStore.asyncFetch(t)}},fetchCacheABTest:function(t){if(v.isObject(t)){var e=this.SensorsABTest.verifyStore.para("fetchCacheABTest",t,{param_name:"essential",value_type:"essential",default_value:"essential"});return e.verify_success?this.SensorsABTest.getExpResult(e.para):void 0}v.error("fetchCacheABTest调用失败，参数未正确配置")}},(e.prototype={init:function(t){var e=this;return this.SensorsABTest.state.storage.name="sawebjssdkabtest_bridge",!!this.setPara(t)&&(this.SensorsABTest.log("A/B Testing SDK 初始化成功"),this.abBridge=new this.SensorsABTest.sd.JSBridge({type:"abtest",app_call_js:function(t){try{t=v.base64Decode(t)}catch(s){e.SensorsABTest.log("App数据base64解码异常",t)}try{(t=JSON.parse(t)).message_id&&this.double(t)}catch(s){e.SensorsABTest.log("App数据解析异常",t)}}}),this.SensorsABTest.bridgeState=v.isObject(window.SensorsData_iOS_JS_Bridge)&&window.SensorsData_iOS_JS_Bridge.sensorsdata_abtest_module&&this.abBridge.hasAppBridge()||v.isObject(window.SensorsData_APP_New_H5_Bridge)&&v.isFunction(window.SensorsData_APP_New_H5_Bridge.sensorsdata_abtest_module)&&window.SensorsData_APP_New_H5_Bridge.sensorsdata_abtest_module()&&this.abBridge.hasAppBridge()?"ab_bridge_ok":"ab_no_abtest_bridge",void this.SensorsABTest.store.init(this.getResultFromApp,this))},setPara:function(t){var e=this.SensorsABTest.verifyStore.para("打通初始化",t,{timeout_milliseconds:"not_essential"});return this.SensorsABTest.para=v.extend({},this.SensorsABTest.default_para,e.para),v.isBoolean(this.SensorsABTest.para.collect_bridge_status)||(this.SensorsABTest.para.collect_bridge_status=!0),v.isNumber(this.SensorsABTest.para.update_interval)||(this.SensorsABTest.para.update_interval=6e5),!0===this.SensorsABTest.sd.para.encrypt_cookie&&(this.SensorsABTest.para.encrypt_cookie=!0),this.SensorsABTest.sd.para.sdk_id&&(this.SensorsABTest.state.storage.name+="_"+this.SensorsABTest.sd.para.sdk_id),!0},getResultFromApp:function(t){var e=this,s=(t=v.isObject(t)?t:{}).para||{},r=t.suc,i=t.err,n=s.timeout_milliseconds||this.SensorsABTest.para.timeout_milliseconds;this.SensorsABTest.log("向App发起试验请求"),"ab_bridge_ok"===e.SensorsABTest.bridgeState?e.abBridge.requestToApp({data:{properties:s.properties,timeout:n,request_body:{origin_platform:"H5"}},callback:function(t){v.isObject(t)&&v.isObject(t.data)?(e.SensorsABTest.log("成功获取到 App 端返回的试验数据","data:",t),e.SensorsABTest.dealResponseData(t.data),r&&r(t)):(e.SensorsABTest.log("App 端请求失败"),i&&i()),e.SensorsABTest.fetchData.setNextFetch()},timeout:{time:n,callback:function(){e.SensorsABTest.log("获取App端数据失败"),i&&i(),e.SensorsABTest.fetchData.setNextFetch()}}}):i&&(e.SensorsABTest.log("A/B Testing 打通失败，",e.SensorsABTest.bridgeState),i())},asyncFetch:function(t){var e=this;this.SensorsABTest.bridgeStore.getResultFromApp({para:t,suc:function(s){if(v.isObject(s.properties)&&(t.properties=v.extend(s.properties,t.properties)),"SUCCESS"===s.data.status){var r=e.SensorsABTest.getExpResult(t);t.callback(r)}else t.callback(t.default_value)},err:function(){t.callback(t.default_value)}})}}).methods={asyncFetchABTest:function(t){if(!v.isObject(t))return v.error("asyncFetchABTest调用失败，参数未正确配置"),!1;var e=this.SensorsABTest.verifyStore.para("asyncFetchABTest",t,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});e.verify_success&&(t=e.para,"ab_bridge_ok"===this.SensorsABTest.bridgeState?this.SensorsABTest.bridgeStore.asyncFetch(t):t.callback(t.default_value))},fastFetchABTest:function(t){if(!v.isObject(t))return v.error("fastFetchABTest调用失败，参数未正确配置"),!1;var e=this.SensorsABTest.verifyStore.para("fastFetchABTest",t,{param_name:"essential",value_type:"essential",default_value:"essential",callback:"essential",timeout_milliseconds:"not_essential",properties:"not_essential"});if(e.verify_success){var s=this.SensorsABTest.searchLocalExp((t=e.para).param_name);if(v.isObject(s)){var r=this.SensorsABTest.getExpResult(t,s);t.callback(r)}else this.SensorsABTest.log("fastFetchABTest缓存中未读取到数据，发起请求"),"ab_bridge_ok"===this.SensorsABTest.bridgeState?this.SensorsABTest.bridgeStore.asyncFetch(t):t.callback(t.default_value)}},fetchCacheABTest:function(t){if(v.isObject(t)){var e=this.SensorsABTest.verifyStore.para("fetchCacheABTest",t,{param_name:"essential",value_type:"essential",default_value:"essential"});return e.verify_success?this.SensorsABTest.getExpResult(e.para):void 0}v.error("fetchCacheABTest调用失败，参数未正确配置")}};var O="dfm-enc-";i.prototype={value_type_list:["Number","String","Object","Boolean"],valueType:function(t,e){switch(e){case"Number":if(v.isNumber(t))return!0;break;case"String":if(v.isString(t))return!0;break;case"Object":if(v.isObject(t))return!0;break;case"Boolean":if(!0===t||!1===t)return!0;break;default:return!1}return!1},para:function(t,e,s){var r=this,i={verify_success:!0,para:null};return v.each(s,(function(s,n){if("essential"===s)switch(n){case"param_name":v.isString(e.param_name)&&e.param_name.length>0||(v.error(t+"方法调用失败，param_name参数未正确配置！param_name:",e.param_name),i.verify_success=!1);break;case"value_type":v.isString(e.value_type)&&-1!==v.indexOf(r.value_type_list,e.value_type)||(v.error(t+"方法调用失败，value_type配置错误",e.value_type),i.verify_success=!1);break;case"default_value":void 0===e.default_value?(v.error(t+"方法调用失败，default_value参数未配置"),i.verify_success=!1):r.valueType(e.default_value,e.value_type)||(v.error(t+"方法调用失败，default_value类型必须与value_type一致！",e.default_value,e.value_type),i.verify_success=!1);break;case"callback":v.isFunction(e.callback)||(v.error(t+"方法调用失败，callback参数未正确配置"),i.verify_success=!1);break;default:i.verify_success=!1}else if("not_essential"===s)switch(n){case"timeout_milliseconds":e.timeout_milliseconds=e.timeout_milliseconds||r.SensorsABTest.para.timeout_milliseconds||r.SensorsABTest.default_para.timeout_milliseconds,(!v.isNumber(e.timeout_milliseconds)||v.isNumber(e.timeout_milliseconds)&&e.timeout_milliseconds<=0)&&(v.error("timeout_milliseconds 参数错误",e.timeout_milliseconds),e.timeout_milliseconds=r.SensorsABTest.para.timeout_milliseconds),e.timeout_milliseconds<200&&(e.timeout_milliseconds=200);break;case"properties":e.properties=v.isObject(e.properties)?e.properties:{}}})),i.para=e,i}},a.prototype={createMaskStyle:function(){var t="["+this.attr_name+"],["+this.attr_name+"] body{opacity:0 !important;-khtml-opacity:0 !important;-moz-opacity:0;filter:alpha(opacity=0);}",e=document.createElement("style");e.type="text/css";try{e.appendChild(document.createTextNode(t))}catch(s){e.styleSheet.cssText=t}try{this.style_element=e,document.getElementsByTagName("head")[0].appendChild(e)}catch(s){v.log("error when create calls")}},show:function(t){try{var e=this;if(this.is_abort)return!1;var s=null;if(s=document.getElementsByTagName("html")[0],!v.isElement(s))return;s.setAttribute(this.attr_name,"1"),this.is_added=!0,v.isNumber(t)&&(this.remove_timer=setTimeout((function(){e.is_timeout=!0,e.remove()}),t))}catch(r){v.log("error when show calls")}},remove:function(){try{if(this.is_abort||(this.is_abort=!0),this.is_added){this.is_added=!1;var t=null;if(t=document.getElementsByTagName("html")[0],!v.isElement(t))return;t.removeAttribute(this.attr_name),this.style_element&&(document.getElementsByTagName("head")[0].removeChild(this.style_element),this.style_element=null)}this.remove_timer&&(clearTimeout(this.remove_timer),this.remove_timer=null)}catch(e){v.log("error when remove calls")}}},o.prototype.init=function(t){return this.initPara(t),this.para?v.getQueryParam(location.href,"saSDKMultilink")?(this.is_filtered_out=!0,!1):(this.start_time=(new Date).getTime(),this.para.use_mask&&this.initMask(),void this.addSinglePageListener()):(this.SensorsABTest.log("multilink is closed"),!1)},o.prototype.addSinglePageListener=function(){var t=this;v.addSinglePageEvent((function(e){return e!==location.href&&(t.is_filtered_out=!1,t.isFirst=!0,t.mask_instance&&t.mask_instance.remove(),v.getQueryParam(location.href,"saSDKMultilink")?(t.is_filtered_out=!0,!1):(t.start_time=(new Date).getTime(),t.para.use_mask&&t.initMask(),void t.resolve(t.SensorsABTest.originalData)))}))},o.prototype.initMask=function(){this.mask_instance=new a("link_"+this.SensorsABTest.sd.para.sdk_id),this.mask_instance.show(this.para.timeout)},o.prototype.initPara=function(t){if(v.isFunction(t))try{t=t()}catch(e){return this.SensorsABTest.log("link para error!"),void(this.para=!1)}!1===t?this.para=!1:v.isObject(t)&&(this.para.timeout=v.isNumber(t.timeout)&&t.timeout>=0?t.timeout:500,this.para.use_mask=v.isBoolean(t.use_mask)?t.use_mask:this.para.use_mask,this.para.control_link_search=v.isString(t.control_link_search)?t.control_link_search:"default",this.para.experiment_link_search=v.isString(t.experiment_link_search)?t.experiment_link_search:"default",this.para.pass_params=!v.isBoolean(t.pass_params)||t.pass_params)},o.prototype.resolve=function(t){var e=this;if(!this.para)return!1;if(!v.isArray(t))return!1;if(this.is_filtered_out)return!1;if(!this.isFirst)return!1;if(this.isFirst=!1,0===this.para.timeout)return!1;if((new Date).getTime()-this.start_time>this.para.timeout)return this.SensorsABTest.log("The multilink was stopped because the request timeout"),!1;var s=!1;v.each(t,(function(t){return!!v.isObject(t)&&!s&&"LINK"===t.experiment_type&&void(e.isTriggerLinkExp(t)&&(s=!0,e.redirectUrl(t)))})),!s&&this.para.use_mask&&this.mask_instance&&this.mask_instance.remove()},o.prototype.stopTrigger=function(){this.isFirst=!1,this.SensorsABTest.log("The multilink was stopped because the request failed"),this.para.use_mask&&this.mask_instance&&this.mask_instance.remove()},o.prototype.isTriggerLinkExp=function(t){return v.isString(t.control_link)&&v.isString(t.link_match_type)?"REGEXP"===t.link_match_type?!!v.checkUrlIsRegexp(t.control_link,t.regexp_flags)||(this.SensorsABTest.log("多链接试验匹配失败",t.abtest_experiment_id),!1):!!v.checkUrlIsMatch(t.control_link,t.link_match_type)||(this.SensorsABTest.log("多链接试验匹配失败",t.abtest_experiment_id),!1):(this.SensorsABTest.log("多链接试验数据异常",t.abtest_experiment_id),!1)},o.prototype.redirectUrl=function(t){function e(t){return v.secCheck.isHttpUrl(t)?v.secCheck.removeScriptProtocol(t):(this.SensorsABTest.log("非法URL"),!1)}if(t.experiment_link&&v.isString(t.experiment_link))if(!0!==t.is_control_group||"STRICT"!==t.link_match_type&&"REGEXP"!==t.link_match_type){var s,r,i=location.href,n=t.experiment_link;if("REGEXP"===t.link_match_type&&/\$\d+/.test(n)){var a=t.regexp_flags?new RegExp(t.control_link,t.regexp_flags):new RegExp(t.control_link);n=i.replace(a,n)}this.para.pass_params?(r=this.getMergedUrl(t.is_control_group,n,i),s=e(r)):(r=this.getMergedUrl(t.is_control_group,n),s=e(r)),s&&(this.SensorsABTest.triggerHandle(t)?setTimeout((function(){location.href=s}),80):setTimeout((function(){location.href=s}),0),this.mask_instance&&this.mask_instance.remove_timer&&clearTimeout(this.mask_instance.remove_timer))}else this.SensorsABTest.triggerHandle(t);else this.SensorsABTest.log("页面跳转失败，experiment_link字段异常",t.abtest_experiment_id)},o.prototype.getMergedUrl=function(t,e,s){function r(t){var e=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(t);if(e)return{host:e[1]||"",search:e[2]||"",hash:e[3]||""}}function i(t){var e={hash:"",search:""};if(!v.isString(t))return e;var s=t.indexOf("?");return s>-1?(e.search=t.slice(s),e.hash=t.slice(0,s)):e.hash=t,e}var n="",a={parse_url:null,search:""},o={parse_url:null,search:"",hash:""};return s&&(a.parse_url=r(s),!a.parse_url)?void this.SensorsABTest.log("url 解析失败",s):(o.parse_url=r(e),o.parse_url?(s&&(a.search="after_hash"===this.para.control_link_search?i(a.parse_url.hash).search:a.parse_url.search),t?"after_hash"===this.para.control_link_search?(o.search=i(o.parse_url.hash).search,o.hash=i(o.parse_url.hash).hash):o.search=o.parse_url.search:"after_hash"===this.para.experiment_link_search?(o.search=i(o.parse_url.hash).search,o.hash=i(o.parse_url.hash).hash):o.search=o.parse_url.search,n=s?this.getSearchStr(a.search,o.search):this.getSearchStr(o.search),t&&"after_hash"===this.para.control_link_search||!t&&"after_hash"===this.para.experiment_link_search?o.hash.length>0?o.parse_url.host+o.parse_url.search+o.hash+n:o.parse_url.search.length>0?o.parse_url.host+o.parse_url.search+"&"+n.substring(1):o.parse_url.host+n:o.parse_url.host+n+("after_hash"===this.para.control_link_search?o.parse_url.hash:s?o.parse_url.hash||a.parse_url.hash:o.parse_url.hash)):void this.SensorsABTest.log("url 解析失败",e))},o.prototype.getSearchStr=function(t,e){function s(t){var e={};if(!t||!t.length||0!==t.indexOf("?"))return e;if(!(t=t.slice(1)).length)return e;for(var s=t.split("&"),r=0;r<s.length;r++)if(s[r].indexOf("=")<0)e[s[r]]=null;else{var i=s[r].split("=");e[i[0]]=i[1]}return e}var r=s(t),i=s(e),n=v.extend(r,i),a="";if(v.isEmptyObject(n))return"?saSDKMultilink=true";var o=!0;for(var c in n)o?(a+="?",o=!1):a+="&",null!==n[c]?a=a+c+"="+n[c]:a+=c;return a+"&saSDKMultilink=true"},window.MutationObserver||(window.MutationObserver=function(t){function e(t){this._watched=[],this._listener=t}function s(t){!function s(){var r=t.takeRecords();r.length&&t._listener(r,t),t._timeout=setTimeout(s,e._period)}()}function r(e){var s={type:null,target:null,addedNodes:[],removedNodes:[],previousSibling:null,nextSibling:null,attributeName:null,attributeNamespace:null,oldValue:null};for(var r in e)p(s,r)&&e[r]!==t&&(s[r]=e[r]);return s}function i(t,e){var s=o(t,e);return function(i){var c,l=i.length;e.charData&&3===t.nodeType&&t.nodeValue!==s.charData&&i.push(new r({type:"characterData",target:t,oldValue:s.charData})),e.attr&&s.attr&&n(i,t,s.attr,e.afilter),(e.kids||e.descendents)&&(c=a(i,t,s,e)),(c||i.length!==l)&&(s=o(t,e))}}function n(t,e,s,i){for(var n,a,o={},c=e.attributes,l=c.length;l--;)a=(n=c[l]).name,i&&!p(i,a)||(f(e,n)!==s[a]&&t.push(r({type:"attributes",target:e,attributeName:a,oldValue:s[a],attributeNamespace:n.namespaceURI})),o[a]=!0);for(a in s)o[a]||t.push(r({target:e,type:"attributes",attributeName:a,oldValue:s[a]}))}function a(e,s,i,a){function o(t,s,i,o,c){for(var l,h,p,d=t.length-1,f=-~((d-c)/2);p=t.pop();)l=i[p.i],h=o[p.j],a.kids&&f&&Math.abs(p.i-p.j)>=d&&(e.push(r({type:"childList",target:s,addedNodes:[l],removedNodes:[l],nextSibling:l.nextSibling,previousSibling:l.previousSibling})),f--),a.attr&&h.attr&&n(e,l,h.attr,a.afilter),a.charData&&3===l.nodeType&&l.nodeValue!==h.charData&&e.push(r({type:"characterData",target:l,oldValue:h.charData})),a.descendents&&u(l,h)}function u(s,i){for(var d,f,g,_,m,v,b,y=s.childNodes,S=i.kids,T=y.length,A=S?S.length:0,B=0,k=0,w=0;k<T||w<A;)(v=y[k])===(b=(m=S[w])&&m.node)?(a.attr&&m.attr&&n(e,v,m.attr,a.afilter),a.charData&&m.charData!==t&&v.nodeValue!==m.charData&&e.push(r({type:"characterData",target:v,oldValue:m.charData})),f&&o(f,s,y,S,B),a.descendents&&(v.childNodes.length||m.kids&&m.kids.length)&&u(v,m),k++,w++):(p=!0,d||(d={},f=[]),v&&(d[g=l(v)]||(d[g]=!0,-1===(_=c(S,v,w))?a.kids&&(e.push(r({type:"childList",target:s,addedNodes:[v],nextSibling:v.nextSibling,previousSibling:v.previousSibling})),B++):f.push({i:k,j:_})),k++),b&&b!==y[k]&&(d[g=l(b)]||(d[g]=!0,-1===(_=h(y,b,k))?a.kids&&(e.push(r({type:"childList",target:i.node,removedNodes:[b],nextSibling:S[w+1],previousSibling:S[w-1]})),B--):f.push({i:_,j:w})),w++));f&&o(f,s,y,S,B)}var p;return u(s,i),p}function o(t,e){var s=!0;return function t(r){var i={node:r};return!e.charData||3!==r.nodeType&&8!==r.nodeType?(e.attr&&s&&1===r.nodeType&&(i.attr=u(r.attributes,(function(t,s){return e.afilter&&!e.afilter[s.name]||(t[s.name]=f(r,s)),t}),{})),s&&(e.kids||e.charData||e.attr&&e.descendents)&&(i.kids=function(t,e){for(var s=[],r=0;r<t.length;r++)s[r]=e(t[r],r,t);return s}(r.childNodes,t)),s=e.descendents):i.charData=r.nodeValue,i}(t)}function c(t,e,s){return h(t,e,s,"node")}function l(t){try{return t.id||(t[_]=t[_]||g++)}catch(e){try{return t.nodeValue}catch(s){return g++}}}function u(t,e,s){for(var r=0;r<t.length;r++)s=e(s,t[r],r,t);return s}function h(t,e,s,r){for(;s<t.length;s++)if((r?t[s][r]:t[s])===e)return s;return-1}function p(e,s){return e[s]!==t}e._period=30,e.prototype={observe:function(t,e){for(var r={attr:!!(e.attributes||e.attributeFilter||e.attributeOldValue),kids:!!e.childList,descendents:!!e.subtree,charData:!(!e.characterData&&!e.characterDataOldValue)},n=this._watched,a=0;a<n.length;a++)n[a].tar===t&&n.splice(a,1);e.attributeFilter&&(r.afilter=u(e.attributeFilter,(function(t,e){return t[e]=!0,t}),{})),n.push({tar:t,fn:i(t,r)}),this._timeout||s(this)},takeRecords:function(){for(var t=[],e=this._watched,s=0;s<e.length;s++)e[s].fn(t);return t},disconnect:function(){this._watched=[],clearTimeout(this._timeout),this._timeout=null}};var d=document.createElement("i");d.style.top=0;var f=(d="null"!=d.attributes.style.value)?function(t,e){return e.value}:function(t,e){return"style"!==e.name?e.value:t.style.cssText},g=1,_="mo_id";return e}(void 0)),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),s=this,r=function(){},i=function(){return s.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),f.prototype.init=function(t){var e=this;this.initPara(t),!1!==this.enable_visualize&&(window.self!==window.top&&function(){if(!window.name)return!1;try{var t=JSON.parse(decodeURIComponent(window.name||""));return!(!0!==t.is_vabtesting||!v.checkUrlIsMatch(t.source_url,t.link_match_type))||(v.log("A/B Testing SDK 页面地址，与当前实验 URL 不匹配，请使用正确的 URL！"),!1)}catch(r){return!1}}()?(this.is_editor=!0,document.getElementById("sa-abtesting-vabtest-script")||function(t,e){!function(t){t=v.extend({success:function(){},error:function(){},appendCall:function(t){document.getElementsByTagName("head")[0].appendChild(t)}},t);var e=null;"css"===t.type&&((e=document.createElement("link")).rel="stylesheet",e.href=t.url),"js"===t.type&&((e=document.createElement("script")).async="async",e.setAttribute("charset","UTF-8"),e.src=t.url,e.type="text/javascript"),t.id&&(e.id=t.id),e.onload=e.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(t.success(),e.onload=e.onreadystatechange=null)},e.onerror=function(){t.error(),e.onerror=null},t.appendCall(e)}(v.extend({success:function(){},error:function(){},type:"js",url:t},e))}(this.vabtest_url,{id:"sa-abtesting-vabtest-script",success:function(){setTimeout((function(){e.SensorsABTest.sd.use("VABTest",{SensorsABTest:e.SensorsABTest})}),0)}})):(this.start_time=(new Date).getTime(),this.use_mask&&this.initMask(),this.addSinglePageListener()))},f.prototype.initPara=function(t){if(v.isFunction(t))try{t=t()}catch(e){return this.SensorsABTest.log("ABTesting SDK  !"),void(this.para=!1)}if(v.isObject(t)){Object.prototype.hasOwnProperty.call(t,"enable_visualize")&&v.isBoolean(t.enable_visualize)?this.enable_visualize=t.enable_visualize:this.SensorsABTest.log("ABTesting SDK 初始化参数 enable_visualize 格式不正确。 类型应为 Boolean"),this.use_mask=v.isBoolean(t.use_mask)?t.use_mask:this.use_mask,this.timeout=v.isNumber(t.timeout)&&t.timeout>=0?t.timeout:this.timeout;var s=v.isString(t.vabtest_url)?t.vabtest_url:"";s&&("https:"===location.protocol?"https:"===s.slice(0,6)?this.vabtest_url=s:this.SensorsABTest.log("ABTesting SDK 初始化参数 vabtest_url 协议头应设置为 https"):"http:"===s.slice(0,5)||"https:"===s.slice(0,6)?this.vabtest_url=s:this.SensorsABTest.log("ABTesting SDK 初始化参数 vabtest_url 应设置为有效 URL"))}else this.para=!1},f.prototype.resolve=function(t){if(!1!==this.enable_visualize&&!0!==this.is_editor&&!1!==this.isFirst){if((new Date).getTime()-this.start_time>this.timeout)return this.SensorsABTest.log("请求实验结果超时，A/B 可视化实验失败！"),!1;var e=this;this.isFirst=!1;var s=!1;v.each(t,(function(t){if(!v.isObject(t)||"VISUAL"!==t.experiment_type)return!1;if(s)return!1;var i=t.experiment_value;if(!v.isArray(i))try{i=JSON.parse(t.experiment_value),t.experiment_value=i}catch(r){return!1}e.isTriggerVisualExp(t)&&(s=!0,e.prepareResource(t,e.render.bind(e)),e.visualExp=t)})),!s&&this.use_mask&&this.destroyMask(),c(window,(function(){!function(t){new(0,window.MutationObserver)(t).observe(document.body,{childList:!0,subtree:!0})}(e.observerCallback.bind(e))}))}},f.prototype.initMask=function(){this.mask_instance=new a("vabtest_"+this.SensorsABTest.sd.para.sdk_id),this.mask_instance.show(this.timeout)},f.prototype.destroyMask=function(){this.mask_instance&&this.mask_instance.remove()},f.prototype.prepareResource=function(t,e){var s=this,r=t.experiment_value;v.isArray(r)&&(v.each(r,(function(r){function i(){var r=s.imgLoadingList.indexOf(a);r>-1&&s.imgLoadingList.splice(r,1),0===s.imgLoadingList.length&&e(t)}var n=r.props;if("img"===r.tagName&&n&&n.attributes&&v.isString(n.attributes.src)){var a=n.attributes.src;s.imgLoadingList.push(a);var o=document.createElement("img");o.width=1,o.height=1,o.onload=i,o.onerror=i,o.onabort=i,o.src=n.attributes.src}})),0===this.imgLoadingList.length&&e(t))},f.prototype.render=function(t){var e=this;c(window,(function(){if(e.use_mask&&e.mask_instance&&!0===e.mask_instance.is_timeout)e.SensorsABTest.log("渲染实验结果超时，A/B 可视化实验失败！");else{e.isTrigger||(e.SensorsABTest.triggerHandle(t),e.isTrigger=!0);var s=t.experiment_value;v.isArray(s)&&v.each(s,(function(t){var s=function(t){if(!v.isString(t))return null;var e,s=t.split(">");return(e=function t(e){var r,i=s.shift();if(!i)return e;try{r=function(t,e){var s;if("body"===(t=v.trim(t)))return document.getElementsByTagName("body")[0];if(0===t.indexOf("#"))t=t.slice(1),s=document.getElementById(t);else if(t.indexOf(":nth-of-type")>-1){var r=t.split(":nth-of-type");if(!r[0]||!r[1])return null;var i=r[0],n=r[1].match(/\(([0-9]+)\)/);if(!n||!n[1])return null;var a=Number(n[1]);if(!(v.isElement(e)&&e.children&&e.children.length>0))return null;for(var o=e.children,c=0;c<o.length;c++)if(v.isElement(o[c])&&o[c].tagName.toLowerCase()===i&&0==--a){s=o[c];break}if(a>0)return null}return s||null}(i,e)}catch(n){r=null}return r&&v.isElement(r)?t(r):null}())&&v.isElement(e)?e:null}(t.selector);if(s)try{var r=function(t,e){var s=t.tagName.toLowerCase(),r=function(t,e){var s={};return v.each([]||[],(function(e){var r=e.replace(/[A-Z]+/g,(function(t){return"-"+t.toLowerCase()}));s[e]=u(t,r)})),s}(t),i={selector:l(t),originProps:{attributes:{style:r},text:h(t)},type:"text",tagName:s};return"a"===s&&(i.originProps.attributes.href=t.href,t.getAttribute("target")&&(i.originProps.attributes.target=t.getAttribute("target")),i.type="link"),"img"===s&&(i.originProps.attributes.src=t.src,i.type="img"),{originStyle:t.getAttribute("style"),eleInfo:i,ele:t}}(s);(function(t,e,s){if(s||(s=function(t,e){var s=e.originProps,r={attributes:{}},i=s.attributes;return v.each(i.style||{},(function(e,s){r.attributes.style[s]=u(t,s)})),Object.hasOwnProperty.call(s,"text")&&(r.attributes.text=h(t)),v.each(["src","href"],(function(e){Object.hasOwnProperty.call(i,e)&&(r.attributes[e]=t[e])})),Object.hasOwnProperty.call(i,"target")&&(r.attributes.target=t.getAttribute("target")),r}(t,e)),function(t,e){var s=t.originProps,r=e.originProps,i=s.attributes,n=r.attributes,a=!0;return s.text&&s.text!==r.text&&(a=!1),i&&v.each(["src","href","target"],(function(t){i[t]&&i[t]!==n[t]&&(a=!1)})),a}(e,s)){var r=e.props;v.isObject(r)&&p(t,r)}})(s,t,r.eleInfo),e.originData.push(r)}catch(i){}})),e.use_mask&&e.destroyMask()}}))},f.prototype.restoreElements=function(){v.each(this.originData,(function(t){d(t)})),this.visualExp=null,this.isFirst=!0,this.start_time=(new Date).getTime(),this.originData=[],this.isTrigger=!1},f.prototype.addSinglePageListener=function(){var t=this;v.addSinglePageEvent((function(e){return e!==location.href&&(t.mask_instance&&t.destroyMask(),t.start_time=(new Date).getTime(),t.use_mask&&t.initMask(),t.restoreElements(),void t.resolve(t.SensorsABTest.originalData))}))},f.prototype.observerCallback=function(){this.visualExp&&(v.each(this.originData,(function(t){d(t)})),this.originData=[],this.render(this.visualExp))},f.prototype.stopTrigger=function(){this.isFirst=!1,this.SensorsABTest.log("请求实验结果失败，A/B 可视化实验失败！"),this.use_mask&&this.destroyMask()},f.prototype.isTriggerVisualExp=function(t){return v.isString(t.control_link)&&v.isString(t.link_match_type)?!!v.checkUrlIsMatch(t.control_link,t.link_match_type)||(this.SensorsABTest.log("可视化试验匹配失败",t.abtest_experiment_id),!1):(this.SensorsABTest.log("可视化试验数据异常",t.abtest_experiment_id),!1)},g.prototype.asyncFetchABTest=function(){v.error("asyncFetchABTest调用失败,A/B Testing未初始化")},g.prototype.fastFetchABTest=function(){v.error("fastFetchABTest调用失败,A/B Testing未初始化")},g.prototype.etchCacheABTest=function(){v.error("fetchCacheABTest调用失败,A/B Testing未初始化")},g.prototype.searchLocalExp=function(t){return this.localdata[t]?this.localdata[t]:null},g.prototype.getExpResult=function(t,e){var s=t.default_value,r=e||this.searchLocalExp(t.param_name);return v.isObject(r)?v.isObject(r.js_config)&&(r.js_config.type===t.value_type?(s=r.js_config.value,this.triggerHandle(r,t)):this.log("试验结果类型与代码期望类型不一致，param_name："+t.param_name+"，当前返回类型为："+r.js_config.type+"，代码期望类型为："+t.value_type)):this.log("localdata未查询到试验数据，试验参数名称："+t.param_name),s},g.prototype.resolveVariables=function(t){this.localdata={};var e=this;v.each(t,(function(t){if(v.isObject(t)&&t.variables&&v.isArray(t.variables)){if(t.experiment_type&&"CODE"!==t.experiment_type)return!1;v.each(t.variables,(function(s){v.isObject(s)&&!e.localdata[s.name]&&(e.localdata[s.name]={abtest_experiment_id:t.abtest_experiment_id,abtest_experiment_group_id:t.abtest_experiment_group_id,is_control_group:t.is_control_group,is_white_list:t.is_white_list,value:s.value,type:s.type,js_config:e.getRelativeValue(s.value,s.type),experiment_type:t.experiment_type})}))}}))},g.prototype.getRelativeValue=function(t,e){var s=this,r={},n={INTEGER:function(t){var e=parseFloat(t);isNaN(e)?s.log("原始数据 INTEGER 类型解析异常",t):(r.value=e,r.type="Number")},STRING:function(t){v.isString(t)?(r.value=t,r.type="String"):s.log("原始数据 STRING 类型解析异常",t)},JSON:function(t){var e=JSON.parse(t);v.isObject(e)?(r.value=e,r.type="Object"):s.log("原始数据 JSON 类型解析异常",t)},BOOLEAN:function(t){"true"===t?(r.value=!0,r.type="Boolean"):"false"===t?(r.value=!1,r.type="Boolean"):s.log("原始数据 BOOLEAN 类型解析异常",t)}};try{n[e]?n[e](t):s.log("试验数据类型解析失败",e,t)}catch(i){s.log(i,t,e)}return r},g.prototype.dealResponseData=function(t,e){v.isObject(t)?"SUCCESS"===t.status?v.isArray(t.results)&&(this.originalData=t.results,this.updateLocalData(t.results,e)):"FAILED"===t.status&&this.log("获取试验失败：error_type："+t.error_type+",error："+t.error):this.log("试验数据解析失败，response ：",t)},g.prototype.updateLocalData=function(t,e){this.analyzeData(t),this.updateStorage(e),this.log("更新试验数据成功")},g.prototype.updateStorage=function(t){var e=(new Date).getTime();(function(t,e,s){t=JSON.stringify(t),s&&(t=r(t)),v.storage.set(t,e)})({data:this.originalData,updateTime:e,triggerList:this.triggerList,distinct_id:t||this.sd.store.getDistinctId()},this.state.storage.name,this.para.encrypt_cookie),this.updateTime=e},g.prototype.analyzeData=function(t){return v.isArray(t)?(this.link.resolve(t),this.vabtest.resolve(t),void this.resolveVariables(t)):(this.log("解析——数据格式错误",t),!1)},g.prototype.triggerHandle=function(t,e){var s=v.isObject(e)&&v.isObject(e.properties)?e.properties:{},r=this.trackTestTrigger(t,s),i=t.abtest_experiment_id;if(v.isString(i)){var n=this.sd.store.getDistinctId();this.triggerList[n]&&v.isArray(this.triggerList[n])?(this.triggerList[n].push(i),this.triggerList[n]=v.unique(this.triggerList[n])):this.triggerList[n]=[i],this.updateStorage()}return r},g.prototype.trackTestTrigger=function(t,e){var s=this.sd.store.getDistinctId(),r=!0,i=!0;if(e=v.isObject(e)?e:{},!t.is_white_list){this.triggerList&&v.isObject(this.triggerList)&&("{}"!==JSON.stringify(this.triggerList)&&(i=!1),this.triggerList[s]&&v.isArray(this.triggerList[s])&&v.each(this.triggerList[s],(function(e){e===t.abtest_experiment_id&&(r=!1)})));var n={$abtest_experiment_id:t.abtest_experiment_id,$abtest_experiment_group_id:t.abtest_experiment_group_id};this.para.collect_bridge_status&&(n.$sdk_bridge_status=this.bridgeState),i&&(n.$lib_plugin_version=["web_abtesting:"+this.lib_version]);var a=v.extend(n,e);return r&&this.sd.track("$ABTestTrigger",a),this.sd.track("WebABTestTrigger",a),r}},g.prototype.checkSADebug=function(){var t=this,e=v.getQueryParam(location.href,"sensors_abtest_url"),s=v.getQueryParam(location.href,"feature_code"),r=+v.getQueryParam(location.href,"account_id");if(e.length&&s.length&&v.isNumber(r)&&0!==r){var i={distinct_id:this.sd.store.getDistinctId(),feature_code:s,account_id:r};this.sd._.ajax({url:e,type:"POST",data:JSON.stringify(i),credentials:!1,contentType:"application/json",timeout:this.para.timeout_milliseconds,cors:!0,success:function(){},error:function(e){t.log("distinct_id发送失败,err:",e)}})}},g.prototype.initMethods=function(t){var e=this;v.each(["asyncFetchABTest","fastFetchABTest","fetchCacheABTest"],(function(s){e[s]=function(){t.methods[s].apply(t,arguments)}}))},_.prototype={timer:null,method:null,context:null,init:function(t,e){this.method=t,this.context=e,this.start(!0)},getServerData:function(t){var e=this;t?this.method.call(this.context,{suc:function(s){t&&("ab_bridge_ok"===e.SensorsABTest.bridgeState&&(s=s.data),v.isObject(s)&&"SUCCESS"===s.status&&v.isArray(s.results)||(e.SensorsABTest.link.stopTrigger(),e.SensorsABTest.vabtest.stopTrigger()))},err:function(){t&&(e.SensorsABTest.link.stopTrigger(),e.SensorsABTest.vabtest.stopTrigger())}}):this.method.call(this.context)},setNextFetch:function(t){var e=this,s=t||this.SensorsABTest.para.update_interval;this.clearFetchTimer(this.timer),this.timer=setTimeout((function(){e.getServerData()}),s)},start:function(t){var e=null,s=(new Date).getTime(),r=n(this.SensorsABTest.state.storage.name),i=this.SensorsABTest.sd.store.getDistinctId();r&&v.isObject(r)&&r.distinct_id===i?(e=r.updateTime,t&&(this.SensorsABTest.originalData=r.data,e&&v.isNumber(e)&&s-e>0&&s-e<this.SensorsABTest.para.session_limit&&v.isObject(r.triggerList)&&(this.SensorsABTest.triggerList=r.triggerList),this.SensorsABTest.analyzeData(r.data)),e&&v.isNumber(e)&&s-e>0&&s-e<this.SensorsABTest.para.update_interval?(this.SensorsABTest.log("数据不更新",e,s),this.setNextFetch(this.SensorsABTest.para.update_interval-(s-e))):(this.SensorsABTest.log("缓存数据超时",e,s),this.getServerData(t))):(e=this.SensorsABTest.updateTime)&&v.isNumber(e)&&s-e>0&&s-e<this.SensorsABTest.para.update_interval?this.SensorsABTest.log("数据不更新",e,s):this.getServerData(t)},stop:function(){this.SensorsABTest.log("清空拉取定时器"),this.clearFetchTimer()},clearFetchTimer:function(){clearTimeout(this.timer),this.timer=null}},m.prototype={init:function(t,e){var s=this;this.SensorsABTest.fetchData.init(t,e),this.SensorsABTest.initMethods(e),function(t){({visibleHandle:v.isFunction(t.visible)?t.visible:function(){},hiddenHandler:v.isFunction(t.hidden)?t.hidden:function(){},visibilityChange:null,hidden:null,isSupport:function(){return void 0!==document[this.hidden]},init:function(){void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen:function(){if(this.isSupport()){var t=this;document.addEventListener(t.visibilityChange,(function(){document[t.hidden]?t.hiddenHandler():t.visibleHandle()}),1)}else document.addEventListener?(window.addEventListener("focus",this.visibleHandle,1),window.addEventListener("blur",this.hiddenHandler,1)):(document.attachEvent("onfocusin",this.visibleHandle),document.attachEvent("onfocusout",this.hiddenHandler))}}).init()}({visible:function(){s.SensorsABTest.log("页面显示"),s.SensorsABTest.fetchData.start()},hidden:function(){s.SensorsABTest.fetchData.stop()}}),this.SensorsABTest.sd.events.on("changeDistinctId",(function(t){s.SensorsABTest.localdata={},s.SensorsABTest.originalData=[],s.SensorsABTest.vabtest.restoreElements(),s.SensorsABTest.updateStorage(),s.SensorsABTest.fetchData.getServerData()})),this.SensorsABTest.sd.events.isReady()}},g.prototype.init=function(t,e){return this.sd?(this.log("A/B Testing SDK 重复初始化！只有第一次初始化有效！"),!1):function(t){return v.isObject(t)&&v.isObject(t.readyState)&&t.readyState.state>=3?t:null}(t)?(this.sd=t,v.isObject(e)?(v.storage.isSupport()||this.log("localstorage异常"),this.abtestingPara=e,this.fetchData=new _(this),this.store=new m(this),void this.initTest()):(this.log("A/B Testing SDK 初始化失败，请传入正确的初始化参数!para:",e),!1)):(this.log("A/B Testing 初始化失败,Web JS SDK 没有初始化完成"),!1)},g.prototype.initTest=function(){this.link.init(this.abtestingPara.multilink),this.vabtest.init(this.abtestingPara.visualize),this.sd.bridge.is_verify_success?this.bridgeStore.init(this.abtestingPara):this.normalStore.init(this.abtestingPara)},g.prototype.log=function(){return v.isString(arguments[0])&&(arguments[0]="sensorsabtest————"+arguments[0]),this.sd&&this.sd.log.apply(this,arguments)};var j=new g;return j.__constructor__=g,window.SensorsDataWebJSSDKPlugin&&"[object Object]"==Object.prototype.toString.call(window.SensorsDataWebJSSDKPlugin)?window.SensorsDataWebJSSDKPlugin.SensorsABTest=window.SensorsDataWebJSSDKPlugin.SensorsABTest||j:window.SensorsDataWebJSSDKPlugin={SensorsABTest:j},g}))}).call(this,s("LBCc")(t))}}]);